function DetailWithTableBaseCtrl(e,t,o,a,n,i,s){o=o.getInstance(s),o.debug("I am  new or edit position controller.",t);var r=this;this.form={},this.row={},this.windowTitle="This is 'this.windowTitle' variable, Please set for the widow title",t&&(this.row=t),this.isSubmitted=!1,this.formDefines={},this.tableDefines={},this.closeModalAfterSave=function(){},this.setHeader=function(e){r.currentColumnName=e,r.currentSortReverse=!r.currentSortReverse},this.isUp=function(e){return r.currentColumnName==e&&r.currentSortReverse},this.isDown=function(e){return r.currentColumnName==e&&!r.currentSortReverse},this.setDetailTemplateUrl=function(e){n.setTemplateUrl(e)},this.setDetailController=function(e){n.setControllerName(e)},this.setDetailWindowSize=function(e){n.setSize(e)},this.setCloseDetailModal=function(e){n.setCloseModalFunc(e)},this.setDismissDetailModal=function(e){n.setDismissModalFunc(e)},this.setDetailWindowTitle=function(e,t){n.setResolve(e,t)},this.setDeleteTemplateUrl=function(e){i.setTemplateUrl(e)},this.setDeleteController=function(e){i.setControllerName(e)},this.setDeleteWindowSize=function(e){i.setSize(e)},this.setCloseDeleteModal=function(e){i.setCloseModalFunc(e)},this.setDismissDeleteModal=function(e){i.setDismissModalFunc(e)},this.newOrEditRow=n.newOrEditRow,this.deleteRow=i.deleteRow,this.saveRow=function(){o.debug("This is  'this.saveRow()' function, Please override ! Remember to close modal by 'this.closeModalAfterSave()'"),e.saveMaster(r.row),r.closeModalAfterSave()},this.ok=function(){r.isSubmitted=!0,r.form.$valid?r.saveRow():(a.error("Please re-check all their fields again !","error"),o.error("Save postion err ",r.form.$error))},this.cancel=function(){}}function TableBaseCtrl(e,t,o,a,n){t=t.getInstance(n),t.debug("controller is running....");var i=this;this.selectedRow={},this.detailResolve={},this.currentColumnName="",this.currentSortReverse=!1,this.rows=[],this.getDataFromService=function(){o.getMasterRows(function(e){i.rows=e})},this.getDataFromService(),e.$on("MasterDetailBroadcast",function(){var e=o.getMessage();t.debug("Received a message from detail = "+e),(e.indexOf("Insert Master Successfully")>=0||e.indexOf("Update Master Successfully")>=0||e.indexOf("Delete Master Successfully")>=0)&&i.getDataFromService()}),this.detailResolve.row=function(){return t.debug("Please override 'detailResolve.row' object to process the resolve data for the detail modal"),i.selectedRow},this.setHeader=function(e){i.currentColumnName=e,i.currentSortReverse=!i.currentSortReverse},this.isUp=function(e){return i.currentColumnName==e&&i.currentSortReverse},this.isDown=function(e){return i.currentColumnName==e&&!i.currentSortReverse},this.setDeleteTemplateUrl=function(e){a.setTemplateUrl(e)},this.setDeleteController=function(e){a.setControllerName(e)},this.setDeleteWindowSize=function(e){a.setSize(e)},this.setCloseDeleteModal=function(e){a.setCloseModalFunc(e)},this.setDismissDeleteModal=function(e){a.setDismissModalFunc(e)},this.deleteRow=a.deleteRow}angular.module("TableBaseController",[]).controller("tableBaseController",["$uibModal","$log",TableBaseCtrl]),angular.module("DynamicForm",["toastr"]).directive("myDynamicForm",["$q","$parse","$compile","$document",function(e,t,o,a){return{restrict:"E",terminal:!0,link:function(n,i,s){var r=s.formdefine;r=r.replace(/\u00a0/g," ");var l={div:{element:"div"},h1:{element:"h1"},h2:{element:"h2"},h3:{element:"h3"},span:{element:"span"},form:{element:"form",editable:!1,textBased:!1},table:{element:"table",editable:!1,textBased:!1},text:{element:"input",type:"text",editable:!0,textBased:!0},date:{element:"input",type:"date",editable:!0,textBased:!0},datetime:{element:"input",type:"datetime",editable:!0,textBased:!0},"datetime-local":{element:"input",type:"datetime-local",editable:!0,textBased:!0},email:{element:"input",type:"email",editable:!0,textBased:!0},month:{element:"input",type:"month",editable:!0,textBased:!0},number:{element:"input",type:"number",editable:!0,textBased:!0},password:{element:"input",type:"password",editable:!0,textBased:!0},search:{element:"input",type:"search",editable:!0,textBased:!0},tel:{element:"input",type:"tel",editable:!0,textBased:!0},textarea:{element:"textarea",editable:!0,textBased:!0},time:{element:"input",type:"time",editable:!0,textBased:!0},url:{element:"input",type:"url",editable:!0,textBased:!0},week:{element:"input",type:"week",editable:!0,textBased:!0},checkbox:{element:"input",type:"checkbox",editable:!0,textBased:!1},color:{element:"input",type:"color",editable:!0,textBased:!1},file:{element:"input",type:"file",editable:!0,textBased:!1},range:{element:"input",type:"range",editable:!0,textBased:!1},select:{element:"select",editable:!0,textBased:!1},checklist:{element:"div",editable:!1,textBased:!1},horizontalFieldGroup:{element:"div",editable:!1,textBased:!1},radio:{element:"div",editable:!1,textBased:!1},button:{element:"button",type:"button",editable:!1,textBased:!1},hidden:{element:"input",type:"hidden",editable:!1,textBased:!1},image:{element:"input",type:"image",editable:!1,textBased:!1},legend:{element:"legend",editable:!1,textBased:!1},reset:{element:"button",type:"reset",editable:!1,textBased:!1},submit:{element:"button",type:"submit",editable:!1,textBased:!1}};e.when(t(r)(n)).then(function(e){var t={},s="",r="",d="",c=function(e,o){var n=angular.element(a[0].createElement(l[e.type].element));if(e.controllerAs&&(s=e.controllerAs+"."),e.isSubmitedVar&&(d=e.controllerAs+"."+e.isSubmitedVar),angular.isDefined(l[e.type].type)&&n.attr("type",l[e.type].type),angular.isDefined(l[e.type].editable)&&l[e.type].editable&&(e.field&&n.attr("name",e.field),e.ngModel&&(e.isAttachControllerAs&&0==e.isAttachControllerAs?n.attr("ng-model",e.ngModel):n.attr("ng-model",s+e.ngModel)),e.isRequire&&n.attr("ng-required",e.isRequire),angular.isDefined(e.readonly)&&n.attr("ng-readonly",e.readonly),angular.isDefined(e.val)&&n.attr("value",e.val)),angular.isDefined(l[e.type].textBased)&&l[e.type].textBased&&(angular.isDefined(e.minLength)&&n.attr("ng-minlength",e.minLength),angular.isDefined(e.maxLength)&&n.attr("ng-maxlength",e.maxLength),angular.isDefined(e.validate)&&n.attr("ng-pattern",e.validate),e.placeholder&&e.placeholder.length>0&&n.attr("placeholder",e.placeholder),e.isReadOnly&&n.attr("ng-readonly",e.isReadOnly)),e.name&&(r=e.name,n.attr("name",s+e.name)),e.fieldClass&&n.addClass(e.fieldClass),e.type.indexOf("form")>=0&&n.attr("action","#"),e.ngClick&&["button","legend","reset","submit"].indexOf(e.type)>-1&&n.attr("ng-click",s+e.ngClick),e.ngShow&&n.attr("ng-show",e.ngShow),e.uiView&&n.attr("ui-view",e.uiView),"checkbox"===e.type?(angular.isDefined(e.isOn)&&n.attr("ng-true-value",e.isOn),angular.isDefined(e.isOff)&&n.attr("ng-false-value",e.isOff),angular.isDefined(e.slaveTo)&&n.attr("ng-checked",e.slaveTo)):"select"===e.type&&(angular.isDefined(e.multiple)&&e.multiple!==!1&&n.attr("multiple","multiple"),angular.isDefined(e.empty)&&e.empty!==!1&&n.append(angular.element(a[0].createElement("option")).attr("value","").html(e.empty)),angular.isDefined(e.ngOptions)?n.attr("ng-options",e.ngOptions):angular.isDefined(e.options)&&(angular.forEach(e.options,function(e,o){newChild=angular.element(a[0].createElement("option")),newChild.attr("value",o),angular.isDefined(e.disabled)&&newChild.attr("ng-disabled",e.disabled),angular.isDefined(e.slaveTo)&&newChild.attr("ng-selected",e.slaveTo),angular.isDefined(e.label)&&newChild.html(e.label),angular.isDefined(e.group)?(angular.isDefined(t[e.group])||(t[e.group]=angular.element(a[0].createElement("optgroup")),t[e.group].attr("label",e.group)),t[e.group].append(newChild)):n.append(newChild)}),angular.equals(t,{})||(angular.forEach(t,function(e){n.append(e)}),t={}))),angular.isDefined(e.label))if(["button","legend","reset","submit","h1","h2","h3","span"].indexOf(e.type)>-1)n.html(e.label),this.append(n);else{var i=angular.element("<div></div>");e.formGroupClass&&i.attr("class",e.formGroupClass);var u=angular.element("<label>"+e.label+":</label>");e.labelClass&&u.attr("class",e.labelClass);var m=angular.element("<div></div>");e.fieldGroupClass&&m.attr("class",e.fieldGroupClass),m.append(n),e.isRequire&&(u.append(angular.element('<span class="required"> * </span>')),e.requiredHelpBlock&&m.append(angular.element('<span for="'+e.field+'" class="help-block" ng-show=" '+d+" && "+s+r+"."+e.field+'.$error.required">'+e.requiredHelpBlock+"</span>")),i.attr("ng-class","{'has-error' : "+d+" && "+s+r+"."+e.field+".$invalid}")),e.type.indexOf("email")>-1&&e.emailHelpBlock&&m.append(angular.element('<span for="'+e.field+'" class="help-block" ng-show=" '+d+" && "+s+r+"."+e.field+'.$error.email">'+e.emailHelpBlock+"</span>")),i.append(u),i.append(m),this.append(i)}else this.append(n);if(e.fields)if(e.type.indexOf("table")>-1){var p=angular.element("<thead></thead>"),g=angular.element("<tbody></tbody>"),f=angular.element("<tr></tr>"),h=angular.element("<tr></tr>"),y=angular.element("<tr></tr>"),b="",k="",C=(angular.element("<p> "+s+e.dataSource+"= {{controllerAs + field.dataSource}}</p>"),null);e.ngClick&&(C=s+e.ngClick),angular.forEach(e.fields,function(t,o){var a=angular.element("<th></th>"),n=angular.element("<td></td>");if(t.type){console.log("value = ",t);var i={};i.element=t,angular.forEach(i,c,n)}else{var r="";t.filter&&(r=t.filter),n.html("{{row."+t.field+r+"}}")}if(e.isSearch&&!t.type)if(t.rangeFilter){console.log("range filter");var l=angular.element("<td></td>");angular.forEach(t.rangeFilter.template,c,l),l.append(d),h.append(l),k+=t.rangeFilter.filter}else{console.log(" filter");var l=angular.element("<td></td>"),d=angular.element('<input type="text" class="form-control" ng-model="'+s+"search."+t.field+'"></input>');l.append(d),h.append(l),b=b.length>0?b+","+t.field+":"+s+"search."+t.field:t.field+":"+s+"search."+t.field,console.log(" filter = "+b)}else{var l=angular.element("<td></td>");h.append(l)}if(e.isSort&&!t.type){var u=s+"setHeader('"+t.field+"')",m=angular.element('<a ng-click="'+u+'">'+t.displayName+"</a>"),p=s+"isDown('"+t.field+"')",g=angular.element("<span></span>");g.attr("ng-show",p),g.addClass("fa fa-caret-down"),p=s+"isUp('"+t.field+"')";var v=angular.element("<span></span>");v.attr("ng-show",p),v.addClass("fa fa-caret-up"),m.append(g),m.append(v),a.append(m)}else a.html(t.displayName);C&&!t.type&&n.attr("ng-click",C),f.append(a),y.append(n)}),e.dataSource&&y.attr("ng-repeat","row in "+s+e.dataSource+"|orderBy:"+s+"currentColumnName:"+s+"currentSortReverse|filter:{"+b+"}"),p.append(f),e.isSearch&&p.append(h),g.append(y),n.append(p),n.append(g)}else angular.forEach(e.fields,c,n)},u=angular.element("<div></div>");angular.forEach(e,c,u),o(u)(n),i.replaceWith(u)})}}}]);var module=angular.module("$dynamicState",[]).provider("$dynamicState",function(e){this.$get=function(t){return{addState:function(o,a,n,i,s){var r={};i.indexOf(".html")>0?r[s]={templateUrl:i,controller:n,controllerAs:n}:r[s]={template:i,controller:n,controllerAs:n};var l=t.get(),d=_.findIndex(l,"name",o);console.log("states = ",l,d),d==-1&&(s?e.state(o,{url:"/"+a,"abstract":!1,sticky:!0,views:r}):i.indexOf(".html")>0?e.state(o,{url:"/"+a,"abstract":!1,sticky:!0,templateUrl:i,controller:n,controllerAs:n}):e.state(o,{url:"/"+a,"abstract":!1,sticky:!0,template:i,controller:n,controllerAs:n}))}}}}),module=angular.module("$logServices",["helper"]);module.config(["$provide",function(e){var t=function(e,t){function o(e,t){return"undefined"==typeof t&&(t=!1),t&&(e<10?e="00"+e:e<100&&(e="0"+e)),e.toString().length<2?"0"+e:e}return t=t||"%Y/%M/%d %h:%m:%s.%z",t.replace(/%([a-zA-Z])/g,function(t,a){switch(a){case"Y":return e.getFullYear();case"M":return o(e.getMonth()+1);case"d":return o(e.getDate());case"h":return o(e.getHours());case"m":return o(e.getMinutes());case"s":return o(e.getSeconds());case"z":return o(e.getMilliseconds(),!0);default:throw new Error("Unsupported format code: "+a)}})},o=function(e,t,o){return o=o||/\{([^\{\}]*)\}/g,e.replace(o,function(e,o){var a=o.split("."),n=t;try{for(var i in a)n=n[a[i]]}catch(s){n=e}return"string"==typeof n||"number"==typeof n?n:e})};e.decorator("$log",["$delegate","$window","LocationOfClientFactory","apiServerUrl",function(e,a,n,i){var s=[],r=["debug","info","warn","error"],l={},d="",c={};n.getLocation(function(e){c=e}),_.each(r,function(o){var a=e[o];e[o]=_.wrap(a,function(o){var a=Array.prototype.slice.call(arguments,1);o.apply(e,a);var n={userid:l.id,logtime:t(new Date),content1:a[0],browser:c.browser,country:c.country,fingerprint:c.fingerprint,ip:c.ip,loc:c.loc,region:c.region};a.length>1&&(n.content2=CircularJSON.stringify(a[1])),s.push(n),s.length>8&&u()})});var u=function(){var e=s;s=[],l&&3!=l.id&&$.post(i+"/AngularLogs/insertLogs?access_token="+d,{logs:e}).then(function(e){},function(e){})},m=function(){var e=a.navigator.userAgent,t={chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie:/internet explorer/i};for(var o in t)if(t[o].test(e))return o;return"unknown"};colorify=function(e,t){var o="chrome"==m()||"phantomjs"==m(),a=o&&void 0!==t;return a?["%c"+e,t]:[e]};var p=function(e,a,n,i){var s=function(){try{var i=Array.prototype.slice.call(arguments),s=t(new Date);i[0]=o("{0} - {1}{2}",[s,n,i[0]]),e.apply(null,i),a.indexOf("error")>=0&&u()}catch(r){console.log("LogEnhancer ERROR: "+r)}};return s.logs=[],s},g=function(t,o,a){var n="::";t=void 0!==t?t+(a||n):"",e.setUser=function(e){l=e},e.setAccessToken=function(e){d=e},e.save=u;var i={log:p(e.log,"log",t,o),info:p(e.info,"info",t,o),warn:p(e.warn,"warn",t,o),debug:p(e.debug,"debug",t,o),error:p(e.error,"error",t),setAccessToken:e.setAccessToken,setUser:e.setUser,save:e.save};return i};return e.getInstance=g,e.setUser=function(e){l=e},e.save=u,e}])}]);var getPort=function(){return console.log("Current length port is : "+(window.location.port.length+"")),0==window.location.port.length?(console.log("api port = 443"),443):(console.log("api port = 8181"),8181)},apiUrl="https://medicalbookings.redimed.com.au",getLogo=function(){return"REDIMED"};angular.module("helper",[]).factory("apiServerUrl",function(){return apiUrl+":"+getPort()+"/api"}).factory("serverUrl",function(){return apiUrl+":"+getPort()}).service("fingerPrint",function(){return function(){var e=(new Fingerprint).get();return e}}).service("browser",["$window",function(e){var t=e.navigator.userAgent,o="unknow";console.log("userAgent = ",t);var a={edge:/Edge/i,chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie11:/Trident/i,ie10:/MSIE 10/i,ie9:/MSIE 9/i,ie8:/MSIE 8/i,ie7:/MSIE 7/i,ie6:/MSIE 6/i};for(var n in a)if(a[n].test(t)){o=n;break}return function(){return console.log("browser = ",o),o}}]).factory("LocationOfClientFactory",["browser","fingerPrint","$window",function(e,t,o){var a;return{getLocation:function(n){a?(a.errortime=moment().format("YYYY/MM/DD h:mm:ss a"),n(a)):$.get("https://api.ipify.org/?format=json").success(function(i){a={},a.ip=i.ip,a.browser=e(),a.fingerprint=t(),a.errorurl=o.location.href,a.errortime=moment().format("YYYY/MM/DD h:mm:ss a"),n(a)})}}}]).filter("dateFilter",function(){return function(e){if(e){var t=e.split(/[- : T .]/),o=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]);return o}return""}}).factory("mysqlDate",function(){return function(e){if(e){var t=e.split(/[- : T .]/);if(t.length>=6){var o=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]);return o}var o=new Date(t[0],t[1]-1,t[2]);return o}return""}}).factory("storeToken",function(){var e="";return{setAccessToken:function(t){e=t},getAccessToken:function(){return e}}}),function(e,t,o){"use strict";var a=apiUrl+":"+getPort()+"/api",n="authorization",i=t.module("lbServices",["ngResource"]);i.factory("User",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/Users/:id",{id:"@id"},{prototype$__findById__accessTokens:{params:{fk:"@fk"},url:a+"/Users/:id/accessTokens/:fk",method:"GET"},prototype$__destroyById__accessTokens:{params:{fk:"@fk"},url:a+"/Users/:id/accessTokens/:fk",method:"DELETE"},prototype$__updateById__accessTokens:{params:{fk:"@fk"},url:a+"/Users/:id/accessTokens/:fk",method:"PUT"},prototype$__get__accessTokens:{isArray:!0,url:a+"/Users/:id/accessTokens",method:"GET"},prototype$__create__accessTokens:{url:a+"/Users/:id/accessTokens",method:"POST"},prototype$__delete__accessTokens:{url:a+"/Users/:id/accessTokens",method:"DELETE"},prototype$__count__accessTokens:{url:a+"/Users/:id/accessTokens/count",method:"GET"},create:{url:a+"/Users",method:"POST"},createMany:{isArray:!0,url:a+"/Users",method:"POST"},upsert:{url:a+"/Users",method:"PUT"},exists:{url:a+"/Users/:id/exists",method:"GET"},findById:{url:a+"/Users/:id",method:"GET"},find:{isArray:!0,url:a+"/Users",method:"GET"},findOne:{url:a+"/Users/findOne",method:"GET"},updateAll:{url:a+"/Users/update",method:"POST"},deleteById:{url:a+"/Users/:id",method:"DELETE"},count:{url:a+"/Users/count",method:"GET"},prototype$updateAttributes:{url:a+"/Users/:id",method:"PUT"},createChangeStream:{url:a+"/Users/change-stream",method:"POST"},login:{params:{include:[{relation:"user",scope:{include:["AccountCompanies"]}}]},interceptor:{response:function(e){var o=e.data;return t.setUser(o.id,o.userId,o.user),t.rememberMe=e.config.params.rememberMe!==!1,t.save(),e.resource}},url:a+"/Users/login",method:"POST"},logout:{interceptor:{response:function(e){return t.clearUser(),t.clearStorage(),e.resource}},url:a+"/Users/logout",method:"POST"},confirm:{url:a+"/Users/confirm",method:"GET"},resetPassword:{url:a+"/Users/reset",method:"POST"},"::get::AccessToken::user":{url:a+"/AccessTokens/:id/user",method:"GET"},getCurrent:{url:a+"/Users/:id",method:"GET",params:{id:function(){var e=t.currentUserId;return null==e&&(e="__anonymous__"),e}},interceptor:{response:function(e){return t.currentUserData=e.data,e.resource}},__isGetCurrentUser__:!0}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.getCachedCurrent=function(){var e=t.currentUserData;return e?new n(e):null},n.isAuthenticated=function(){return null!=this.getCurrentId()},n.getCurrentId=function(){return t.currentUserId},n.modelName="User",n.accessTokens=function(){var e=o.get("AccessToken"),t=e["::get::User::accessTokens"];return t.apply(n,arguments)},n.accessTokens.count=function(){var e=o.get("AccessToken"),t=e["::count::User::accessTokens"];return t.apply(n,arguments)},n.accessTokens.create=function(){var e=o.get("AccessToken"),t=e["::create::User::accessTokens"];return t.apply(n,arguments)},n.accessTokens.createMany=function(){var e=o.get("AccessToken"),t=e["::createMany::User::accessTokens"];return t.apply(n,arguments)},n.accessTokens.destroyAll=function(){var e=o.get("AccessToken"),t=e["::delete::User::accessTokens"];return t.apply(n,arguments)},n.accessTokens.destroyById=function(){var e=o.get("AccessToken"),t=e["::destroyById::User::accessTokens"];return t.apply(n,arguments)},n.accessTokens.findById=function(){var e=o.get("AccessToken"),t=e["::findById::User::accessTokens"];return t.apply(n,arguments)},n.accessTokens.updateById=function(){var e=o.get("AccessToken"),t=e["::updateById::User::accessTokens"];return t.apply(n,arguments)},n}]),i.factory("AccessToken",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/AccessTokens/:id",{id:"@id"},{prototype$__get__user:{url:a+"/AccessTokens/:id/user",method:"GET"},create:{url:a+"/AccessTokens",method:"POST"},createMany:{isArray:!0,url:a+"/AccessTokens",method:"POST"},upsert:{url:a+"/AccessTokens",method:"PUT"},exists:{url:a+"/AccessTokens/:id/exists",method:"GET"},findById:{url:a+"/AccessTokens/:id",method:"GET"},find:{isArray:!0,url:a+"/AccessTokens",method:"GET"},findOne:{url:a+"/AccessTokens/findOne",method:"GET"},updateAll:{url:a+"/AccessTokens/update",method:"POST"},deleteById:{url:a+"/AccessTokens/:id",method:"DELETE"},count:{url:a+"/AccessTokens/count",method:"GET"},prototype$updateAttributes:{url:a+"/AccessTokens/:id",method:"PUT"},createChangeStream:{url:a+"/AccessTokens/change-stream",method:"POST"},"::findById::User::accessTokens":{params:{fk:"@fk"},url:a+"/Users/:id/accessTokens/:fk",method:"GET"},"::destroyById::User::accessTokens":{params:{fk:"@fk"},url:a+"/Users/:id/accessTokens/:fk",method:"DELETE"},"::updateById::User::accessTokens":{params:{fk:"@fk"},url:a+"/Users/:id/accessTokens/:fk",method:"PUT"},"::get::User::accessTokens":{isArray:!0,url:a+"/Users/:id/accessTokens",method:"GET"},"::create::User::accessTokens":{url:a+"/Users/:id/accessTokens",method:"POST"},"::createMany::User::accessTokens":{isArray:!0,url:a+"/Users/:id/accessTokens",method:"POST"},"::delete::User::accessTokens":{url:a+"/Users/:id/accessTokens",method:"DELETE"},"::count::User::accessTokens":{url:a+"/Users/:id/accessTokens/count",method:"GET"},"::findById::accounts::accessTokens":{params:{fk:"@fk"},url:a+"/accounts/:id/accessTokens/:fk",method:"GET"},"::destroyById::accounts::accessTokens":{params:{fk:"@fk"},url:a+"/accounts/:id/accessTokens/:fk",method:"DELETE"},"::updateById::accounts::accessTokens":{params:{fk:"@fk"},url:a+"/accounts/:id/accessTokens/:fk",method:"PUT"},"::get::accounts::accessTokens":{isArray:!0,url:a+"/accounts/:id/accessTokens",method:"GET"},"::create::accounts::accessTokens":{url:a+"/accounts/:id/accessTokens",method:"POST"},"::createMany::accounts::accessTokens":{isArray:!0,url:a+"/accounts/:id/accessTokens",method:"POST"},"::delete::accounts::accessTokens":{url:a+"/accounts/:id/accessTokens",method:"DELETE"},"::count::accounts::accessTokens":{url:a+"/accounts/:id/accessTokens/count",method:"GET"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="AccessToken",n.user=function(){var e=o.get("User"),t=e["::get::AccessToken::user"];return t.apply(n,arguments)},n}]),i.factory("Accounts",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/accounts/:id",{id:"@id"},{prototype$__findById__accessTokens:{params:{fk:"@fk"},url:a+"/accounts/:id/accessTokens/:fk",method:"GET"},prototype$__destroyById__accessTokens:{params:{fk:"@fk"},url:a+"/accounts/:id/accessTokens/:fk",method:"DELETE"},prototype$__updateById__accessTokens:{params:{fk:"@fk"},url:a+"/accounts/:id/accessTokens/:fk",method:"PUT"},prototype$__get__company:{url:a+"/accounts/:id/company",method:"GET"},prototype$__get__accessTokens:{isArray:!0,url:a+"/accounts/:id/accessTokens",method:"GET"},prototype$__create__accessTokens:{url:a+"/accounts/:id/accessTokens",method:"POST"},prototype$__delete__accessTokens:{url:a+"/accounts/:id/accessTokens",method:"DELETE"},prototype$__count__accessTokens:{url:a+"/accounts/:id/accessTokens/count",method:"GET"},create:{url:a+"/accounts",method:"POST"},createMany:{isArray:!0,url:a+"/accounts",method:"POST"},upsert:{url:a+"/accounts",method:"PUT"},exists:{url:a+"/accounts/:id/exists",method:"GET"},findById:{url:a+"/accounts/:id",method:"GET"},find:{isArray:!0,url:a+"/accounts",method:"GET"},findOne:{url:a+"/accounts/findOne",method:"GET"},updateAll:{url:a+"/accounts/update",method:"POST"},deleteById:{url:a+"/accounts/:id",method:"DELETE"},count:{url:a+"/accounts/count",method:"GET"},prototype$updateAttributes:{url:a+"/accounts/:id",method:"PUT"},createChangeStream:{url:a+"/accounts/change-stream",method:"POST"},login:{params:{include:"user"},interceptor:{response:function(e){var o=e.data;return t.setUser(o.id,o.userId,o.user),t.rememberMe=e.config.params.rememberMe!==!1,t.save(),e.resource}},url:a+"/accounts/login",method:"POST"},logout:{interceptor:{response:function(e){return t.clearUser(),t.clearStorage(),e.resource}},url:a+"/accounts/logout",method:"POST"},confirm:{url:a+"/accounts/confirm",method:"GET"},resetPassword:{url:a+"/accounts/reset",method:"POST"},updateAccount:{url:a+"/accounts/updateAccount",method:"POST"},updatePassword:{url:a+"/accounts/updatePassword",method:"POST"},setCompany:{url:a+"/accounts/setCompany",method:"POST"},"::findById::Companies::accounts":{params:{fk:"@fk"},url:a+"/Companies/:id/accounts/:fk",method:"GET"},"::destroyById::Companies::accounts":{params:{fk:"@fk"},url:a+"/Companies/:id/accounts/:fk",method:"DELETE"},"::updateById::Companies::accounts":{params:{fk:"@fk"},url:a+"/Companies/:id/accounts/:fk",method:"PUT"},"::get::Companies::accounts":{isArray:!0,url:a+"/Companies/:id/accounts",method:"GET"},"::create::Companies::accounts":{url:a+"/Companies/:id/accounts",method:"POST"},"::createMany::Companies::accounts":{isArray:!0,url:a+"/Companies/:id/accounts",method:"POST"},"::delete::Companies::accounts":{url:a+"/Companies/:id/accounts",method:"DELETE"},"::count::Companies::accounts":{url:a+"/Companies/:id/accounts/count",method:"GET"},getCurrent:{url:a+"/accounts/:id",method:"GET",params:{id:function(){var e=t.currentUserId;return null==e&&(e="__anonymous__"),e}},interceptor:{response:function(e){return t.currentUserData=e.data,e.resource}},__isGetCurrentUser__:!0}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.getCachedCurrent=function(){var e=t.currentUserData;return e?new n(e):null},n.isAuthenticated=function(){return null!=this.getCurrentId()},n.getCurrentId=function(){return t.currentUserId},n.modelName="Accounts",n.accessTokens=function(){var e=o.get("AccessToken"),t=e["::get::accounts::accessTokens"];return t.apply(n,arguments)},n.accessTokens.count=function(){var e=o.get("AccessToken"),t=e["::count::accounts::accessTokens"];return t.apply(n,arguments)},n.accessTokens.create=function(){var e=o.get("AccessToken"),t=e["::create::accounts::accessTokens"];return t.apply(n,arguments)},n.accessTokens.createMany=function(){var e=o.get("AccessToken"),t=e["::createMany::accounts::accessTokens"];return t.apply(n,arguments)},n.accessTokens.destroyAll=function(){var e=o.get("AccessToken"),t=e["::delete::accounts::accessTokens"];return t.apply(n,arguments)},n.accessTokens.destroyById=function(){var e=o.get("AccessToken"),t=e["::destroyById::accounts::accessTokens"];return t.apply(n,arguments)},n.accessTokens.findById=function(){var e=o.get("AccessToken"),t=e["::findById::accounts::accessTokens"];return t.apply(n,arguments)},n.accessTokens.updateById=function(){var e=o.get("AccessToken"),t=e["::updateById::accounts::accessTokens"];return t.apply(n,arguments)},n.company=function(){var e=o.get("Companies"),t=e["::get::accounts::company"];return t.apply(n,arguments)},n}]),i.factory("BookingHeaders",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/BookingHeaders/:id",{id:"@id"},{prototype$__findById__candidates:{params:{fk:"@fk"},url:a+"/BookingHeaders/:id/candidates/:fk",method:"GET"},prototype$__destroyById__candidates:{params:{fk:"@fk"},url:a+"/BookingHeaders/:id/candidates/:fk",method:"DELETE"},prototype$__updateById__candidates:{params:{fk:"@fk"},url:a+"/BookingHeaders/:id/candidates/:fk",method:"PUT"},prototype$__get__candidates:{isArray:!0,url:a+"/BookingHeaders/:id/candidates",method:"GET"},prototype$__create__candidates:{url:a+"/BookingHeaders/:id/candidates",method:"POST"},prototype$__delete__candidates:{url:a+"/BookingHeaders/:id/candidates",method:"DELETE"},prototype$__count__candidates:{url:a+"/BookingHeaders/:id/candidates/count",method:"GET"},create:{url:a+"/BookingHeaders",method:"POST"},createMany:{isArray:!0,url:a+"/BookingHeaders",method:"POST"},upsert:{url:a+"/BookingHeaders",method:"PUT"},exists:{url:a+"/BookingHeaders/:id/exists",method:"GET"},findById:{url:a+"/BookingHeaders/:id",method:"GET"},find:{isArray:!0,url:a+"/BookingHeaders",method:"GET"},findOne:{url:a+"/BookingHeaders/findOne",method:"GET"},updateAll:{url:a+"/BookingHeaders/update",method:"POST"},deleteById:{url:a+"/BookingHeaders/:id",method:"DELETE"},count:{url:a+"/BookingHeaders/count",method:"GET"},prototype$updateAttributes:{url:a+"/BookingHeaders/:id",method:"PUT"},createChangeStream:{url:a+"/BookingHeaders/change-stream",method:"POST"},submitBooking:{url:a+"/BookingHeaders/submitBooking",method:"POST"},updateBooking:{url:a+"/BookingHeaders/updateBooking",method:"POST"},transferEform:{url:a+"/BookingHeaders/transferEform",method:"POST"},cancelBooking:{url:a+"/BookingHeaders/cancelBooking",method:"POST"},emailBookingForm:{url:a+"/BookingHeaders/emailBookingForm",method:"POST"},submitPhoneBooking:{url:a+"/BookingHeaders/submitPhoneBooking",method:"POST"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="BookingHeaders",n.candidates=function(){var e=o.get("BookingCandidates"),t=e["::get::BookingHeaders::candidates"];return t.apply(n,arguments)},n.candidates.count=function(){var e=o.get("BookingCandidates"),t=e["::count::BookingHeaders::candidates"];return t.apply(n,arguments)},n.candidates.create=function(){var e=o.get("BookingCandidates"),t=e["::create::BookingHeaders::candidates"];return t.apply(n,arguments)},n.candidates.createMany=function(){var e=o.get("BookingCandidates"),t=e["::createMany::BookingHeaders::candidates"];return t.apply(n,arguments)},n.candidates.destroyAll=function(){var e=o.get("BookingCandidates"),t=e["::delete::BookingHeaders::candidates"];return t.apply(n,arguments)},n.candidates.destroyById=function(){var e=o.get("BookingCandidates"),t=e["::destroyById::BookingHeaders::candidates"];return t.apply(n,arguments)},n.candidates.findById=function(){var e=o.get("BookingCandidates"),t=e["::findById::BookingHeaders::candidates"];return t.apply(n,arguments)},n.candidates.updateById=function(){var e=o.get("BookingCandidates"),t=e["::updateById::BookingHeaders::candidates"];return t.apply(n,arguments)},n}]),i.factory("BookingCandidates",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/BookingCandidates/:id",{id:"@id"},{create:{url:a+"/BookingCandidates",method:"POST"},createMany:{isArray:!0,url:a+"/BookingCandidates",method:"POST"},upsert:{url:a+"/BookingCandidates",method:"PUT"},exists:{url:a+"/BookingCandidates/:id/exists",method:"GET"},findById:{url:a+"/BookingCandidates/:id",method:"GET"},find:{isArray:!0,url:a+"/BookingCandidates",method:"GET"},findOne:{url:a+"/BookingCandidates/findOne",method:"GET"},updateAll:{url:a+"/BookingCandidates/update",method:"POST"},deleteById:{url:a+"/BookingCandidates/:id",method:"DELETE"},count:{url:a+"/BookingCandidates/count",method:"GET"},prototype$updateAttributes:{url:a+"/BookingCandidates/:id",method:"PUT"},createChangeStream:{url:a+"/BookingCandidates/change-stream",method:"POST"},sendConfirmationEmail:{url:a+"/BookingCandidates/sendConfirmationEmail",method:"GET"},"::findById::BookingHeaders::candidates":{params:{fk:"@fk"},url:a+"/BookingHeaders/:id/candidates/:fk",method:"GET"},"::destroyById::BookingHeaders::candidates":{params:{fk:"@fk"},url:a+"/BookingHeaders/:id/candidates/:fk",method:"DELETE"},"::updateById::BookingHeaders::candidates":{params:{fk:"@fk"},url:a+"/BookingHeaders/:id/candidates/:fk",method:"PUT"},"::get::BookingHeaders::candidates":{isArray:!0,url:a+"/BookingHeaders/:id/candidates",method:"GET"},"::create::BookingHeaders::candidates":{url:a+"/BookingHeaders/:id/candidates",method:"POST"},"::createMany::BookingHeaders::candidates":{isArray:!0,url:a+"/BookingHeaders/:id/candidates",method:"POST"},"::delete::BookingHeaders::candidates":{url:a+"/BookingHeaders/:id/candidates",method:"DELETE"},"::count::BookingHeaders::candidates":{url:a+"/BookingHeaders/:id/candidates/count",method:"GET"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="BookingCandidates",n}]),i.factory("Positions",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/Positions/:id",{id:"@id"},{create:{url:a+"/Positions",method:"POST"},createMany:{isArray:!0,url:a+"/Positions",method:"POST"},upsert:{url:a+"/Positions",method:"PUT"},exists:{url:a+"/Positions/:id/exists",method:"GET"},findById:{url:a+"/Positions/:id",method:"GET"},find:{isArray:!0,url:a+"/Positions",method:"GET"},findOne:{url:a+"/Positions/findOne",method:"GET"},updateAll:{url:a+"/Positions/update",method:"POST"},deleteById:{url:a+"/Positions/:id",method:"DELETE"
},count:{url:a+"/Positions/count",method:"GET"},prototype$updateAttributes:{url:a+"/Positions/:id",method:"PUT"},createChangeStream:{url:a+"/Positions/change-stream",method:"POST"},"::findById::Companies::positions":{params:{fk:"@fk"},url:a+"/Companies/:id/positions/:fk",method:"GET"},"::destroyById::Companies::positions":{params:{fk:"@fk"},url:a+"/Companies/:id/positions/:fk",method:"DELETE"},"::updateById::Companies::positions":{params:{fk:"@fk"},url:a+"/Companies/:id/positions/:fk",method:"PUT"},"::get::Companies::positions":{isArray:!0,url:a+"/Companies/:id/positions",method:"GET"},"::create::Companies::positions":{url:a+"/Companies/:id/positions",method:"POST"},"::createMany::Companies::positions":{isArray:!0,url:a+"/Companies/:id/positions",method:"POST"},"::delete::Companies::positions":{url:a+"/Companies/:id/positions",method:"DELETE"},"::count::Companies::positions":{url:a+"/Companies/:id/positions/count",method:"GET"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="Positions",n}]),i.factory("Packages",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/Packages/:id",{id:"@id"},{prototype$__findById__Assessments:{params:{fk:"@fk"},url:a+"/Packages/:id/Assessments/:fk",method:"GET"},prototype$__destroyById__Assessments:{params:{fk:"@fk"},url:a+"/Packages/:id/Assessments/:fk",method:"DELETE"},prototype$__updateById__Assessments:{params:{fk:"@fk"},url:a+"/Packages/:id/Assessments/:fk",method:"PUT"},prototype$__link__Assessments:{params:{fk:"@fk"},url:a+"/Packages/:id/Assessments/rel/:fk",method:"PUT"},prototype$__unlink__Assessments:{params:{fk:"@fk"},url:a+"/Packages/:id/Assessments/rel/:fk",method:"DELETE"},prototype$__exists__Assessments:{params:{fk:"@fk"},url:a+"/Packages/:id/Assessments/rel/:fk",method:"HEAD"},prototype$__findById__packagesAssessments:{params:{fk:"@fk"},url:a+"/Packages/:id/packagesAssessments/:fk",method:"GET"},prototype$__destroyById__packagesAssessments:{params:{fk:"@fk"},url:a+"/Packages/:id/packagesAssessments/:fk",method:"DELETE"},prototype$__updateById__packagesAssessments:{params:{fk:"@fk"},url:a+"/Packages/:id/packagesAssessments/:fk",method:"PUT"},prototype$__findById__AssessmentHeaders:{params:{fk:"@fk"},url:a+"/Packages/:id/AssessmentHeaders/:fk",method:"GET"},prototype$__destroyById__AssessmentHeaders:{params:{fk:"@fk"},url:a+"/Packages/:id/AssessmentHeaders/:fk",method:"DELETE"},prototype$__updateById__AssessmentHeaders:{params:{fk:"@fk"},url:a+"/Packages/:id/AssessmentHeaders/:fk",method:"PUT"},prototype$__get__Assessments:{isArray:!0,url:a+"/Packages/:id/Assessments",method:"GET"},prototype$__create__Assessments:{url:a+"/Packages/:id/Assessments",method:"POST"},prototype$__delete__Assessments:{url:a+"/Packages/:id/Assessments",method:"DELETE"},prototype$__count__Assessments:{url:a+"/Packages/:id/Assessments/count",method:"GET"},prototype$__get__packagesAssessments:{isArray:!0,url:a+"/Packages/:id/packagesAssessments",method:"GET"},prototype$__create__packagesAssessments:{url:a+"/Packages/:id/packagesAssessments",method:"POST"},prototype$__delete__packagesAssessments:{url:a+"/Packages/:id/packagesAssessments",method:"DELETE"},prototype$__count__packagesAssessments:{url:a+"/Packages/:id/packagesAssessments/count",method:"GET"},prototype$__get__AssessmentHeaders:{isArray:!0,url:a+"/Packages/:id/AssessmentHeaders",method:"GET"},prototype$__create__AssessmentHeaders:{url:a+"/Packages/:id/AssessmentHeaders",method:"POST"},prototype$__delete__AssessmentHeaders:{url:a+"/Packages/:id/AssessmentHeaders",method:"DELETE"},prototype$__count__AssessmentHeaders:{url:a+"/Packages/:id/AssessmentHeaders/count",method:"GET"},create:{url:a+"/Packages",method:"POST"},createMany:{isArray:!0,url:a+"/Packages",method:"POST"},upsert:{url:a+"/Packages",method:"PUT"},exists:{url:a+"/Packages/:id/exists",method:"GET"},findById:{url:a+"/Packages/:id",method:"GET"},find:{isArray:!0,url:a+"/Packages",method:"GET"},findOne:{url:a+"/Packages/findOne",method:"GET"},updateAll:{url:a+"/Packages/update",method:"POST"},deleteById:{url:a+"/Packages/:id",method:"DELETE"},count:{url:a+"/Packages/count",method:"GET"},prototype$updateAttributes:{url:a+"/Packages/:id",method:"PUT"},createChangeStream:{url:a+"/Packages/change-stream",method:"POST"},upsertPackage:{url:a+"/Packages/upsertPackage",method:"POST"},listAssessments:{url:a+"/Packages/assessments",method:"GET"},"::findById::Companies::packages":{params:{fk:"@fk"},url:a+"/Companies/:id/packages/:fk",method:"GET"},"::destroyById::Companies::packages":{params:{fk:"@fk"},url:a+"/Companies/:id/packages/:fk",method:"DELETE"},"::updateById::Companies::packages":{params:{fk:"@fk"},url:a+"/Companies/:id/packages/:fk",method:"PUT"},"::get::Companies::packages":{isArray:!0,url:a+"/Companies/:id/packages",method:"GET"},"::create::Companies::packages":{url:a+"/Companies/:id/packages",method:"POST"},"::createMany::Companies::packages":{isArray:!0,url:a+"/Companies/:id/packages",method:"POST"},"::delete::Companies::packages":{url:a+"/Companies/:id/packages",method:"DELETE"},"::count::Companies::packages":{url:a+"/Companies/:id/packages/count",method:"GET"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="Packages",n}]),i.factory("Companies",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/Companies/:id",{id:"@id"},{prototype$__findById__packages:{params:{fk:"@fk"},url:a+"/Companies/:id/packages/:fk",method:"GET"},prototype$__destroyById__packages:{params:{fk:"@fk"},url:a+"/Companies/:id/packages/:fk",method:"DELETE"},prototype$__updateById__packages:{params:{fk:"@fk"},url:a+"/Companies/:id/packages/:fk",method:"PUT"},prototype$__findById__positions:{params:{fk:"@fk"},url:a+"/Companies/:id/positions/:fk",method:"GET"},prototype$__destroyById__positions:{params:{fk:"@fk"},url:a+"/Companies/:id/positions/:fk",method:"DELETE"},prototype$__updateById__positions:{params:{fk:"@fk"},url:a+"/Companies/:id/positions/:fk",method:"PUT"},prototype$__findById__accounts:{params:{fk:"@fk"},url:a+"/Companies/:id/accounts/:fk",method:"GET"},prototype$__destroyById__accounts:{params:{fk:"@fk"},url:a+"/Companies/:id/accounts/:fk",method:"DELETE"},prototype$__updateById__accounts:{params:{fk:"@fk"},url:a+"/Companies/:id/accounts/:fk",method:"PUT"},prototype$__findById__subsidiaries:{params:{fk:"@fk"},url:a+"/Companies/:id/subsidiaries/:fk",method:"GET"},prototype$__destroyById__subsidiaries:{params:{fk:"@fk"},url:a+"/Companies/:id/subsidiaries/:fk",method:"DELETE"},prototype$__updateById__subsidiaries:{params:{fk:"@fk"},url:a+"/Companies/:id/subsidiaries/:fk",method:"PUT"},prototype$__findById__bookings:{params:{fk:"@fk"},url:a+"/Companies/:id/bookings/:fk",method:"GET"},prototype$__destroyById__bookings:{params:{fk:"@fk"},url:a+"/Companies/:id/bookings/:fk",method:"DELETE"},prototype$__updateById__bookings:{params:{fk:"@fk"},url:a+"/Companies/:id/bookings/:fk",method:"PUT"},prototype$__get__packages:{isArray:!0,url:a+"/Companies/:id/packages",method:"GET"},prototype$__create__packages:{url:a+"/Companies/:id/packages",method:"POST"},prototype$__delete__packages:{url:a+"/Companies/:id/packages",method:"DELETE"},prototype$__count__packages:{url:a+"/Companies/:id/packages/count",method:"GET"},prototype$__get__positions:{isArray:!0,url:a+"/Companies/:id/positions",method:"GET"},prototype$__create__positions:{url:a+"/Companies/:id/positions",method:"POST"},prototype$__delete__positions:{url:a+"/Companies/:id/positions",method:"DELETE"},prototype$__count__positions:{url:a+"/Companies/:id/positions/count",method:"GET"},prototype$__get__accounts:{isArray:!0,url:a+"/Companies/:id/accounts",method:"GET"},prototype$__create__accounts:{url:a+"/Companies/:id/accounts",method:"POST"},prototype$__delete__accounts:{url:a+"/Companies/:id/accounts",method:"DELETE"},prototype$__count__accounts:{url:a+"/Companies/:id/accounts/count",method:"GET"},prototype$__get__subsidiaries:{isArray:!0,url:a+"/Companies/:id/subsidiaries",method:"GET"},prototype$__create__subsidiaries:{url:a+"/Companies/:id/subsidiaries",method:"POST"},prototype$__delete__subsidiaries:{url:a+"/Companies/:id/subsidiaries",method:"DELETE"},prototype$__count__subsidiaries:{url:a+"/Companies/:id/subsidiaries/count",method:"GET"},prototype$__get__bookings:{isArray:!0,url:a+"/Companies/:id/bookings",method:"GET"},prototype$__create__bookings:{url:a+"/Companies/:id/bookings",method:"POST"},prototype$__delete__bookings:{url:a+"/Companies/:id/bookings",method:"DELETE"},prototype$__count__bookings:{url:a+"/Companies/:id/bookings/count",method:"GET"},create:{url:a+"/Companies",method:"POST"},createMany:{isArray:!0,url:a+"/Companies",method:"POST"},upsert:{url:a+"/Companies",method:"PUT"},exists:{url:a+"/Companies/:id/exists",method:"GET"},findById:{url:a+"/Companies/:id",method:"GET"},find:{isArray:!0,url:a+"/Companies",method:"GET"},findOne:{url:a+"/Companies/findOne",method:"GET"},updateAll:{url:a+"/Companies/update",method:"POST"},deleteById:{url:a+"/Companies/:id",method:"DELETE"},count:{url:a+"/Companies/count",method:"GET"},prototype$updateAttributes:{url:a+"/Companies/:id",method:"PUT"},createChangeStream:{url:a+"/Companies/change-stream",method:"POST"},getRediSubsidiaries:{url:a+"/Companies/getRediSubsidiaries",method:"GET"},initData:{url:a+"/Companies/initData",method:"GET"},getPackages:{url:a+"/Companies/getPackages",method:"POST"},getAssessments:{url:a+"/Companies/getAssessments",method:"GET"},getPhoneBookingHeader:{url:a+"/Companies/getPhoneBookingHeader",method:"GET"},listBookings:{url:a+"/Companies/listBookings",method:"GET"},listTelehealthBookings:{url:a+"/Companies/listTelehealthBookings",method:"GET"},countBookings:{url:a+"/Companies/countBookings",method:"GET"},listUser:{url:a+"/Companies/list-user",method:"GET"},getSites:{url:a+"/Companies/getSites",method:"GET"},getCalendars:{url:a+"/Companies/getCalendars",method:"POST"},getRosters:{url:a+"/Companies/getRosters",method:"POST"},getResources:{url:a+"/Companies/getResources",method:"POST"},getEvents:{url:a+"/Companies/getEvents",method:"POST"},removeSlots:{url:a+"/Companies/removeSlots",method:"POST"},unRemoveSlots:{url:a+"/Companies/unRemoveSlots",method:"POST"},synSites:{url:a+"/Companies/synSites",method:"GET"},synCalendars:{url:a+"/Companies/synCalendars",method:"GET"},getPeriod:{url:a+"/Companies/getPeriod",method:"POST"},getStatus:{url:a+"/Companies/getStatus",method:"GET"},"::get::accounts::company":{url:a+"/accounts/:id/company",method:"GET"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="Companies",n.packages=function(){var e=o.get("Packages"),t=e["::get::Companies::packages"];return t.apply(n,arguments)},n.packages.count=function(){var e=o.get("Packages"),t=e["::count::Companies::packages"];return t.apply(n,arguments)},n.packages.create=function(){var e=o.get("Packages"),t=e["::create::Companies::packages"];return t.apply(n,arguments)},n.packages.createMany=function(){var e=o.get("Packages"),t=e["::createMany::Companies::packages"];return t.apply(n,arguments)},n.packages.destroyAll=function(){var e=o.get("Packages"),t=e["::delete::Companies::packages"];return t.apply(n,arguments)},n.packages.destroyById=function(){var e=o.get("Packages"),t=e["::destroyById::Companies::packages"];return t.apply(n,arguments)},n.packages.findById=function(){var e=o.get("Packages"),t=e["::findById::Companies::packages"];return t.apply(n,arguments)},n.packages.updateById=function(){var e=o.get("Packages"),t=e["::updateById::Companies::packages"];return t.apply(n,arguments)},n.positions=function(){var e=o.get("Positions"),t=e["::get::Companies::positions"];return t.apply(n,arguments)},n.positions.count=function(){var e=o.get("Positions"),t=e["::count::Companies::positions"];return t.apply(n,arguments)},n.positions.create=function(){var e=o.get("Positions"),t=e["::create::Companies::positions"];return t.apply(n,arguments)},n.positions.createMany=function(){var e=o.get("Positions"),t=e["::createMany::Companies::positions"];return t.apply(n,arguments)},n.positions.destroyAll=function(){var e=o.get("Positions"),t=e["::delete::Companies::positions"];return t.apply(n,arguments)},n.positions.destroyById=function(){var e=o.get("Positions"),t=e["::destroyById::Companies::positions"];return t.apply(n,arguments)},n.positions.findById=function(){var e=o.get("Positions"),t=e["::findById::Companies::positions"];return t.apply(n,arguments)},n.positions.updateById=function(){var e=o.get("Positions"),t=e["::updateById::Companies::positions"];return t.apply(n,arguments)},n.accounts=function(){var e=o.get("Accounts"),t=e["::get::Companies::accounts"];return t.apply(n,arguments)},n.accounts.count=function(){var e=o.get("Accounts"),t=e["::count::Companies::accounts"];return t.apply(n,arguments)},n.accounts.create=function(){var e=o.get("Accounts"),t=e["::create::Companies::accounts"];return t.apply(n,arguments)},n.accounts.createMany=function(){var e=o.get("Accounts"),t=e["::createMany::Companies::accounts"];return t.apply(n,arguments)},n.accounts.destroyAll=function(){var e=o.get("Accounts"),t=e["::delete::Companies::accounts"];return t.apply(n,arguments)},n.accounts.destroyById=function(){var e=o.get("Accounts"),t=e["::destroyById::Companies::accounts"];return t.apply(n,arguments)},n.accounts.findById=function(){var e=o.get("Accounts"),t=e["::findById::Companies::accounts"];return t.apply(n,arguments)},n.accounts.updateById=function(){var e=o.get("Accounts"),t=e["::updateById::Companies::accounts"];return t.apply(n,arguments)},n}]),i.factory("Redimedsites",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/Redimedsites/:id",{id:"@id"},{prototype$__findById__States:{params:{fk:"@fk"},url:a+"/Redimedsites/:id/States/:fk",method:"GET"},prototype$__destroyById__States:{params:{fk:"@fk"},url:a+"/Redimedsites/:id/States/:fk",method:"DELETE"},prototype$__updateById__States:{params:{fk:"@fk"},url:a+"/Redimedsites/:id/States/:fk",method:"PUT"},prototype$__findById__AdminCalendars:{params:{fk:"@fk"},url:a+"/Redimedsites/:id/AdminCalendars/:fk",method:"GET"},prototype$__destroyById__AdminCalendars:{params:{fk:"@fk"},url:a+"/Redimedsites/:id/AdminCalendars/:fk",method:"DELETE"},prototype$__updateById__AdminCalendars:{params:{fk:"@fk"},url:a+"/Redimedsites/:id/AdminCalendars/:fk",method:"PUT"},prototype$__findById__Calendars:{params:{fk:"@fk"},url:a+"/Redimedsites/:id/Calendars/:fk",method:"GET"},prototype$__destroyById__Calendars:{params:{fk:"@fk"},url:a+"/Redimedsites/:id/Calendars/:fk",method:"DELETE"},prototype$__updateById__Calendars:{params:{fk:"@fk"},url:a+"/Redimedsites/:id/Calendars/:fk",method:"PUT"},prototype$__get__States:{isArray:!0,url:a+"/Redimedsites/:id/States",method:"GET"},prototype$__create__States:{url:a+"/Redimedsites/:id/States",method:"POST"},prototype$__delete__States:{url:a+"/Redimedsites/:id/States",method:"DELETE"},prototype$__count__States:{url:a+"/Redimedsites/:id/States/count",method:"GET"},prototype$__get__AdminCalendars:{isArray:!0,url:a+"/Redimedsites/:id/AdminCalendars",method:"GET"},prototype$__create__AdminCalendars:{url:a+"/Redimedsites/:id/AdminCalendars",method:"POST"},prototype$__delete__AdminCalendars:{url:a+"/Redimedsites/:id/AdminCalendars",method:"DELETE"},prototype$__count__AdminCalendars:{url:a+"/Redimedsites/:id/AdminCalendars/count",method:"GET"},prototype$__get__Calendars:{isArray:!0,url:a+"/Redimedsites/:id/Calendars",method:"GET"},prototype$__create__Calendars:{url:a+"/Redimedsites/:id/Calendars",method:"POST"},prototype$__delete__Calendars:{url:a+"/Redimedsites/:id/Calendars",method:"DELETE"},prototype$__count__Calendars:{url:a+"/Redimedsites/:id/Calendars/count",method:"GET"},create:{url:a+"/Redimedsites",method:"POST"},createMany:{isArray:!0,url:a+"/Redimedsites",method:"POST"},upsert:{url:a+"/Redimedsites",method:"PUT"},exists:{url:a+"/Redimedsites/:id/exists",method:"GET"},findById:{url:a+"/Redimedsites/:id",method:"GET"},find:{isArray:!0,url:a+"/Redimedsites",method:"GET"},findOne:{url:a+"/Redimedsites/findOne",method:"GET"},updateAll:{url:a+"/Redimedsites/update",method:"POST"},deleteById:{url:a+"/Redimedsites/:id",method:"DELETE"},count:{url:a+"/Redimedsites/count",method:"GET"},prototype$updateAttributes:{url:a+"/Redimedsites/:id",method:"PUT"},createChangeStream:{url:a+"/Redimedsites/change-stream",method:"POST"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="Redimedsites",n}]),i.factory("Calendar",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/Calendars/:id",{id:"@id"},{create:{url:a+"/Calendars",method:"POST"},createMany:{isArray:!0,url:a+"/Calendars",method:"POST"},upsert:{url:a+"/Calendars",method:"PUT"},exists:{url:a+"/Calendars/:id/exists",method:"GET"},findById:{url:a+"/Calendars/:id",method:"GET"},find:{isArray:!0,url:a+"/Calendars",method:"GET"},findOne:{url:a+"/Calendars/findOne",method:"GET"},updateAll:{url:a+"/Calendars/update",method:"POST"},deleteById:{url:a+"/Calendars/:id",method:"DELETE"},count:{url:a+"/Calendars/count",method:"GET"},prototype$updateAttributes:{url:a+"/Calendars/:id",method:"PUT"},createChangeStream:{url:a+"/Calendars/change-stream",method:"POST"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="Calendar",n}]),i.factory("Email",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/Emails/:id",{id:"@id"},{});return n.modelName="Email",n}]),i.factory("ClientLogs",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/ClientLogs/:id",{id:"@id"},{create:{url:a+"/ClientLogs",method:"POST"},createMany:{isArray:!0,url:a+"/ClientLogs",method:"POST"},upsert:{url:a+"/ClientLogs",method:"PUT"},exists:{url:a+"/ClientLogs/:id/exists",method:"GET"},findById:{url:a+"/ClientLogs/:id",method:"GET"},find:{isArray:!0,url:a+"/ClientLogs",method:"GET"},findOne:{url:a+"/ClientLogs/findOne",method:"GET"},updateAll:{url:a+"/ClientLogs/update",method:"POST"},deleteById:{url:a+"/ClientLogs/:id",method:"DELETE"},count:{url:a+"/ClientLogs/count",method:"GET"},prototype$updateAttributes:{url:a+"/ClientLogs/:id",method:"PUT"},createChangeStream:{url:a+"/ClientLogs/change-stream",method:"POST"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="ClientLogs",n}]),i.factory("AngularLog",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/AngularLogs/:id",{id:"@id"},{create:{url:a+"/AngularLogs",method:"POST"},createMany:{isArray:!0,url:a+"/AngularLogs",method:"POST"},upsert:{url:a+"/AngularLogs",method:"PUT"},exists:{url:a+"/AngularLogs/:id/exists",method:"GET"},findById:{url:a+"/AngularLogs/:id",method:"GET"},find:{isArray:!0,url:a+"/AngularLogs",method:"GET"},findOne:{url:a+"/AngularLogs/findOne",method:"GET"},updateAll:{url:a+"/AngularLogs/update",method:"POST"},deleteById:{url:a+"/AngularLogs/:id",method:"DELETE"},count:{url:a+"/AngularLogs/count",method:"GET"},prototype$updateAttributes:{url:a+"/AngularLogs/:id",method:"PUT"},createChangeStream:{url:a+"/AngularLogs/change-stream",method:"POST"},insertLogs:{url:a+"/AngularLogs/insertLogs",method:"POST"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="AngularLog",n}]),i.factory("BookingCandidateByApptDateV",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/BookingCandidateByApptDateVs/:id",{id:"@id"},{create:{url:a+"/BookingCandidateByApptDateVs",method:"POST"},createMany:{isArray:!0,url:a+"/BookingCandidateByApptDateVs",method:"POST"},upsert:{url:a+"/BookingCandidateByApptDateVs",method:"PUT"},exists:{url:a+"/BookingCandidateByApptDateVs/:id/exists",method:"GET"},findById:{url:a+"/BookingCandidateByApptDateVs/:id",method:"GET"},find:{isArray:!0,url:a+"/BookingCandidateByApptDateVs",method:"GET"},findOne:{url:a+"/BookingCandidateByApptDateVs/findOne",method:"GET"},updateAll:{url:a+"/BookingCandidateByApptDateVs/update",method:"POST"},deleteById:{url:a+"/BookingCandidateByApptDateVs/:id",method:"DELETE"},count:{url:a+"/BookingCandidateByApptDateVs/count",method:"GET"},prototype$updateAttributes:{url:a+"/BookingCandidateByApptDateVs/:id",method:"PUT"},createChangeStream:{url:a+"/BookingCandidateByApptDateVs/change-stream",method:"POST"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="BookingCandidateByApptDateV",n}]),i.factory("BookingCandidateByBookingDateV",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/BookingCandidateByBookingDateVs/:id",{id:"@id"},{create:{url:a+"/BookingCandidateByBookingDateVs",method:"POST"},createMany:{isArray:!0,url:a+"/BookingCandidateByBookingDateVs",method:"POST"},upsert:{url:a+"/BookingCandidateByBookingDateVs",method:"PUT"},exists:{url:a+"/BookingCandidateByBookingDateVs/:id/exists",method:"GET"},findById:{url:a+"/BookingCandidateByBookingDateVs/:id",method:"GET"},find:{isArray:!0,url:a+"/BookingCandidateByBookingDateVs",method:"GET"},findOne:{url:a+"/BookingCandidateByBookingDateVs/findOne",method:"GET"},updateAll:{url:a+"/BookingCandidateByBookingDateVs/update",method:"POST"},deleteById:{url:a+"/BookingCandidateByBookingDateVs/:id",method:"DELETE"},count:{url:a+"/BookingCandidateByBookingDateVs/count",method:"GET"},prototype$updateAttributes:{url:a+"/BookingCandidateByBookingDateVs/:id",method:"PUT"},createChangeStream:{url:a+"/BookingCandidateByBookingDateVs/change-stream",method:"POST"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="BookingCandidateByBookingDateV",n}]),i.factory("CalendarHoldings",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/CalendarHoldings/:id",{id:"@id"},{create:{url:a+"/CalendarHoldings",method:"POST"},createMany:{isArray:!0,url:a+"/CalendarHoldings",method:"POST"},upsert:{url:a+"/CalendarHoldings",method:"PUT"},exists:{url:a+"/CalendarHoldings/:id/exists",method:"GET"},findById:{url:a+"/CalendarHoldings/:id",method:"GET"},find:{isArray:!0,url:a+"/CalendarHoldings",method:"GET"},findOne:{url:a+"/CalendarHoldings/findOne",method:"GET"},updateAll:{url:a+"/CalendarHoldings/update",method:"POST"},deleteById:{url:a+"/CalendarHoldings/:id",method:"DELETE"},count:{url:a+"/CalendarHoldings/count",method:"GET"},prototype$updateAttributes:{url:a+"/CalendarHoldings/:id",method:"PUT"},createChangeStream:{url:a+"/CalendarHoldings/change-stream",method:"POST"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="CalendarHoldings",n}]),i.factory("TelehealthBookings",["LoopBackResource","LoopBackAuth","$injector",function(e,t,o){var n=e(a+"/TelehealthBookings/:id",{id:"@id"},{create:{url:a+"/TelehealthBookings",method:"POST"},createMany:{isArray:!0,url:a+"/TelehealthBookings",method:"POST"},upsert:{url:a+"/TelehealthBookings",method:"PUT"},exists:{url:a+"/TelehealthBookings/:id/exists",method:"GET"},findById:{url:a+"/TelehealthBookings/:id",method:"GET"},find:{isArray:!0,url:a+"/TelehealthBookings",method:"GET"},findOne:{url:a+"/TelehealthBookings/findOne",method:"GET"},updateAll:{url:a+"/TelehealthBookings/update",method:"POST"},deleteById:{url:a+"/TelehealthBookings/:id",method:"DELETE"},count:{url:a+"/TelehealthBookings/count",method:"GET"},prototype$updateAttributes:{url:a+"/TelehealthBookings/:id",method:"PUT"},createChangeStream:{url:a+"/TelehealthBookings/change-stream",method:"POST"},sendConfirmationEmail:{url:a+"/TelehealthBookings/sendConfirmationEmail",method:"GET"}});return n.updateOrCreate=n.upsert,n.update=n.updateAll,n.destroyById=n.deleteById,n.removeById=n.deleteById,n.modelName="TelehealthBookings",n}]),i.factory("LoopBackAuth",function(){function e(){var e=this;n.forEach(function(t){e[t]=a(t)}),this.rememberMe=o,this.currentUserData=null}function t(e,t,o){var a=i+t;null==o&&(o=""),e[a]=o}function a(e){var t=i+e;return localStorage[t]||sessionStorage[t]||null}var n=["accessTokenId","currentUserId"],i="$LoopBack$";return e.prototype.save=function(){var e=this,o=this.rememberMe?localStorage:sessionStorage;n.forEach(function(a){t(o,a,e[a])})},e.prototype.setUser=function(e,t,o){this.accessTokenId=e,this.currentUserId=t,this.currentUserData=o},e.prototype.clearUser=function(){this.accessTokenId=null,this.currentUserId=null,this.currentUserData=null},e.prototype.clearStorage=function(){n.forEach(function(e){t(sessionStorage,e,null),t(localStorage,e,null)})},new e}).config(["$httpProvider",function(e){e.interceptors.push("LoopBackAuthRequestInterceptor")}]).factory("LoopBackAuthRequestInterceptor",["$q","LoopBackAuth",function(e,t){return{request:function(i){if(i.url.substr(0,a.length)!==a)return i;if(t.accessTokenId)i.headers[n]=t.accessTokenId;else if(i.__isGetCurrentUser__){var s={body:{error:{status:401}},status:401,config:i,headers:function(){return o}};return e.reject(s)}return i||e.when(i)}}}]).provider("LoopBackResource",function(){this.setAuthHeader=function(e){n=e},this.setUrlBase=function(e){a=e},this.getUrlBase=function(){return a},this.$get=["$resource",function(e){return function(t,o,a){var n=e(t,o,a);return n.prototype.$save=function(e,t){var o=n.upsert.call(this,{},this,e,t);return o.$promise||o},n}}]})}(window,window.angular),angular.module("MasterDetailDirective",["toastr","DynamicForm","$logServices"]).directive("mainMasterDetailDirective",["$dynamicState","$q","$parse","$compile","$document","$state","$log",function(e,t,o,a,n,i,s){return{restrict:"E",scope:{},link:function(n,r,l){var d=function(e){var t="{";if("object"!=typeof e)return"string"==typeof e?"&quot;"+e.replace(/ /g,"&nbsp;")+"&quot;":e+"";for(var o in e)e.hasOwnProperty(o)&&(t+=o+":"+d(e[o])+",");return t.substring(0,t.length-1)+"}"};s.debug("direcgive setup = ");var c=i.current;s.debug("currentState = ",c),t.when(o(l.setup)(n)).then(function(t){if(s.debug("setup object = ",t),n.formDefines={},t.master&&(n.formDefines.div1={type:"div",uiView:t.master.name,ngShow:"$root.$state.includes('"+c.name+"."+t.master.name+"')"},e.addState(c.name+"."+t.master.name,"list",t.master.controller,"<my-dynamic-form formdefine = "+d(t.master.layout)+" ></my-dynamic-form>",t.master.name)),t.detail&&(n.formDefines.div2={type:"div",uiView:t.detail.name,ngShow:" $root.$state.includes('"+c.name+"."+t.detail.name+"')"},e.addState(c.name+"."+t.detail.name,"/:row",t.detail.controller,'<my-dynamic-form formdefine = "'+d(t.detail.layout)+'" ></my-dynamic-form>',t.detail.name),console.log("states = ",i.get())),t.master){var o=angular.element('<my-dynamic-form formdefine = "{{formDefines}}" ></my-dynamic-form>');a(o)(n),r.replaceWith(o),i.go(c.name+"."+t.master.name)}else{var o=angular.element("<p>"+d(t.detail.layout)+"</p>");a(o)(n),r.replaceWith(o)}})}}}]).directive("listDirective",["$q","$parse","$compile","$document",function(e,t,o,a){return{restrict:"E",scope:{},controller:"@",name:"controllerName",controllerAs:"MainCtrl",link:function(e,t,a){e[a.controllerName]=e.MainCtrl;var n=angular.element('<my-dynamic-form formdefine = "{{MainCtrl.tableDefines}}" ></my-dynamic-form>');o(n)(e),t.replaceWith(n)}}}]),angular.module("MasterDetailDirective").factory("DetailModal",["$uibModal","$log",function(e,t){t=t.getInstance("MasterDetailDirective.DetailModal");var o="",a="",n="",i={},s=function(e){t.debug("this is 'closeModal' function, please override by setCloseModalFunc() ",e)},r=function(e){t.info("Modal dismissed at: "+new Date),t.debug("this is 'dismissModal' function, please override by setDismissModalFunc() ",e)};return{setTemplateUrl:function(e){o=e},setControllerName:function(e){a=e},setSize:function(e){n=e},setCloseModalFunc:function(e){s=e},setDismissModalFunc:function(e){r=e},setResolve:function(e,t){i[e]=t,console.log("pResolve=",i)},newOrEditRow:function(t){console.log("DetailModal",o),i.row=function(){return t},console.log("pResolve=",i);var l=e.open({animation:!0,template:o,controller:a,controllerAs:a,size:n,resolve:i});l.result.then(function(e){s(e)},function(e){r(e)})}}}]).factory("DetailModal2",["$uibModal","$log",function(e,t){t=t.getInstance("MasterDetailDirective.DetailModal");var o="",a="",n="",i={},s=function(e){t.debug("this is 'closeModal' function, please override by setCloseModalFunc() ",e)},r=function(e){t.info("Modal dismissed at: "+new Date),t.debug("this is 'dismissModal' function, please override by setDismissModalFunc() ",e)};return{setTemplateUrl:function(e){o=e},setControllerName:function(e){a=e},setSize:function(e){n=e},setCloseModalFunc:function(e){s=e},setDismissModalFunc:function(e){r=e},setResolve:function(e,t){i[e]=t,console.log("pResolve=",i)},newOrEditRow:function(t){console.log("DetailModal",o),i.row=function(){return t},console.log("pResolve=",i);var l=e.open({animation:!0,template:o,controller:a,controllerAs:a,size:n,resolve:i});l.result.then(function(e){s(e)},function(e){r(e)})}}}]).factory("DeleteModal",["$uibModal","$log",function(e,t){t=t.getInstance("MasterDetailDirective.DeleteModal");var o="",a="",n="",i={},s=function(e){t.debug("this is 'closeModal' function, please override by setCloseModalFunc() ",e)},r=function(e){t.info("Modal dismissed at: "+new Date),t.debug("this is 'dismissModal' function, please override by setDismissModalFunc() ",e)};return{setTemplateUrl:function(e){o=e},setControllerName:function(e){a=e},setSize:function(e){n=e},setCloseModalFunc:function(e){s=e},setDismissModalFunc:function(e){r=e},setResolve:function(e,t){i[e]=t,console.log("pResolve=",i)},deleteRow:function(t){console.log("DetailModal",o),i.row=function(){return t},console.log("pResolve=",i);var l=e.open({animation:!0,template:o,controller:a,controllerAs:a,size:n,resolve:i});l.result.then(function(e){s(e)},function(e){r(e)})}}}]),angular.module("ocsApp.Authentication",["toastr","lbServices","ocsApp.Navigator"]).config(["$stateProvider",function(e){e.state("authentication",{"abstract":!0,views:{root:{templateUrl:"modules/Authentication/views/authen.main.html",controller:"AuthenMainCtrl",controllerAs:"AuthenMainCtrl"}}}).state("authentication.login",{url:"/",views:{"main-content":{templateUrl:"modules/Authentication/views/authen.login.html",controller:"LoginCtrl",controllerAs:"loginCtrl"}}}).state("authentication.forgotpass",{url:"/forgotpass",views:{"main-content":{templateUrl:"modules/Authentication/views/authen.forgotpass.html",controller:"ForgotPasswordCtrl",controllerAs:"forgotPasswordCtrl"}}}).state("authentication.resetpass",{url:"/reset-pass/:token",views:{"main-content":{templateUrl:"modules/Authentication/views/authen.resetpass.html",controller:"ResetPasswordCtrl",controllerAs:"resetPasswordCtrl"}}}).state("authentication.bookingreportsdirectly",{url:"/bookingreports",views:{"main-content":{templateUrl:"modules/BookingReports/views/bookingreports.main.html",controller:"BookingReportsMainCtrl",controllerAs:"BookingReportsMainCtrl"}}}).state("authentication.registration",{url:"/registration",views:{"main-content":{templateUrl:"modules/Authentication/views/authen.registration.html"}}})}]),angular.module("ocsApp.BookingReports",["toastr","zingchart-angularjs"]).config(["$stateProvider",function(e){e.state("navigator.bookingreports",{"abstract":!1,url:"/bookingreports",templateUrl:"modules/BookingReports/views/bookingreports.main.html",controller:"BookingReportsMainCtrl",controllerAs:"BookingReportsMainCtrl"})}]),angular.module("ocsApp.Bookings",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.bookings",{"abstract":!1,url:"/bookings",templateUrl:"modules/Bookings/views/bookings.main.html",controller:"BookingsMainCtrl",controllerAs:"BookingsMainCtrl"})}]),angular.module("ocsApp.Companies",["lbServices","MasterDetailDirective","ct.ui.router.extras.sticky","ct.ui.router.extras.dsr","ct.ui.router.extras.statevis"]).config(["$stateProvider","$stickyStateProvider",function(e,t){
t.enableDebug(!1),e.state("navigator.companies",{"abstract":!1,url:"/companies",controller:function(e){e=e.getInstance("ocsApp.Companies"),e.debug("I am controller of Company");var t={div:{type:"div",fieldClass:"portlet box green portet-datatable",fields:{div:{type:"div",isSubmitedVar:"isSubmitted",controllerAs:"CompaniesMainCtrl",fieldClass:"portlet-title",fields:{div1:{type:"div",fieldClass:"caption bold",fields:{span:{type:"span",label:"Company List",fieldClass:"caption-subject bold uppercase"}}},div2:{type:"div",fieldClass:"tools",fields:{newButton:{type:"button",label:"New Company",fieldClass:"btn btn-primary",ngClick:"detail()"}}}}},div2:{type:"div",fieldClass:"portlet-body",fields:{table:{type:"table",isSort:!0,isSearch:!0,dataSource:"rows",fieldClass:"table table-striped table-bordered table-hover order-column",ngClick:"detail(row)",fields:{companyName:{field:"companyName",displayName:"Company Name",width:"100"},addr:{field:"addr",displayName:"Address",width:"100"},state:{field:"state",displayName:"State",width:"100"},country:{field:"country",displayName:"Country",width:"100"},deleteRow:{type:"button",label:"Delete",displayName:"Action",fieldClass:"btn btn-warning",ngClick:"deleteRow(row)"}}}}}}}},o={div1:{type:"div",fieldClass:"modal-header",controllerAs:"NewCompanyCtrl",isSubmitedVar:"isSubmitted",fields:{h3:{type:"h3",label:"{{NewCompanyCtrl.windowTitle}}",fieldClass:"modal-title"}}},div2:{type:"div",fieldClass:"modal-body",fields:{form:{type:"form",name:"form",fieldClass:"form-horizontal form-row-seperated",fields:{companyName:{field:"companyName",ngModel:"row.companyName",label:"Company Name",placeholder:"Company name",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},addr:{field:"addr",ngModel:"row.addr",label:"Address",placeholder:"Address",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},state:{field:"state",ngModel:"row.state",label:"State",placeholder:"State",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{ACT:{label:"Australian Capital Territory"},NSW:{label:"New South Wales"},VIC:{label:"Victoria"},QLD:{label:"Queensland"},SA:{label:"South Australia"},WA:{label:"Western Australia"},NT:{label:"Northern Territory"}}},country:{field:"country",ngModel:"row.country",label:"Country",placeholder:"Country",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{Australia:{label:"Australia"}}},defaultStatus:{field:"defaultStatus",ngModel:"row.defaultStatusObject",label:"Default Status",placeholder:"Default status",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",ngOptions:"status.bookingStatus for status in NewCompanyCtrl.bookingStatus"},description:{field:"description",ngModel:"row.description",label:"Description",placeholder:"Description",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},industry:{field:"industry",ngModel:"row.industry",label:"Industry",placeholder:"Industry",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},invoiceEmail:{field:"invoiceEmail",ngModel:"row.invoiceEmail",label:"Invoice Email",placeholder:"Invoice email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Invoice email is required",emailHelpBlock:"Email is invalid"},resultEmail:{field:"resultEmail",ngModel:"row.resultEmail",label:"Result Email",placeholder:"Result email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Result email is required",emailHelpBlock:"Email is invalid"},reportToEmail:{field:"reportToEmail",ngModel:"row.reportToEmail",label:"Report Email",placeholder:"",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"email",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Report email is required",emailHelpBlock:"Email is invalid"},fieldGroup:{type:"horizontalFieldGroup",fieldClass:"col-md-12",columnClass:"col-md-3",fields:{isaddcontactemailtoresult:{field:"isaddcontactemailtoresult",ngModel:"row.isaddcontactemailtoresult",label:"Is Result Email",placeholder:"Is Result Email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},isinvoiceemailtouser:{field:"isinvoiceemailtouser",ngModel:"row.isinvoiceemailtouser",label:"Is Invoice Email",placeholder:"Is Invoice Email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},ispo:{field:"ispo",ngModel:"row.ispo",label:"PO",placeholder:"PO",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},isproject:{field:"isproject",ngModel:"row.isproject",label:"Project",placeholder:"Project",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0}}},poNumber:{field:"poNumber",ngModel:"row.poNumber",label:"PO Number",placeholder:"PO Number",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"}}},table:{type:"table",controllerAs:"NewCompanyCtrl",isSubmitedVar:"isSubmitted",dataSource:"row.subsidiaries",fieldClass:"table table-striped table-bordered table-hover order-column",ngClick:"newOrEditRow(row)",fields:{companyName:{field:"companyName",displayName:"Company Name",width:"100"},addr:{field:"addr",displayName:"Address",width:"100"},state:{field:"state",displayName:"State",width:"100"},country:{field:"country",displayName:"Country",width:"100"}}}}},div3:{type:"div",fieldClass:"modal-footer",fields:{SaveButton:{type:"button",label:"Save",fieldClass:"btn btn-primary",ngClick:"ok()"},CancelButton:{type:"button",label:"Cancel",fieldClass:"btn btn-warning",ngClick:"cancel()"},NewButton:{type:"button",label:"New Sub Company",fieldClass:"btn btn-warning",ngClick:"newOrEditRow()"}}}};this.masterDetailDefs={master:{name:"list",controller:"CompaniesMainCtrl",layout:t},detail:{name:"detail",controller:"NewCompanyCtrl",layout:o}}},controllerAs:"companyForm",template:'<main-master-detail-directive setup="{{companyForm.masterDetailDefs}}" ></main-master-detail-directive>'})}]),angular.module("ocsApp.MakeBooking",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.makeBooking",{"abstract":!1,url:"/makeBooking",templateUrl:"modules/MakeBooking/views/makeBooking.main.html",controller:"MakeBookingMainCtrl",controllerAs:"MakeBookingMainCtrl"})}]),angular.module("ocsApp.MakePEMPhoneBooking",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.makePEMPhoneBooking",{"abstract":!1,url:"/makePEMPhoneBooking",templateUrl:"modules/MakePEMPhoneBooking/views/makePEMPhoneBooking.main.html",controller:"MakePEMPhoneBookingMainCtrl",controllerAs:"MakePEMPhoneBookingMainCtrl"}).state("authentication.bookingForm",{url:"/bookingForm/:token",views:{"main-content":{templateUrl:"modules/MakePEMPhoneBooking/views/makePEMPhoneBooking.bookingForm.html",controller:"BookingFormCtrl",controllerAs:"BookingFormCtrl"}}})}]),angular.module("ocsApp.MakeTelehealthBooking",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.makeTelehealthBooking",{"abstract":!1,url:"/makeTelehealthBooking",templateUrl:"modules/MakeTelehealthBooking/views/makeTelehealthBooking.main.html",controller:"MakeTelehealthBookingMainCtrl",controllerAs:"MakeTelehealthBookingMainCtrl"})}]),angular.module("ocsApp.Navigator",["toastr","ocsApp.MakeBooking","ocsApp.MakePEMPhoneBooking","ocsApp.MakeTelehealthBooking","ocsApp.TelehealthBookings","ocsApp.Bookings","ocsApp.Positions","ocsApp.Packages","ocsApp.Settings","ocsApp.BookingReports","ocsApp.Companies","ocsApp.Sites","ocsApp.Scheduler","ngIdle","ui.bootstrap"]).config(["$stateProvider",function(e){e.state("navigator",{"abstract":!1,url:"/navigator",views:{root:{templateUrl:"modules/Navigator/views/navigator.main.html",controller:"NavigatorMainCtrl",controllerAs:"NavigatorMainCtrl"}}})}]).config(["IdleProvider","KeepaliveProvider",function(e,t){e.idle(900),e.timeout(10),t.interval(10)}]).run(["Idle",function(e){e.watch()}]),angular.module("ocsApp.Packages",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.packages",{"abstract":!1,url:"/packages",templateUrl:"modules/Packages/views/packages.main.html",controller:"PackagesMainCtrl",controllerAs:"PackagesMainCtrl"})}]),angular.module("ocsApp.Positions",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.positions",{"abstract":!1,url:"/positions",templateUrl:"modules/Positions/views/positions.main.html",controller:"PositionsMainCtrl",controllerAs:"PositionsMainCtrl"})}]),angular.module("ocsApp.Scheduler",["toastr","ui.calendar"]).config(["$stateProvider",function(e){e.state("navigator.scheduler",{"abstract":!1,url:"/scheduler",templateUrl:"modules/Scheduler/views/scheduler.main.html",controller:"SchedulerMainCtrl",controllerAs:"SchedulerMainCtrl"})}]),angular.module("ocsApp.Settings",["lbServices","toastr"]).config(["$stateProvider",function(e){e.state("navigator.settings",{"abstract":!1,url:"/settings",templateUrl:"modules/Settings/views/settings.main.html",controller:"SettingsMainCtrl",controllerAs:"SettingsMainCtrl"})}]),angular.module("ocsApp.Sites",["lbServices","MasterDetailDirective","ct.ui.router.extras.sticky","ct.ui.router.extras.dsr","ct.ui.router.extras.statevis"]).config(["$stateProvider","$stickyStateProvider",function(e,t){e.state("navigator.sites",{"abstract":!1,url:"/sites",controller:function(e){e=e.getInstance("ocsApp.Sites"),e.debug("I am controller of Site");var t={div:{type:"div",fieldClass:"portlet box green portet-datatable",fields:{div:{type:"div",isSubmitedVar:"isSubmitted",controllerAs:"SitesMainCtrl",fieldClass:"portlet-title",fields:{div1:{type:"div",fieldClass:"caption bold",fields:{span:{type:"span",label:"Site List",fieldClass:"caption-subject bold uppercase"}}},div2:{type:"div",fieldClass:"tools",fields:{newButton:{type:"button",label:"New Site",fieldClass:"btn btn-primary",ngClick:"detail()"}}}}},div2:{type:"div",fieldClass:"portlet-body",fields:{table:{type:"table",isSort:!0,isSearch:!0,dataSource:"rows",fieldClass:"table table-striped table-bordered table-hover order-column",ngClick:"detail(row)",fields:{companyName:{field:"siteName",displayName:"Site Name",width:"100"},addr:{field:"siteAddr",displayName:"Address",width:"100"},state:{field:"state",displayName:"State",width:"100"},country:{field:"country",displayName:"Country",width:"100"},deleteRow:{type:"button",label:"Delete",displayName:"Action",fieldClass:"btn btn-warning",ngClick:"deleteRow(row)"}}}}}}}},o={div1:{type:"div",fieldClass:"modal-header",controllerAs:"NewSiteCtrl",isSubmitedVar:"isSubmitted",fields:{h3:{type:"h3",label:"{{NewCompanyCtrl.windowTitle}}",fieldClass:"modal-title"}}},div2:{type:"div",fieldClass:"modal-body",fields:{form:{type:"form",name:"form",fieldClass:"form-horizontal form-row-seperated",fields:{companyName:{field:"siteName",ngModel:"row.siteName",label:"Site Name",placeholder:"Site name",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Site name is required"},addr:{field:"siteAddr",ngModel:"row.siteAddr",label:"Address",placeholder:"Address",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},state:{field:"state",ngModel:"row.state",label:"State",placeholder:"State",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{ACT:{label:"Australian Capital Territory"},NSW:{label:"New South Wales"},VIC:{label:"Victoria"},QLD:{label:"Queensland"},SA:{label:"South Australia"},WA:{label:"Western Australia"},NT:{label:"Northern Territory"}}},country:{field:"country",ngModel:"row.country",label:"Country",placeholder:"Country",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{Australia:{label:"Australia"}}}}},div3:{type:"div",fieldClass:"portlet box green",fields:{div1:{type:"div",fieldClass:"portlet-title",fields:{div:{type:"div",label:"Search",fieldClass:"caption"}}},div2:{type:"div",fieldClass:"portlet-body",fields:{form:{type:"form",fieldClass:"form-horizontal",fields:{div:{type:"div",fieldClass:"form-group",fields:{fromDate:{type:"date",ngModel:"fromDate",label:"Date",fieldClass:"form-control",labelClass:"col-md-1",fieldGroupClass:"col-md-3"},toDate:{type:"date",ngModel:"toDate",label:"",fieldClass:"form-control",labelClass:"col-md-1",fieldGroupClass:"col-md-3"},search:{type:"button",label:"Search",ngClick:"filterDetail(NewSiteCtrl.fromDate,NewSiteCtrl.toDate)",fieldClass:"col-md-2 btn btn-primary"}}}}}}}}},table:{type:"table",dataSource:"row.AdminCalendars",isSort:!0,isSearch:!0,fieldClass:"table table-striped table-bordered table-hover order-column",ngClick:"newOrEditRow(row)",fields:{fromTime:{field:"fromTime",displayName:"From time",width:"100",filter:"|dateFilter| date:'dd/MM/yyyy HH:mm'"},available:{field:"available",displayName:"Available",width:"100"}}}}},div3:{type:"div",fieldClass:"modal-footer",fields:{SaveButton:{type:"button",label:"Save",fieldClass:"btn btn-primary",ngClick:"ok()"},CancelButton:{type:"button",label:"Cancel",fieldClass:"btn btn-warning",ngClick:"cancel()"}}}};this.masterDetailDefs={master:{name:"list",controller:"SitesMainCtrl",layout:t},detail:{name:"detail",controller:"NewSiteCtrl",layout:o}}},controllerAs:"companyForm",template:'<main-master-detail-directive setup="{{companyForm.masterDetailDefs}}" ></main-master-detail-directive>'})}]),angular.module("ocsApp.TelehealthBookings",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.telehealthBookings",{"abstract":!1,url:"/telehealthBookings",templateUrl:"modules/TelehealthBookings/views/telehealthBookings.main.html",controller:"TelehealthBookingsMainCtrl",controllerAs:"TelehealthBookingsMainCtrl"})}]),angular.module("ocsApp.Authentication").controller("ForgotPasswordCtrl",["$state","Accounts","toastr","$log",function(e,t,o,a){a=a.getInstance("ocsApp.Authentication.ForgotPasswordCtrl"),a.debug("Hello, I am ForgotPasswordCtrl");var n=this;this.loading1=!1,this.loading2=!1,this.showClickedValidation=!1,this.goBackLogin=function(){a.debug("go back login..."),e.go("authentication.login")},this.forgotPassword=function(){a.debug("forgot password function"),n.showClickedValidation=!0,this.form.username.$error.required&&o.error("Please enter username","Error"),this.form.email.$error.required&&o.error("Please enter email","Error"),n.form.$valid?(a.debug("login",this.username),t.resetPassword({username:this.username,email:this.email},function(e){n.showClickedValidation=!1,a.debug("Send an email to reset pass successfully !",e),a.save(),o.success("Sent an email to reset the password in your email, Please check the email"),n.username="",n.email=""},function(e){a.error("Send an email to reset pass  failed !",e),o.error("Wrong username or password. Please check your username or password","Error")})):a.error("ForgotPasswordCtrl invalid",n.form.$error)}}]),angular.module("ocsApp.Authentication").controller("LoginCtrl",["$state","Accounts","toastr","$cookieStore","CompanyFactory","RedimedSiteFactory","$log","mySharedService","storeToken","mySocket",function(e,t,o,a,n,i,s,r,l,d){s=s.getInstance("ocsApp.Authentication.LoginCtrl");var c=this;this.loading1=!1,this.loading2=!1,this.showClickedValidation=!1,this.login=function(){this.showClickedValidation=!0,this.loginForm.username.$error.required&&o.error("Please enter username","Error"),this.loginForm.password.$error.required&&o.error("Please enter password","Error"),c.loginForm.$valid?(s.debug("login",this.username),d.emit("msg",{message:"will login into the system with account = "+this.username+" and password = "+this.password}),t.login({username:this.username,password:this.password},function(t,o){n.setCurrentCompany(t.user.Company),n.setCurrentUser(t.user),c.loading1=!0,c.loading2=!0,a.put("firstCompany",t.user.Company),a.put("companies",t.user.AccountCompanies),s.setUser(t.user),s.setAccessToken(t.id),s.debug("Login successfully !",t.user),l.setAccessToken(t.id),n.init(function(o){c.loading1=!1,d.emit("login",{message:"Login successfully",userName:t.user.username,userId:t.user.id,companyId:t.user.companyId,companyName:o.companyName}),i.getSite(function(t){c.loading2=!1,c.loading1||c.loading2||(r.prepForBroadcast("Login successfully"),e.go("navigator"))})})},function(e){s.error("Login failed !",e),e.statusText.indexOf("Unauthorized")>=0?o.error("Wrong username or password. Please check your username or password","Error"):o.error("Cannot connect to the server. Please refesh your browser !","Error")})):s.error("form is invalid",c.loginForm.$error)}}]),angular.module("ocsApp.Authentication").controller("AuthenMainCtrl",function(){this.isRedimed=!1,this.isKaja=!1;var e=getLogo();console.log(e),"REDIMED"==e&&(this.isRedimed=!0),"KAJA"==e&&(this.isKaja=!0)}),angular.module("ocsApp.Authentication").controller("ResetPasswordCtrl",["$state","Accounts","toastr","$log","$stateParams",function(e,t,o,a,n){a=a.getInstance("ocsApp.Authentication.ResetPasswordCtrl"),a.debug("Hello, I am ResetPasswordCtrl",n.token);var i=this;this.loading1=!1,this.loading2=!1,this.token=n.token,this.showClickedValidation=!1,this.reset=function(){a.debug("forgot password function"),i.showClickedValidation=!0,i.form.password.$error.required&&o.error("Please enter password","Error"),i.form.repassword.$error.required&&o.error("Please enter re-password","Error"),i.form.$valid?i.password==i.repassword?$.post("https://medicalbookings.redimed.com.au:8181/api/Accounts/updatePassword?access_token="+i.token,{password:i.password}).then(function(t){a.debug("succ",t),a.save(),e.go("authentication.login")}).fail(function(e){a.error("error",e),e.statusText.indexOf("Unauthorized")>=0?o.error("Sorry, Time out, please reset password again!","Error"):o.error("Sorry, Can not process to reset password, Please contact Redimed !","Error")}):o.error("Password and Re-password are not match together, Please re-enter again !","Error"):a.error("ForgotPasswordCtrl invalid",i.form.$error)}}]),angular.module("ocsApp.Authentication").factory("CompanyFactory",["Companies","$log","CalendarHoldings",function(e,t,o){function a(o){e.initData(function(e,t){console.log(">initData",e),n=e.initData,o(n)},function(e){t.error("init company failed",e)})}var n,i=null,s=null;return t=t.getInstance("ocsApp.Authentication.CompanyFactory"),{init:function(e){a(e)},getPeriod:function(o,a){t.debug(">WILL GET PERIOD FROM SERVER PACKID = ",o),e.getPeriod({packId:o},function(e,t){a(e.period)},function(e){t.error("get period company failed",e)})},setCurrentCompany:function(e){i=e},getCurrentCompany:function(){return i},setCurrentUser:function(e){s=e},getCurrentUser:function(){return s},refreshSubsidiaryList:function(o){e.getRediSubsidiaries(function(e){t.debug("refreshSubsidiaryList from server"),n.subsidiaries=e.subsidiaries,o(n)},function(e){t.error("init company failed",e)})},refreshBookingList:function(o){e.listBookings(function(e){t.debug("refreshBookingList from server"),n.allBookings=e.bookings,o(n)},function(e){t.error("refreshBookingList failed",e)})},refreshTelehealthBookingList:function(o){e.listTelehealthBookings(function(e){t.debug("refreshBookingList from server"),n.telehealthBookings=e.bookings,o(n)},function(e){t.error("refreshBookingList failed",e)})},refreshPositionList:function(e){a(e)},refreshPackageList:function(e){a(e)},refreshAllPackageList:function(o){e.getPackages(function(e){t.debug("refreshAllPackageList from server"),n.allViewPackages=e.packages,o(n)},function(e){t.error("refreshPackageList failed",e)})},refreshAccountList:function(o){e.accounts({id:0},function(e){t.debug("refreshAccountList from server"),n.accounts=e,o(n)},function(e){t.error("refreshAccountList failed",e)})},getCompanyId:function(){return null==n?null:n.id},getCompany:function(e){n?(t.debug("getCompany from memory"),e(n)):a(e)}}}]).factory("RedimedSiteFactory",["Companies","$log","CalendarHoldings",function(e,t,o){var a;return t=t.getInstance("RedimedSiteFactory"),{getSite:function(o){a?(t.debug("getSite from memory"),o(a)):e.getSites(function(e){t.debug("getSite from server"),a=e.sites,o(a)},function(e){t.error("getSite from server failed",e)})},getCalendar:function(o,a,n,i,s){e.getCalendars({id:o,from:a,to:n,maxPeriod:i},function(e){t.debug("getCalendar from server"),console.log("data = ",e),s(e.calendars)},function(e){t.error("getCalendar from server failed",e)})},getRoster:function(o,a,n,i){e.getRosters({id:o,from:a,to:n},function(e){t.debug("getRoster from server"),console.log("data = ",e),i(e.rosters)},function(e){t.error("getCalendar from server failed",e)})},getResources:function(o,a,n,i){e.getResources({id:o,from:a,to:n},function(e){t.debug("getResources from server"),console.log("data = ",e),i(e)},function(e){t.error("getResources from server failed",e)})},getEvents:function(o,a,n,i){e.getEvents({id:o,from:a,to:n},function(e){t.debug("getEvents from server"),console.log("data = ",e),i(e)},function(e){t.error("getEvents from server failed",e)})},removeSlots:function(o,a,n,i){e.removeSlots({resourceId:o,fromTime:a,toTime:n},function(e){t.debug("removeSlots from server"),console.log(" slots removed = ",e),i()},function(e){console.log(" slots removed err = ",e)})},unRemoveSlots:function(o,a,n,i){e.unRemoveSlots({resourceId:o,fromTime:a,toTime:n},function(e){t.debug("unRemoveSlots from server"),console.log(" slots unRemoveSlots = ",e),i()},function(e){console.log(" slots unRemoveSlots err = ",e)})},setHolding:function(e,a){t.debug("Will set holding calID = "+e),o.create({holdingId:0,calendarId:e},function(e){t.debug("Hold the calendar =",e),a(e)},function(e){t.error("Holding from server failed",e)})},removeHolding:function(e,a,n){t.debug("Will remove holding calID = "+a),o.deleteById({id:e},function(e){t.debug("Remove the calendar =",e),n(e)},function(e){t.error("Holding from server failed",e)})}}}]).factory("BookingStatusFactory",["Companies","$log",function(e,t){var o;return t=t.getInstance("BookingStatusFactory"),{getStatus:function(a){o?(t.debug("getStatus from memory"),a(o)):e.getStatus(function(e){t.debug("getStatus from server"),o=e.status,a(o)},function(e){t.error("getStatus from server failed",e)})}}}]),angular.module("ocsApp.Positions").controller("ConfirmToDeletePositionCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.BookingReports").controller("BookingReportsMainCtrl",["Companies","BookingCandidateByApptDateV","BookingCandidateByBookingDateV","mysqlDate","mySocket","$scope",function(e,t,o,a,n,i){function s(e,t){var o=moment(a(e)).format(t);return"Invalid date"==o?"":o}function r(){l.apptSumary=[],l.totalApptToday=0,l.bookingTodaySumary=[],l.totalBookingToday=0,t.find({filter:{where:{apptDate:{between:[l.fromDate,l.toDate]}},order:"apptDate"}},function(e){var t=[],o=[],a="",n=-1,i=[],r=[],d=[],c=["#1c8d62","#2c9ff2","#3cadd2","#4dba62","#5cc162","#61d5b2","#74e4b2","#81fd67","#f91264"],u=[];for(var m in e){var p=_.indexOf(o,e[m].siteName);p==-1&&void 0!=e[m].siteName&&(o.push(e[m].siteName),r.push([]))}o=o.sort();for(var m in e)if(a!=e[m].apptDate+""){var g={};for(var f in o)g[o[f]]=0;n++,a=e[m].apptDate+"",g.apptDate=(e[m].apptDate+"").substr(0,10),g[e[m].siteName]=e[m].quantity,t.push(g)}else t[n][e[m].siteName]=e[m].quantity;r.push([]);for(var m in t)if(dateFortmat=s(t[m].apptDate,"DD MMM"),i.push(dateFortmat),dateFortmat+""==l.todayDate+""){var h=0;for(var f in o){var y=t[m][o[f]];r[f].push(y),h+=y,l.apptSumary.push({site:o[f],quantity:y})}r[o.length].push(h),l.totalApptToday=h}else{var h=0;for(var f in o)r[f].push(t[m][o[f]]),h+=t[m][o[f]];r[o.length].push(h)}o.push("Total");for(var f in o){var b={values:r[f],"line-color":c[f],aspect:"spline","background-color":"#fc8d62","alpha-area":".3","font-family":"Roboto","font-size":"14px",text:o[f]};d.push(b);var k={text:o[f]+": %plot-"+f+"-value","default-value":"",color:c[f],x:5+15*f+"%",y:50,width:120,"text-align":"left",bold:0,"font-size":"12px","font-weight":"bold"};u.push(k)}l.myJson={globals:{"font-family":"Roboto"},graphset:[{type:"area","background-color":"#fff",utc:!0,title:{y:"15px",text:"Patient Attending Today","background-color":"none","font-color":"#05636c","font-size":"24px",height:"25px","adjust-layout":!0},plotarea:{"margin-top":"10%","margin-right":"dynamic","margin-bottom":"dynamic","margin-left":"dynamic","adjust-layout":!0},labels:u,"scale-x":{label:{text:"Date Range","font-size":"14px","font-weight":"normal","offset-x":"10%","font-angle":360},item:{"text-align":"center","font-color":"#05636c"},zooming:1,labels:i,"items-overlap":!0,guide:{"line-width":"0px"},tick:{"line-width":"2px"}},"crosshair-x":{"line-color":"#fff","line-width":1,"plot-label":{visible:!1}},"scale-y":{item:{"font-color":"#05636c","font-weight":"normal"},label:{text:"Metrics","font-size":"14px"},guide:{"line-width":"0px",alpha:.2,"line-style":"dashed"}},plot:{"line-width":2,marker:{size:1,visible:!1},tooltip:{"font-family":"Roboto","font-size":"14px",text:"There were %v %t on %data-days","text-align":"left"}},series:d}]}}),o.find({filter:{where:{bookingDate:{between:[new Date(l.fromDate),new Date(l.toDate)]}},order:"bookingDate"}},function(e){var t=[],o=[],a="",n=-1,i=[],r=[],d=[],c=["#1c8d62","#2c9ff2","#3cadd2","#4dba62","#5cc162","#61d5b2","#74e4b2","#81fd67","#f91264"],u=[];for(var m in e){var p=_.indexOf(o,e[m].siteName);p==-1&&void 0!=e[m].siteName&&(o.push(e[m].siteName),r.push([]))}o=o.sort();for(var m in e)if(a!=e[m].bookingDate+""){var g={};for(var f in o)g[o[f]]=0;n++,a=e[m].bookingDate+"",g.bookingDate=(e[m].bookingDate+"").substr(0,10),g[e[m].siteName]=e[m].quantity,t.push(g)}else t[n][e[m].siteName]=e[m].quantity;r.push([]);for(var m in t)if(dateFortmat=s(t[m].bookingDate,"DD MMM"),i.push(dateFortmat),dateFortmat+""==l.todayDate+""){var h=0;for(var f in o){var y=t[m][o[f]];r[f].push(y),h+=y,l.bookingTodaySumary.push({site:o[f],quantity:y})}r[o.length].push(h),l.totalBookingToday=h}else{var h=0;for(var f in o)r[f].push(t[m][o[f]]),h+=t[m][o[f]];r[o.length].push(h)}o.push("Total");for(var f in o){var b={values:r[f],"line-color":c[f],aspect:"spline","background-color":"#fc8d62","alpha-area":".3","font-family":"Roboto","font-size":"14px",text:o[f]};d.push(b);var k={text:o[f]+": %plot-"+f+"-value","default-value":"",color:c[f],x:5+15*f+"%",y:50,width:120,"text-align":"left",bold:0,"font-size":"12px","font-weight":"bold"};u.push(k)}l.myJson2={globals:{"font-family":"Roboto"},graphset:[{type:"area","background-color":"#fff",utc:!0,title:{y:"15px",text:"New Booking Today","background-color":"none","font-color":"#05636c","font-size":"24px",height:"25px","adjust-layout":!0},plotarea:{"margin-top":"10%","margin-right":"dynamic","margin-bottom":"dynamic","margin-left":"dynamic","adjust-layout":!0},labels:u,"scale-x":{label:{text:"Date Range","font-size":"14px","font-weight":"normal","offset-x":"10%","font-angle":360},item:{"text-align":"center","font-color":"#05636c"},zooming:1,labels:i,"items-overlap":!0,guide:{"line-width":"0px"},tick:{"line-width":"2px"}},"crosshair-x":{"line-color":"#fff","line-width":1,"plot-label":{visible:!1}},"scale-y":{item:{"font-color":"#05636c","font-weight":"normal"},label:{text:"Metrics","font-size":"14px"},guide:{"line-width":"0px",alpha:.2,"line-style":"dashed"}},plot:{"line-width":2,marker:{size:1,visible:!1},tooltip:{"font-family":"Roboto","font-size":"14px",text:"There were %v %t on %data-days","text-align":"left"}},series:d}]}})}console.log("I am booking report controller.");var l=this;this.positions=[],this.myJson={},this.myJson2={},this.dateStatus={},this.dateStatus.fromDateOpened=!1,this.dateStatus.toDateOpened=!1,this.format="dd/MM/yyyy",this.apptSumary=[],this.totalApptToday=0,this.bookingTodaySumary=[],this.totalBookingToday=0,this.todayDate=moment(new Date).format("DD MMM"),this.fromDate=new Date,this.toDate=new Date,this.fromDate.setDate(this.fromDate.getDate()-7),this.toDate.setDate(this.toDate.getDate()+7);var d=[{field:"onlineAt",displayName:"loginAt",width:"150",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm:ss'"},{field:"loginAt",displayName:"loginAt",width:"150",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm:ss'"},{field:"logoutAt",displayName:"logoutAt",width:"150",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm:ss'"},{field:"offlineAt",displayName:"offlineAt",width:"150",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm:ss'"},{field:"userName",displayName:"userName",width:"100"},{field:"socketId",displayName:"socketId",width:"100"},{field:"ip",displayName:"ip",width:"170"},{field:"companyName",displayName:"companyName",width:"100"},{field:"pid",displayName:"pid",width:"100"},{field:"worker",displayName:"worker",width:"100"}];this.gridOptions={enableSorting:!0,enableColumnResizing:!0,enableFiltering:!0,appScopeProvider:this,columnDefs:d,enableGridMenu:!0,enableRowSelection:!1,enableSelectAll:!1,exporterMenuPdf:!1,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location"))},n.on("OnlineUsersData",function(e){console.log("Receive OnlineUsers = "),l.gridOptions.data=e}),n.emit("GetOnlineUsers"),i.$on("$destroy",function(){$log.debug("remove socket.io listener....................."),n.removeListener("OnlineUsersData")}),r(),this.openFromDate=function(e){console.log("emitting data"),l.dateStatus.fromDateOpened=!0},this.openToDate=function(e){
l.dateStatus.toDateOpened=!0},this.fromOrToDateChanged=function(){r()},this.synSites=function(){e.synSites()},this.synRosters=function(){e.synCalendars()}}]),angular.module("ocsApp.Positions").controller("NewPositionCtrl",["Positions","$uibModalInstance","position","CompanyFactory","$log","toastr",function(e,t,o,a,n,i){n=n.getInstance("ocsApp.Positions.NewPositionCtrl"),n.debug("I am  new or edit position controller.",o);var s=this;this.form={},this.companyId=a.getCompanyId(),o&&(this.positionName=o.positionName),this.ok=function(){if(s.isSubmitted=!0,s.form.$valid)if(o)n.debug("will update position",o),e.update({where:{id:o.id}},{positionName:s.positionName},function(e){n.debug("updated position",e),i.success("Position was updated successfully",""),t.close({})},function(e){n.error("Fail to update position",e),i.error("Fail to update Position","Error"),t.close({})});else{var a={};a.positionName=s.positionName,a.companyId=s.companyId,a.id=0,console.log(a),e.create(a,function(e){n.debug("created position",e),i.success("Position was created successfully",""),t.close({})},function(e){i.error("Fail to create Position","Error"),n.error("failt to create position",e)})}else n.error("Save postion err ",s.form.$error)},this.cancel=function(){t.dismiss("cancel")}}]),angular.module("ocsApp.Bookings").controller("AdminEditBookingCtrl",["candidate","BookingFactory","RedimedSiteFactory","BookingStatusFactory","BookingHeaders","BookingCandidates","toastr","$uibModalInstance","mysqlDate","$log","CompanyFactory","mySharedService","mysqlDate","$cookieStore","$uibModal","$scope","mySocket",function(e,t,o,a,n,i,s,r,l,d,c,u,l,m,p,g,f){function h(){d.debug("will getCalendar....",y.user),t.getCalendar(y.site.id,y.period).then(function(e){d.debug("finished getCalendar....",y.user),y.calendars=e,y.calendars.length>0?(y.isCalendarList=!0,y.isAppointmentTime=!1):(y.isCalendarList=!1,y.isAppointmentTime=!0),y.user.userType.indexOf("RediMed")==-1&&(y.isAppointmentTime=!1)})}d=d.getInstance("ocsApp.Bookings.AdminEditBookingCtrl");var y=this,b=e.appointmentStatus;this.candidate=e,this.user=c.getCurrentUser(),this.sites=[],this.states=[],this.suburbs=[],this.site={},this.state={},this.suburb={},this.calendars=[],this.slot=null,this.statuses=[],this.isSubmitted=!1,this.form={},this.dateStatus={},this.dateStatus.fromDateOpened=!1,this.dateStatus.toDateOpened=!1,this.dateStatus.timeOpened=!1,this.isCalendarList=!1,this.isAppointmentTime=!1,this.apptTimeAfterConvert=null,this.format="dd/MM/yyyy HH:mm",this.period=15,this.isSelectedSlot=!1,this.apptDateAfterConvert=l(this.candidate.appointmentTime),this.candidate.appointmentTime&&(this.apptTimeAfterConvert=l(this.candidate.appointmentTime)),this.isAppointmentTimeChange=!1,""==this.apptTimeAfterConvert&&(this.apptTimeAfterConvert="00:00"),a.getStatus(function(e){y.statuses=e,d.debug(" status = ",y.statuses)}),o.getSite(function(t){d.debug("get sites..."),y.sites=t,y.site=y.sites[_.findIndex(y.sites,"id",y.candidate.siteId)],y.site.States.length>0&&(y.states=y.site.States,y.state=y.states[_.findIndex(y.states,"stateName",y.candidate.stateName)],y.state.SubStates.length>0&&(y.suburbs=y.state.SubStates,y.suburb=y.suburbs[_.findIndex(y.suburbs,"suburbName",y.candidate.suburbName)])),y.site&&c.getPeriod(e.packageId,function(e){y.period=e,d.debug("that.period = ",y.period),h()})}),this.appointmentTimeChanged=function(){y.isAppointmentTimeChange=!0,console.log(this.apptTimeAfterConvert)},this.openTime=function(){y.dateStatus.timeOpened=!0},this.openFromDate=function(e){y.dateStatus.fromDateOpened=!0},this.isChangeBookingTime=function(){return y.calendars.length>0},this.selectedSite=function(){d.debug("Get calendar from the factory"),y.calendars=[],y.states=y.site.States,y.suburb=null,y.state=null,y.suburbs=null,y.slot=null,y.candidate.appointmentTime=null,y.isSelectedSlot=!0,h()},this.selectedState=function(){y.state&&(y.suburb=null,y.suburbs=y.state.SubStates)},this.isStates=function(){return null!=y.states&&!(y.states.length<=0)},this.isSuburbs=function(){return null!=y.suburbs&&!(y.suburbs.length<=0)},this.isSendEmailDisabled=function(){return("Confirmed"==this.candidate.appointmentStatus||"Pending"==this.candidate.appointmentStatus)&&!y.isNotSave()},this.isNotSave=function(){return!(!y.form.$pristine||y.isSelectedSlot)},this.isAttended=function(){return"Reschedule"==y.candidate.appointmentStatus||"Confirmed"==y.candidate.appointmentStatus},this.isShowAttendedButton=function(){return y.user.userType.indexOf("RediMed")!=-1},this.isEform=function(){return y.user.userType.indexOf("RediMed")!=-1},this.eform=function(){n.transferEform({bookingId:y.candidate.bookingId})},this.attended=function(){t.attended(y.candidate).then(function(){d.debug("updated successfully"),s.success("Successfully updated. The booking list will refresh shortly !"),y.form.$setPristine(),c.refreshBookingList(function(e){s.success("The booking list has been refresh"),u.prepForBroadcast("Refresh booking list successfully")})})},this.sendConfirmationEmail=function(){t.sendConfirmationEmail(y.candidate)},this.save=function(o){y.isSubmitted=!0;var a=!1;if(!y.candidate.appointmentTime&&y.calendars.length>0&&(void 0==y.slot||null==y.slot)&&o)s.error("Please select the calendar","Error");else if(y.form.$valid){var i={};b.indexOf("Pending")>=0&&(y.slot||y.apptTimeAfterConvert)&&(i.appointmentStatus="Confirmed",y.candidate.appointmentStatus="Confirmed",a=!0),y.slot?(b.indexOf("Confirmed")>=0||b.indexOf("Reschedule")>=0)&&y.slot.calId!=e.calendarId&&(i.appointmentStatus="Reschedule",y.candidate.appointmentStatus="Reschedule",a=!0):(b.indexOf("Confirmed")>=0||b.indexOf("Reschedule")>=0)&&y.apptTimeAfterConvert&&y.isAppointmentTimeChange&&(i.appointmentStatus="Reschedule",y.candidate.appointmentStatus="Reschedule",a=!0),i.candidateId=y.candidate.candidateId,i.appointmentNotes=y.candidate.appointmentNotes,i.siteId=y.site.id,i.siteName=y.site.siteName,(i.siteName.indexOf("Eastern States")>=0||i.siteName.indexOf("WA")>=0||!o)&&(a=!1),y.state?(i.stateName=y.state.stateName,i.stateId=y.state.id):(i.stateName=null,i.stateId=null),y.suburb?(i.suburbName=y.suburb.suburbName,i.suburbId=y.suburb.id):(i.suburbName=null,i.suburbId=null),console.log("that.slot = ",y.slot),y.slot?(i.appointmentTime=moment(l(y.slot.fromTime)).format("YYYY-MM-DD HH:mm "),i.calendarId=y.slot.calId,i.practitionerId=y.slot.doctorId,i.redimedNote=y.slot.doctorName,i.slots=[],y.slot.followingSlots&&y.slot.followingSlots.forEach(function(e,t){i.slots.push(e.calId);var o=t+2;o<=5&&(i["calendarId"+o]=e.calId)})):y.apptTimeAfterConvert&&(i.appointmentTime=moment(y.apptDateAfterConvert).format("YYYY-MM-DD")+" "+moment(y.apptTimeAfterConvert).format("hh:mm")),d.debug("will update",i),n.updateBooking(i,function(e,o){d.debug("updated successfully"),s.success("Successfully updated. The booking list will refresh shortly !"),y.form.$setPristine(),a&&t.sendConfirmationEmail(y.candidate),c.refreshBookingList(function(e){s.success("The booking list has been refresh"),u.prepForBroadcast("Refresh booking list successfully")})},function(e){d.error("updated failed",e),"SLOT_NOT_AVAILABLE"==e.data.error.code?s.error(e.data.error.message,"Error"):s.error("Fail to update the booking ["+e.data.error.message+"]","Error")})}},this.cancel=function(){r.dismiss("cancel")},this.SelectApptSlot=function(){var e=p.open({templateUrl:"modules/Bookings/views/booking.SelectApptSlotCtrl.html",animation:!1,windowTopClass:"modal2",size:"lg",controller:"SelectApptSlotCtrl",controllerAs:"SelectApptSlotCtrl",resolve:{calendars:function(){return y.calendars},siteId:function(){return y.site.id},period:function(){return y.period}}});e.result.then(function(e){d.debug("select slot = ",e),e&&(y.slot=e,y.candidate.appointmentTime=y.slot.fromTime,y.isSelectedSlot=!0)},function(){d.info("Modal dismissed at: "+new Date)})},this.canCancelAppt=function(){return y.candidate.appointmentStatus.indexOf("Confirmed")>=0||y.candidate.appointmentStatus.indexOf("Reschedule")>=0},this.cancelAppt=function(){r.dismiss("cancel");var e=p.open({templateUrl:"modules/Bookings/views/booking.ConfirmToCancelAppt.html",controller:"ConfirmToCancelApptCtrl",controllerAs:"ConfirmToCancelApptCtrl"});e.result.then(function(e){t.cancelAppointment(y.candidate).then(function(e){u.prepForBroadcast("Refresh booking list successfully")})},function(){d.info("Modal dismissed at: "+new Date)})},this.isAdmin=function(){return y.user.userType.indexOf("RediMed")>=0}}]),angular.module("ocsApp.Bookings").controller("ConfirmToCancelApptCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.Bookings").controller("BookingsMainCtrl",["uiGridConstants","$scope","$window","CompanyFactory","BookingFactory","$uibModal","$cookieStore","$log","mysqlDate","mySharedService","Packages","$q",function(e,t,o,a,n,i,s,r,l,d,c,u){function m(e,t){var o=moment(l(e)).format(t);return"Invalid date"==o?"":o}function p(e,t,o,a){e=e.replace(/\\/g,"");var n=moment(t);if(e){var i=moment(e,"DD/MM/YYYY"),s=i.isAfter(n,"day");if(s)return!1}return!0}function g(e,t,o,a){e=e.replace(/\\/g,"");var n=moment(t);if(e){var i=moment(e,"DD/MM/YYYY"),s=i.isBefore(n,"day");if(s)return!1}return!0}r=r.getInstance("ocsApp.Bookings.BookingsMainCtrl");var f=this;this.window=o;var h=[];this.loading=!1,this.user=a.getCurrentUser();var y={content:[],styles:{header:{bold:!0,color:"#000",fontSize:11},demoTable:{color:"#666",fontSize:10}}};this.openPdf=function(e,t){var o=n.getPackage(h,e.packageId);o.then(function(t){a(e,t)},function(t){a(e,""),r.error("Failed: "+t)});var a=function(e,o){var a="",n=[];r.debug(" printBookingForm has package ");for(var i in o.AssessmentHeaders){var s=o.AssessmentHeaders[i];a=a+"<b>"+s.headerName+"</b><br>",n.push({text:s.headerName,bold:!0});var l=[];for(var d in s.Assessments){var c=s.Assessments[d];a=a+" - "+c.assName+"<br>",l.push(" - "+c.assName)}n.push(l)}r.debug(" pdf printBookingForm has package view  ");var u=e.siteName;e.stateName&&(u=u+" - "+e.stateName),e.suburbName&&(u=u+" - "+e.suburbName),y={content:[{text:"Booking Form",style:"header",alignment:"center"},{style:"tableExample",color:"#444",table:{widths:[200,300],headerRows:5,body:[[{text:"Company Details",style:"tableHeader",colSpan:2,alignment:"center"},{}],["Company",e.fatherCompanyName],["Subsidiary",e.companyName],["PO Number",e.poNumber],["Project Identification",e.projectIdentofication],["Booking Person",e.bookingPerson],["Booking Person Contact Number",e.contactNumber],["Results to",e.resultEmail],["Invoices to",e.invoiceEmail],["Comments",e.comments],[{text:"Worker Details",style:"tableHeader",colSpan:2,alignment:"center"},{}],["Candidate Name",e.candidatesName],["Date Of Birth",m(e.dob,"DD/MM/YYYY")],["Phone",e.phone],["Email",e.email],["Position Applied For",e.position],[{text:"Paperwork",style:"tableHeader",colSpan:2,alignment:"center"},{}],[{colSpan:2,text:e.paperwork},""],[{text:"Assessment Details",style:"tableHeader",colSpan:2,alignment:"center"},{}],[{colSpan:2,stack:n},""],[{text:"Appointment Details",style:"tableHeader",colSpan:2,alignment:"center"},{}],["Appointment location",u],["Appointment time",m(e.appointmentTime,"DD/MM/YYYY HH:mm")],["Appointment Notes",e.appointmentNotes],["Appointment status",e.appointmentStatus]]}}],styles:{header:{fontSize:18,bold:!0,margin:[0,0,0,10]},subheader:{fontSize:16,bold:!0,margin:[0,10,0,5]},tableExample:{margin:[0,5,0,15],fontSize:9},tableHeader:{bold:!0,fontSize:11,color:"black"}}},t?pdfMake.createPdf(y).download():pdfMake.createPdf(y).open()}},this.downloadPdf=function(){pdfMake.createPdf(y).download()};var b=[{field:"viewCandidate",displayName:"Action",width:"300",enableFiltering:!1,enableCellEdit:!1,cellTemplate:'<button ng-click="grid.appScope.adminEditBooking(row.entity)" class="blue">View Details</button><button ng-click="grid.appScope.openPdf(row.entity,1)" class="blue">Download Form</button>'},{field:"fatherCompanyName",displayName:"Company Name",width:"150"},{field:"companyName",displayName:"Subsidiary",width:"150"},{field:"candidatesName",displayName:"Candidate Name",width:"200",enableCellEdit:!1,cellTemplate:'<a ng-click="grid.appScope.printBookingForm(row.entity)" class="blue">{{row.entity.candidatesName}}</a>'},{field:"appointmentTime",displayName:"Appointment Time",width:"250",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm'",filters:[{condition:p},{condition:g}],filterHeaderTemplate:'<div class="ui-grid-filter-container">from: <input style="display:inline; width:35%"  class="ui-grid-filter-input" date-picker type="text" ng-model="col.filters[0].term"/> - <input style="display:inline; width:35%" class="ui-grid-filter-input" date-picker type="text" ng-model="col.filters[1].term"/></div>'},{field:"siteName",displayName:"Site",width:"100"},{field:"stateName",displayName:"State",width:"100"},{field:"suburbName",displayName:"Suburb",width:"100"},{field:"bookingPerson",displayName:"Booking Person",width:"150"},{field:"comments",displayName:"Booking Comments",width:"200"},{field:"appointmentNotes",displayName:"Notes",width:"200"},{field:"appointmentStatus",displayName:"Status",width:"100"},{field:"projectIdentofication",displayName:"Project Indentification",width:"120"},{field:"poNumber",displayName:"PO Number",width:"120"},{field:"packageName",displayName:"Package Name",width:"200"},{field:"paperwork",displayName:"Paperwork",width:"100"},{field:"email",displayName:"Email",width:"150"},{field:"dob",displayName:"DOB",width:"100",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy'"},{field:"creationDate",displayName:"Creation Date",width:"200",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm'"},{field:"createdBy",displayName:"By",width:"50"},{field:"headerCandidateId",displayName:"Link ID",width:"50"},{field:"issendemail",displayName:"Send Email",width:"50"}];this.isAdmin=function(){return f.user.userType.indexOf("RediMed")>=0},this.adminEditBooking=function(e){var t=i.open({animation:!1,backdrop:"static",windowTopClass:"modal1",templateUrl:"modules/Bookings/views/bookings.adminEditBooking.html",controller:"AdminEditBookingCtrl",controllerAs:"AdminEditBookingCtrl",size:"lg",resolve:{candidate:function(){return e}}});t.result.then(function(e){},function(e){})},this.printBookingForm=function(e){n.viewBookingDetail(h,e)};var k='<div ng-class="{ red: row.entity.issendemail == null || row.entity.headerCandidateId == null }"><div ng-repeat="(colRenderIndex, col) in colContainer.renderedColumns track by col.colDef.name" class="ui-grid-cell" ng-class="{ \'ui-grid-row-header-cell\': col.isRowHeader }" ui-grid-cell></div></div>';this.gridOptions={enableSorting:!0,rowTemplate:k,enableColumnResizing:!0,enableFiltering:!0,appScopeProvider:this,columnDefs:b,onRegisterApi:function(e){t.gridApi=e,t.gridApi.core.on.sortChanged(t,function(e,t){})},enableGridMenu:!0,enableRowSelection:!1,enableSelectAll:!1,exporterMenuPdf:!1,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location"))},t.$on("handleBroadcast",function(){var e=d.message;r.debug("Received a message from AdminEditBookingCtrl = "+e),e.indexOf("Refresh booking list successfully")>=0&&a.getCompany(function(e){r.debug("Refresh bookings, get company info"),toastr.success("The booking list has been refreshed !"),f.gridOptions.data=e.allBookings})}),this.refreshBooking=function(){r.debug("will refresh booking ; get data from DB......"),f.loading=!0,a.refreshBookingList(function(e){r.debug("refreshed booking ; get data from DB......"),f.gridOptions.data=e.allBookings,f.loading=!1})},a.getCompany(function(e){r.debug("Make booking, get company info"),f.gridOptions.data=e.allBookings,f.loading=!1,h=e.packages})}]),angular.module("ocsApp.Bookings").controller("SelectApptSlotCtrl",["BookingFactory","$log","$uibModalInstance","$scope","mySocket","calendars","siteId","period","toastr",function(e,t,o,a,n,i,s,r,l){t=t.getInstance("ocsApp.Bookings.SelectApptSlotCtrl"),this.calendars=i,this.slot=null;var d=this;this.occupiedSlotByAnother=null,n.on("UpdateCalendar",function(e){t.debug("-->refresh calendars by server occupiedSlot = ",e),e&&(d.occupiedSlotByAnother=e,d.calendars.forEach(function(t){t.date==e.calendarDate&&t.slots.forEach(function(o,a){o.calId==e.calId&&t.slots.splice(a,1)})}))}),a.$on("$destroy",function(){t.debug("remove socket.io listener....................."),n.removeListener("UpdateCalendar")}),a.$watch("SelectApptSlotCtrl.slot",function(e,t){e!==t&&(console.log("$watch: that.BookingCandidate.slot changed.",e,t),n.emit("OccupyAppt",e,t))}),this.selectedSlot=function(e){t.debug("selected slot = ",e),d.occupiedSlotByAnother&&d.occupiedSlotByAnother.calId==e.calId?l.error("Sorry !, Slot "+e.calendarTime+" is not available now. Please select another slot ","Error"):(d.slot=e,o.close(d.slot))},this.ok=function(){o.close(d.slot)},this.cancel=function(){o.dismiss("cancel")}}]),angular.module("ocsApp.Bookings").factory("BookingFactory",["Packages","BookingHeaders","toastr","BookingCandidates","$q","CompanyFactory","mysqlDate","Companies","$log","$window","RedimedSiteFactory",function(e,t,o,a,n,i,s,r,l,d,c){function u(e,t){var o=moment(s(e)).format(t);return"Invalid date"==o?"":o}function m(e){l.debug("> Will send email to ",e),e.appointmentStatus.indexOf("Pending")>=0?a.sendConfirmationEmail({id:e.candidateId,type:"pending"},function(t){l.debug(">>sendConfirmationEmail",t),t.sentEmailStatus.indexOf("Error")>=0?(o.error(t.sentEmailStatus,"Error"),l.error("> Fail to send email to ",e)):(o.success(t.sentEmailStatus,""),l.debug("> Send email successfullt ",t.sentEmailStatus))}):a.sendConfirmationEmail({id:e.candidateId,type:"new"},function(t){l.debug(">>sendConfirmationEmail",t),t.sentEmailStatus.indexOf("Error")>=0?(o.error(t.sentEmailStatus,"Error"),l.error("> Fail to send email to ",e)):(o.success(t.sentEmailStatus,""),l.debug("> Send email successfullt ",t.sentEmailStatus))})}function p(e,t){return n(function(o,a){var n=_.where(e,{id:t})[0];l.debug("> package found in the catch for view booking form = ",n),n?o(n):r.getPackages({id:t},function(e){l.debug("> package found in the server for view booking form = ",e),o(e.packages.length>0?e.packages[0]:{})},function(e){a(e)})})}function g(e,t,o){var a="",n=[];l.debug(" printBookingForm has package ");for(var i in o.AssessmentHeaders){var s=o.AssessmentHeaders[i];a=a+"<b>"+s.headerName+"</b><br>",n.push({text:s.headerName,bold:!0});var r=[];for(var d in s.Assessments){var c=s.Assessments[d];a=a+" - "+c.assName+"<br>",r.push(" - "+c.assName)}n.push(r)}l.debug(" printBookingForm has package view ");var m=t.siteName;t.stateName&&(m=m+" - "+t.stateName),t.suburbName&&(m=m+" - "+t.suburbName);var p='<table cellspacing="0" cellpadding="4" align="center" style="border-collapse: collapse"> \n<tbody><tr><td colspan="4" bgcolor="Silver"><b>Booking Details</b></td></tr> \n<tr> \n<td style="border:1px solid gray">Company</td> \n<td style="border:1px solid gray" colspan="3">'+t.fatherCompanyName+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Subsidiary</td> \n<td style="border:1px solid gray" colspan="3">'+t.companyName+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">PO Number</td> \n<td style="border:1px solid gray" colspan="3">'+t.poNumber+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Project Identification</td> \n<td style="border:1px solid gray" colspan="3">'+t.projectIdentofication+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Booking Person</td> \n<td style="border:1px solid gray" colspan="3">'+t.bookingPerson+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Booking Person Contact Number</td> \n<td style="border:1px solid gray" colspan="3">'+t.contactNumber+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Results to</td> \n<td style="border:1px solid gray" colspan="3">'+t.resultEmail+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Invoices to</td> \n<td style="border:1px solid gray" colspan="3">'+t.invoiceEmail+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Comments</td> \n<td style="border:1px solid gray" colspan="3">'+t.comments+'</td> \n</tr> \n<tr><td colspan="4" bgcolor="Silver"><b>Worker Details</b></td></tr> \n<tr> \n<td style="border:1px solid gray">Name</td> \n<td style="border:1px solid gray">'+t.candidatesName+'</td> \n<td style="border:1px solid gray">DOB</td> \n<td style="border:1px solid gray">'+u(t.dob,"DD/MM/YYYY")+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Phone</td> \n<td style="border:1px solid gray">'+t.phone+'</td> \n<td style="border:1px solid gray">Email</td> \n<td style="border:1px solid gray">'+t.email+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Position applied for</td> \n<td style="border:1px solid gray" colspan="3">'+t.position+'</td> \n</tr> \n<tr><td colspan="4" bgcolor="Silver"><b>Paperwork</b></td></tr> \n<tr> \n<td style="border:1px solid gray" colspan="4"> \n'+t.paperwork+'</td></tr> \n<tr><td colspan="4" bgcolor="Silver"><b>Assessment Details</b></td></tr> \n<tr> \n<td style="border:1px solid gray" colspan="4"> \n'+a+'</td></tr> \n<tr><td colspan="4" bgcolor="Silver"><b>Appointment Details</b></td></tr> \n<tr> \n<td style="border:1px solid gray">Appointment location</td> \n<td style="border:1px solid gray" colspan="3">'+m+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Appointment time</td> \n<td style="border:1px solid gray" colspan="3">'+u(t.appointmentTime,"DD/MM/YYYY HH:mm")+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Appointment Notes</td> \n<td style="border:1px solid gray" colspan="3">'+t.appointmentNotes+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Appointment status</td> \n<td style="border:1px solid gray" colspan="3">'+t.appointmentStatus+"</td> \n</tr> \n</tbody></table>";l.debug("Print candidate form");var g=e.open("modules/Bookings/views/bookingform.html","","");g.dataFromParent=p}return l=l.getInstance("ocsApp.Bookings.BookingFactory"),{getCalendar:function(e,t,o){var a=n.defer(),i=new Date,s=new Date;return s.setDate(s.getDate()+60),c.getCalendar(e,i,s,t,function(e){l.debug("finished getCalendar...."),console.log(" BookingFactory.getCalendar = ",e),a.resolve(e)}),a.promise},cancelAppointment:function(e){var a=n.defer(),s={};return s.appointmentNotes=e.appointmentNotes,s.candidateId=e.candidateId,l.debug("will cancel the booking ",s),t.cancelBooking(s,function(t,n){l.debug("updated successfully"),o.success("Successfully updated. The booking list will refresh shortly !"),m(e),i.refreshBookingList(function(e){o.success("The booking list has been refresh"),a.resolve("cancel successfully")})},function(e){l.error("updated failed",e),o.error("Fail to update err = "+e.data.error.message,"Error"),a.reject(e.data.error.message)}),a.promise},attended:function(e){var t={},i=n.defer();return t.appointmentStatus="Attended",a.update({where:{candidateId:e.candidateId}},t,function(e,t){i.resolve("Attended successfully")},function(e){l.error("updated failed",e),o.error("Fail to update","Error")}),i.promise},sendConfirmationEmail:function(e){m(e)},getPackage:function(e,t){return p(e,t)},viewBookingDetail:function(e,t){var o=p(e,t.packageId);o.then(function(e){g(d,t,e)},function(e){g(d,t,""),l.error("Failed: "+e)})}}}]),angular.module("ocsApp.Companies").controller("ConfirmToDeleteCompanyCtrl",["$uibModalInstance","row",function(e,t){this.formDefines={div1:{type:"div",fieldClass:"modal-header",fields:{h3:{type:"h3",fieldClass:"modal-title",label:"Delete Company",controllerAs:"ConfirmToDeleteCompanyCtrl"}}},div2:{type:"div",fieldClass:"modal-body",fields:{h3:{type:"h3",fieldClass:"modal-title",label:"Do you want to delete company ?"}}},div3:{type:"div",fieldClass:"modal-footer",fields:{btn1:{type:"button",fieldClass:"btn btn-primary",ngClick:"ok()",label:"Save"},btn2:{type:"button",fieldClass:"btn btn-warning",ngClick:"cancel()",label:"Cancel"}}}},this.ok=function(){e.close(t)},this.cancel=function(){e.dismiss(t)}}]),angular.module("ocsApp.Companies").controller("CompaniesMainCtrl",["$uibModal","Companies","$log","DetailModal","DeleteModal","$state","CompanyModuleFactory","$scope",function(e,t,o,a,n,i,s,r){TableBaseCtrl.call(this,r,o,s,n,"CompaniesMainCtrl");this.isSubmitted=!1,this.form={},this.company={},this.setDeleteTemplateUrl('<my-dynamic-form formdefine = "{{ConfirmToDeleteCompanyCtrl.formDefines}}" ></my-dynamic-form>'),this.setDeleteController("ConfirmToDeleteCompanyCtrl"),this.setDeleteWindowSize("md"),this.setCloseDeleteModal(function(e){s.deleteCompany(e)}),this.detail=function(e){console.log("rowData",e),e?i.go("navigator.companies.detail",{row:e.id}):i.go("navigator.companies.detail",{row:null})}}]),angular.module("ocsApp.Companies").controller("NewCompanyCtrl",["$state","$stateParams","Companies","$log","toastr","BookingStatusFactory","DetailModal2","DeleteModal","CompanyModuleFactory",function(e,t,o,a,n,i,s,r,l){var d=parseInt(t.row),c=l.getMasterRow(d),u=this;DetailWithTableBaseCtrl.call(this,l,c,a,n,s,r,"NewCompanyCtrl"),this.row.defaultStatusObject={},this.bookingStatus=[],this.setDetailTemplateUrl('<my-dynamic-form formdefine = "{{NewSubCompanyCtrl.formDefines}}" ></my-dynamic-form>'),this.setDetailController("NewSubCompanyCtrl"),this.setDetailWindowSize("lg"),this.cancel=function(){e.go("navigator.companies.list")},c?this.windowTitle="Update Company":this.windowTitle="New Company",a.debug("modalTitle = ",this.windowTitle),i.getStatus(function(e){u.bookingStatus=e,u.row.defaultStatusObject=u.bookingStatus[_.findIndex(u.bookingStatus,"bookingStatus",u.row.defaultStatus)],console.log(" get status = ",e,u.row.defaultStatusObject)})}]),angular.module("ocsApp.Companies").controller("NewSubCompanyCtrl",["Companies","row","$log","toastr","BookingStatusFactory","$uibModalInstance","DetailModal","DeleteModal",function(e,t,o,a,n,i,s,r){DetailWithTableBaseCtrl.call(this,i,t,o,a,s,r,"NewSubCompanyCtrl");var l=this;this.row.defaultStatusObject={},this.bookingStatus=[],t?this.windowTitle="Update Sub Company":this.windowTitle="New Sub Company",o.debug("modalTitle = ",this.windowTitle),n.getStatus(function(e){l.bookingStatus=e,l.row.defaultStatusObject=l.bookingStatus[_.findIndex(l.bookingStatus,"bookingStatus",l.row.defaultStatus)],console.log(" get status = ",e,l.row.defaultStatusObject)}),this.saveRow=function(){o.debug("saveRow....."),t?(o.debug("will update company",t),l.row.defaultStatusObject&&(l.row.defaultStatus=l.row.defaultStatusObject.bookingStatus),e.update({where:{id:l.row.id}},l.row,function(e){o.debug("updated company",e),a.success("Company was updated successfully",""),l.closeModalAfterSave()},function(e){o.error("Fail to update position",e),a.error("Fail to update Position","Error")})):(l.row.defaultStatusObject&&(l.row.defaultStatus=l.row.defaultStatusObject.bookingStatus),l.row.id=0,o.debug("will create new company",t),e.create(l.row,function(e){o.debug("created company",e),a.success("Company was created successfully",""),i.close({})},function(e){a.error("Fail to create Position","Error"),o.error("failt to create position",e)}))},this.formDefines={div1:{type:"div",fieldClass:"modal-header",controllerAs:"NewSubCompanyCtrl",isSubmitedVar:"isSubmitted",fields:{h3:{type:"h3",label:"{{NewSubCompanyCtrl.windowTitle}}",fieldClass:"modal-title"}}},div2:{type:"div",fieldClass:"modal-body",fields:{form:{type:"form",name:"form",fieldClass:"form-horizontal form-row-seperated",fields:{companyName:{field:"companyName",ngModel:"row.companyName",label:"Company Name",placeholder:"Company name",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},addr:{field:"addr",ngModel:"row.addr",label:"Address",placeholder:"Address",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},state:{field:"state",ngModel:"row.state",label:"State",placeholder:"State",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{ACT:{label:"Australian Capital Territory"},NSW:{label:"New South Wales"},VIC:{label:"Victoria"},QLD:{label:"Queensland"},SA:{label:"South Australia"},WA:{label:"Western Australia"},NT:{label:"Northern Territory"}}},country:{field:"country",ngModel:"row.country",label:"Country",placeholder:"Country",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{Australia:{label:"Australia"}}},defaultStatus:{field:"defaultStatus",ngModel:"row.defaultStatusObject",label:"Default Status",placeholder:"Default status",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",ngOptions:"status.bookingStatus for status in NewCompanyCtrl.bookingStatus"},description:{field:"description",ngModel:"row.description",label:"Description",placeholder:"Description",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},industry:{field:"industry",ngModel:"row.industry",label:"Industry",placeholder:"Industry",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},invoiceEmail:{field:"invoiceEmail",ngModel:"row.invoiceEmail",label:"Invoice Email",placeholder:"Invoice email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Invoice email is required",emailHelpBlock:"Email is invalid"},resultEmail:{field:"resultEmail",ngModel:"row.resultEmail",label:"Result Email",placeholder:"Result email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Result email is required",emailHelpBlock:"Email is invalid"},reportToEmail:{field:"reportToEmail",ngModel:"row.reportToEmail",label:"Report Email",placeholder:"",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"email",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Report email is required",emailHelpBlock:"Email is invalid"},fieldGroup:{type:"horizontalFieldGroup",fieldClass:"col-md-12",columnClass:"col-md-3",fields:{isaddcontactemailtoresult:{field:"isaddcontactemailtoresult",ngModel:"row.isaddcontactemailtoresult",label:"Is Result Email",placeholder:"Is Result Email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},isinvoiceemailtouser:{field:"isinvoiceemailtouser",ngModel:"row.isinvoiceemailtouser",label:"Is Invoice Email",placeholder:"Is Invoice Email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",
isOn:1,isOff:0},ispo:{field:"ispo",ngModel:"row.ispo",label:"PO",placeholder:"PO",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},isproject:{field:"isproject",ngModel:"row.isproject",label:"Project",placeholder:"Project",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0}}},poNumber:{field:"poNumber",ngModel:"row.poNumber",label:"PO Number",placeholder:"PO Number",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"}}}}},div3:{type:"div",fieldClass:"modal-footer",fields:{SaveButton:{type:"button",label:"Save",fieldClass:"btn btn-primary",ngClick:"ok()"},CancelButton:{type:"button",label:"Cancel",fieldClass:"btn btn-warning",ngClick:"cancel()"}}}},console.log(this.formDefines)}]),angular.module("dynform",[]).directive("dynamicForm",["$q","$parse","$http","$templateCache","$compile","$document","$timeout",function(e,t,o,a,n,i,s){var r={text:{element:"input",type:"text",editable:!0,textBased:!0},date:{element:"input",type:"date",editable:!0,textBased:!0},datetime:{element:"input",type:"datetime",editable:!0,textBased:!0},"datetime-local":{element:"input",type:"datetime-local",editable:!0,textBased:!0},email:{element:"input",type:"email",editable:!0,textBased:!0},month:{element:"input",type:"month",editable:!0,textBased:!0},number:{element:"input",type:"number",editable:!0,textBased:!0},password:{element:"input",type:"password",editable:!0,textBased:!0},search:{element:"input",type:"search",editable:!0,textBased:!0},tel:{element:"input",type:"tel",editable:!0,textBased:!0},textarea:{element:"textarea",editable:!0,textBased:!0},time:{element:"input",type:"time",editable:!0,textBased:!0},url:{element:"input",type:"url",editable:!0,textBased:!0},week:{element:"input",type:"week",editable:!0,textBased:!0},checkbox:{element:"input",type:"checkbox",editable:!0,textBased:!1},color:{element:"input",type:"color",editable:!0,textBased:!1},file:{element:"input",type:"file",editable:!0,textBased:!1},range:{element:"input",type:"range",editable:!0,textBased:!1},select:{element:"select",editable:!0,textBased:!1},checklist:{element:"div",editable:!1,textBased:!1},fieldset:{element:"fieldset",editable:!1,textBased:!1},radio:{element:"div",editable:!1,textBased:!1},button:{element:"button",type:"button",editable:!1,textBased:!1},hidden:{element:"input",type:"hidden",editable:!1,textBased:!1},image:{element:"input",type:"image",editable:!1,textBased:!1},legend:{element:"legend",editable:!1,textBased:!1},reset:{element:"button",type:"reset",editable:!1,textBased:!1},submit:{element:"button",type:"submit",editable:!1,textBased:!1}};return{restrict:"E",link:function(l,d,c){var u=null,m=!1,p=d,g=null;console.log("> 1  element =",d,"attrs=",c),angular.isDefined(c.ngModel)&&(angular.isDefined(c.template)||angular.isDefined(c.templateUrl))&&!d.hasClass("dynamic-form")&&(g=t(c.ngModel)(l),(c.template?e.when(t(c.template)(l)):o.get(c.templateUrl,{cache:a}).then(function(e){return e.data})).then(function(e){console.log("> 2  template =",e);var t=function(e,t){return props=e.split("."),(t||props.shift())+(props.length?"['"+props.join("']['")+"']":"")},o=function(e,o){console.log("> 3  field =",e," id =",o),"$"!=String(o).charAt(0)&&(angular.isDefined(r[e.type])&&r[e.type]!==!1?(angular.isDefined(e.model)||(e.model=o),u=angular.element(i[0].createElement(r[e.type].element)),angular.isDefined(r[e.type].type)&&u.attr("type",r[e.type].type),angular.isDefined(r[e.type].editable)&&r[e.type].editable&&(u.attr("ng-model",t(e.model,c.ngModel)),console.log("ng-model",t(e.model,c.ngModel)),angular.isDefined(e.required)&&u.attr("ng-required",e.required)),angular.isDefined(r[e.type].textBased)&&r[e.type].textBased&&(angular.isDefined(e.minLength)&&u.attr("ng-minlength",e.minLength),angular.isDefined(e.maxLength)&&u.attr("ng-maxlength",e.maxLength),angular.isDefined(e.validate)&&u.attr("ng-pattern",e.validate),angular.isDefined(e.placeholder)&&u.attr("placeholder",e.placeholder)),console.log("> 4  newElement =",u),this.append(u),u=null):(u=angular.element("<span></span>"),angular.isDefined(e.label)&&angular.element(u).html(e.label),angular.forEach(e,function(e,t){["label","type"].indexOf(t)>-1||u.attr(t,e)}),this.append(u),u=null))};for(angular.forEach(e,o,d);!angular.equals(p.parent(),i)&&!angular.equals(p[0],i[0].documentElement);){if(["form","ngForm","dynamicForm"].indexOf(c.$normalize(angular.lowercase(p.parent()[0].nodeName)))>-1){m=!0;break}p=p.parent()}u=m?angular.element(i[0].createElement("ng-form")):angular.element("<form></form>"),angular.forEach(c.$attr,function(e,t){console.log("adding into form = ",e,c[t]),u.attr(e,c[t])}),u.attr("model",c.ngModel),u.removeAttr("ng-model"),angular.forEach(d[0].classList,function(e){console.log("adding into form = ",e),u[0].classList.add(e)}),u.addClass("dynamic-form"),u.append(d.contents()),u.data("$_cleanModel",angular.copy(g)),u.bind("reset",function(){s(function(){l.$broadcast("reset",arguments)},0)}),l.$on("reset",function(){l.$apply(function(){l[c.ngModel]={}}),l.$apply(function(){l[c.ngModel]=angular.copy(u.data("$_cleanModel"))})}),n(u)(l),d.replaceWith(u)}))}}}]).directive("ngList",[function(){return{require:"?ngModel",link:function(e,t,o,a){var n=/\/(.*)\//.exec(t.attr(o.$attr.ngList)),i=n&&new RegExp(n[1])||t.attr(o.$attr.ngList)||",";(null===t[0].form||angular.element(t[0].form).hasClass("dynamic-form"))&&(a.$parsers.splice(0,1),a.$formatters.splice(0,1),a.$parsers.push(function(e){var t=[];return angular.isString(e)&&(String.prototype.trim?angular.forEach(e.split(i),function(e){e&&t.push(e.trim())}):angular.forEach(e.split(i),function(e){e&&t.push(e.replace(/^\s*/,"").replace(/\s*$/,""))})),t}),a.$formatters.push(function(e){var t=angular.isString(i)&&i||", ";if(angular.isArray(e))return e.join(t)}))}}}]).directive("input",["$parse",function(e){return{restrict:"E",require:"?ngModel",link:function(t,o,a,n){if(n)if("file"===a.type){var i=e(a.ngModel),s=i.assign,r=e(a.onChange),l=function(){t.$apply(function(){s(t,o[0].files),r(t)})};n.$render=function(){o[0].files=this.$viewValue},o.bind("change",l)}else"range"===a.type&&n.$parsers.push(function(e){if(e)return parseFloat(e)})}}}]).factory("fileReader",["$q",function(e){var t=function(e,t,o){return function(){o.$apply(function(){t.resolve(e.result)})}},o=function(e,t,o){return function(){o.$apply(function(){t.reject(e.error)})}},a=function(e,t){return function(o){t.$broadcast("fileProgress",{total:o.total,loaded:o.loaded,status:e.readyState})}},n=function(e,n){var i=new FileReader;return i.onload=t(i,e,n),i.onerror=o(i,e,n),i.onprogress=a(i,n),i};return{readAsArrayBuffer:function(t,o){var a=e.defer(),i=n(a,o);return i.readAsArrayBuffer(t),a.promise},readAsBinaryString:function(t,o){var a=e.defer(),i=n(a,o);return i.readAsBinaryString(t),a.promise},readAsDataURL:function(t,o){var a=e.defer(),i=n(a,o);return i.readAsDataURL(t),a.promise},readAsText:function(t,o){var a=e.defer(),i=n(a,o);return i.readAsText(t),a.promise}}}]),angular.module("dynform",[]).directive("dynamicForm",["$q","$parse","$http","$templateCache","$compile","$document","$timeout",function(e,t,o,a,n,i,s){var r={text:{element:"input",type:"text",editable:!0,textBased:!0},date:{element:"input",type:"date",editable:!0,textBased:!0},datetime:{element:"input",type:"datetime",editable:!0,textBased:!0},"datetime-local":{element:"input",type:"datetime-local",editable:!0,textBased:!0},email:{element:"input",type:"email",editable:!0,textBased:!0},month:{element:"input",type:"month",editable:!0,textBased:!0},number:{element:"input",type:"number",editable:!0,textBased:!0},password:{element:"input",type:"password",editable:!0,textBased:!0},search:{element:"input",type:"search",editable:!0,textBased:!0},tel:{element:"input",type:"tel",editable:!0,textBased:!0},textarea:{element:"textarea",editable:!0,textBased:!0},time:{element:"input",type:"time",editable:!0,textBased:!0},url:{element:"input",type:"url",editable:!0,textBased:!0},week:{element:"input",type:"week",editable:!0,textBased:!0},checkbox:{element:"input",type:"checkbox",editable:!0,textBased:!1},color:{element:"input",type:"color",editable:!0,textBased:!1},file:{element:"input",type:"file",editable:!0,textBased:!1},range:{element:"input",type:"range",editable:!0,textBased:!1},select:{element:"select",editable:!0,textBased:!1},checklist:{element:"div",editable:!1,textBased:!1},fieldset:{element:"fieldset",editable:!1,textBased:!1},radio:{element:"div",editable:!1,textBased:!1},button:{element:"button",type:"button",editable:!1,textBased:!1},hidden:{element:"input",type:"hidden",editable:!1,textBased:!1},image:{element:"input",type:"image",editable:!1,textBased:!1},legend:{element:"legend",editable:!1,textBased:!1},reset:{element:"button",type:"reset",editable:!1,textBased:!1},submit:{element:"button",type:"submit",editable:!1,textBased:!1}};return{restrict:"E",link:function(l,d,c){var u=null,m=null,p={},g="",f=!1,h=d,y=null;console.log("> 1  element =",d,"attrs=",c),angular.isDefined(c.ngModel)&&(angular.isDefined(c.template)||angular.isDefined(c.templateUrl))&&!d.hasClass("dynamic-form")&&(y=t(c.ngModel)(l),(c.template?e.when(t(c.template)(l)):o.get(c.templateUrl,{cache:a}).then(function(e){return e.data})).then(function(e){console.log("> 2  template =",e);var t=function(e,t,o,a,n){t=t.split("."),a=a||t.pop();for(var i=0;i<t.length;i++)e=e[t[i]]=e[t[i]]||{};n||(e[a]=o)},o=function(e,t){return props=e.split("."),(t||props.shift())+(props.length?"['"+props.join("']['")+"']":"")},a=function(e,n){if(console.log("> 3  field =",e," id =",n),"$"!=String(n).charAt(0))if(angular.isDefined(r[e.type])&&r[e.type]!==!1){if(angular.isDefined(e.model)||(e.model=n),u=angular.element(i[0].createElement(r[e.type].element)),angular.isDefined(r[e.type].type)&&u.attr("type",r[e.type].type),angular.isDefined(r[e.type].editable)&&r[e.type].editable&&(u.attr("name",o(e.model)),u.attr("ng-model",o(e.model,c.ngModel)),t(y,e.model,{},null,!0),angular.isDefined(e.readonly)&&u.attr("ng-readonly",e.readonly),angular.isDefined(e.required)&&u.attr("ng-required",e.required),angular.isDefined(e.val)&&(t(y,e.model,angular.copy(e.val)),u.attr("value",e.val))),angular.isDefined(r[e.type].textBased)&&r[e.type].textBased&&(angular.isDefined(e.minLength)&&u.attr("ng-minlength",e.minLength),angular.isDefined(e.maxLength)&&u.attr("ng-maxlength",e.maxLength),angular.isDefined(e.validate)&&u.attr("ng-pattern",e.validate),angular.isDefined(e.placeholder)&&u.attr("placeholder",e.placeholder)),"number"===e.type||"range"===e.type)angular.isDefined(e.minValue)&&u.attr("min",e.minValue),angular.isDefined(e.maxValue)&&u.attr("max",e.maxValue),angular.isDefined(e.step)&&u.attr("step",e.step);else if(["text","textarea"].indexOf(e.type)>-1)angular.isDefined(e.splitBy)&&u.attr("ng-list",e.splitBy);else if("checkbox"===e.type)angular.isDefined(e.isOn)&&u.attr("ng-true-value",e.isOn),angular.isDefined(e.isOff)&&u.attr("ng-false-value",e.isOff),angular.isDefined(e.slaveTo)&&u.attr("ng-checked",e.slaveTo);else if("checklist"===e.type)angular.isDefined(e.val)&&t(y,e.model,angular.copy(e.val)),angular.isDefined(e.options)&&(angular.isDefined(y[e.model])&&angular.isObject(y[e.model])||t(y,e.model,{}),angular.forEach(e.options,function(a,n){m=angular.element('<input type="checkbox" />'),m.attr("name",o(e.model+"."+n)),m.attr("ng-model",o(e.model+"."+n,c.ngModel)),angular.isDefined(a["class"])&&m.attr("ng-class",a["class"]),angular.isDefined(e.disabled)&&m.attr("ng-disabled",e.disabled),angular.isDefined(e.readonly)&&m.attr("ng-readonly",e.readonly),angular.isDefined(e.required)&&m.attr("ng-required",e.required),angular.isDefined(e.callback)&&m.attr("ng-change",e.callback),angular.isDefined(a.isOn)&&m.attr("ng-true-value",a.isOn),angular.isDefined(a.isOff)&&m.attr("ng-false-value",a.isOff),angular.isDefined(a.slaveTo)&&m.attr("ng-checked",a.slaveTo),angular.isDefined(a.val)&&(t(y,e.model,angular.copy(a.val),n),m.attr("value",a.val)),angular.isDefined(a.label)&&(m=m.wrap("<label></label>").parent(),m.append(document.createTextNode(" "+a.label))),u.append(m)}));else if("radio"===e.type)angular.isDefined(e.val)&&t(y,e.model,angular.copy(e.val)),angular.isDefined(e.values)&&angular.forEach(e.values,function(t,a){m=angular.element('<input type="radio" />'),m.attr("name",o(e.model)),m.attr("ng-model",o(e.model,c.ngModel)),angular.isDefined(e["class"])&&m.attr("ng-class",e["class"]),angular.isDefined(e.disabled)&&m.attr("ng-disabled",e.disabled),angular.isDefined(e.callback)&&m.attr("ng-change",e.callback),angular.isDefined(e.readonly)&&m.attr("ng-readonly",e.readonly),angular.isDefined(e.required)&&m.attr("ng-required",e.required),m.attr("value",a),angular.isDefined(e.val)&&e.val===a&&m.attr("checked","checked"),t&&(m=m.wrap("<label></label>").parent(),m.append(document.createTextNode(" "+t))),u.append(m)});else if("select"===e.type)angular.isDefined(e.multiple)&&e.multiple!==!1&&u.attr("multiple","multiple"),angular.isDefined(e.empty)&&e.empty!==!1&&u.append(angular.element(i[0].createElement("option")).attr("value","").html(e.empty)),angular.isDefined(e.autoOptions)?u.attr("ng-options",e.autoOptions):angular.isDefined(e.options)&&(angular.forEach(e.options,function(e,t){m=angular.element(i[0].createElement("option")),m.attr("value",t),angular.isDefined(e.disabled)&&m.attr("ng-disabled",e.disabled),angular.isDefined(e.slaveTo)&&m.attr("ng-selected",e.slaveTo),angular.isDefined(e.label)&&m.html(e.label),angular.isDefined(e.group)?(angular.isDefined(p[e.group])||(p[e.group]=angular.element(i[0].createElement("optgroup")),p[e.group].attr("label",e.group)),p[e.group].append(m)):u.append(m)}),angular.equals(p,{})||(angular.forEach(p,function(e){u.append(e)}),p={}));else if("image"===e.type)angular.isDefined(e.label)&&u.attr("alt",e.label),angular.isDefined(e.source)&&u.attr("src",e.source);else if("hidden"===e.type)u.attr("name",o(e.model)),u.attr("ng-model",o(e.model,c.ngModel)),angular.isDefined(e.val)&&(t(y,e.model,angular.copy(e.val)),u.attr("value",e.val));else if("file"===e.type)angular.isDefined(e.multiple)&&u.attr("multiple",e.multiple);else if("fieldset"===e.type&&angular.isDefined(e.fields)){var s=u;angular.forEach(e.fields,a,u),u=s}"radio"!==e.type&&(angular.isDefined(e["class"])&&u.attr("ng-class",e["class"]),"checklist"!==e.type&&(angular.isDefined(e.disabled)&&u.attr("ng-disabled",e.disabled),angular.isDefined(e.callback)&&(g=["button","fieldset","image","legend","reset","submit"].indexOf(e.type)>-1?"ng-click":"ng-change",u.attr(g,e.callback)))),angular.isDefined(e.label)&&(["image","hidden"].indexOf(e.type)>-1?angular.noop():["fieldset"].indexOf(e.type)>-1?u.prepend(angular.element(i[0].createElement("legend")).html(e.label)):["button","legend","reset","submit"].indexOf(e.type)>-1?u.html(e.label):(u=u.wrap("<label></label>").parent(),u.prepend(document.createTextNode(e.label+" ")))),angular.isDefined(e.attributes)&&angular.forEach(e.attributes,function(e,t){u.attr(t,e)}),console.log("> 4  newElement =",u),this.append(u),u=null}else u=angular.element("<span></span>"),angular.isDefined(e.label)&&angular.element(u).html(e.label),angular.forEach(e,function(e,t){["label","type"].indexOf(t)>-1||u.attr(t,e)}),this.append(u),u=null};for(angular.forEach(e,a,d);!angular.equals(h.parent(),i)&&!angular.equals(h[0],i[0].documentElement);){if(["form","ngForm","dynamicForm"].indexOf(c.$normalize(angular.lowercase(h.parent()[0].nodeName)))>-1){f=!0;break}h=h.parent()}u=f?angular.element(i[0].createElement("ng-form")):angular.element("<form></form>"),angular.forEach(c.$attr,function(e,t){console.log("adding into form = ",e,c[t]),u.attr(e,c[t])}),u.attr("model",c.ngModel),u.removeAttr("ng-model"),angular.forEach(d[0].classList,function(e){console.log("adding into form = ",e),u[0].classList.add(e)}),u.addClass("dynamic-form"),u.append(d.contents()),u.data("$_cleanModel",angular.copy(y)),u.bind("reset",function(){s(function(){l.$broadcast("reset",arguments)},0)}),l.$on("reset",function(){l.$apply(function(){l[c.ngModel]={}}),l.$apply(function(){l[c.ngModel]=angular.copy(u.data("$_cleanModel"))})}),n(u)(l),d.replaceWith(u)}))}}}]).directive("ngList",[function(){return{require:"?ngModel",link:function(e,t,o,a){var n=/\/(.*)\//.exec(t.attr(o.$attr.ngList)),i=n&&new RegExp(n[1])||t.attr(o.$attr.ngList)||",";(null===t[0].form||angular.element(t[0].form).hasClass("dynamic-form"))&&(a.$parsers.splice(0,1),a.$formatters.splice(0,1),a.$parsers.push(function(e){var t=[];return angular.isString(e)&&(String.prototype.trim?angular.forEach(e.split(i),function(e){e&&t.push(e.trim())}):angular.forEach(e.split(i),function(e){e&&t.push(e.replace(/^\s*/,"").replace(/\s*$/,""))})),t}),a.$formatters.push(function(e){var t=angular.isString(i)&&i||", ";if(angular.isArray(e))return e.join(t)}))}}}]).directive("input",["$parse",function(e){return{restrict:"E",require:"?ngModel",link:function(t,o,a,n){if(n)if("file"===a.type){var i=e(a.ngModel),s=i.assign,r=e(a.onChange),l=function(){t.$apply(function(){s(t,o[0].files),r(t)})};n.$render=function(){o[0].files=this.$viewValue},o.bind("change",l)}else"range"===a.type&&n.$parsers.push(function(e){if(e)return parseFloat(e)})}}}]).factory("fileReader",["$q",function(e){var t=function(e,t,o){return function(){o.$apply(function(){t.resolve(e.result)})}},o=function(e,t,o){return function(){o.$apply(function(){t.reject(e.error)})}},a=function(e,t){return function(o){t.$broadcast("fileProgress",{total:o.total,loaded:o.loaded,status:e.readyState})}},n=function(e,n){var i=new FileReader;return i.onload=t(i,e,n),i.onerror=o(i,e,n),i.onprogress=a(i,n),i};return{readAsArrayBuffer:function(t,o){var a=e.defer(),i=n(a,o);return i.readAsArrayBuffer(t),a.promise},readAsBinaryString:function(t,o){var a=e.defer(),i=n(a,o);return i.readAsBinaryString(t),a.promise},readAsDataURL:function(t,o){var a=e.defer(),i=n(a,o);return i.readAsDataURL(t),a.promise},readAsText:function(t,o){var a=e.defer(),i=n(a,o);return i.readAsText(t),a.promise}}}]),angular.module("ocsApp.Companies").factory("CompanyModuleFactory",["Companies","$log","toastr","$rootScope","$state",function(e,t,o,a,n){t=t.getInstance("ocsApp.Companies.CompanyModuleFactory");var i=null,s="",r=function(t){e.find({filter:{include:"subsidiaries"}},function(e){console.log("Get company from server",e),i=e,t(i)})};return{getMasterRows:function(e){i?(console.log("Get company from memory",i),e(i)):r(e)},refreshMasterRows:function(e){r(e)},getMasterRow:function(e){if(i){var t=i[_.findIndex(i,"id",e)];return console.log("get company from memory= ",e,t,i),t}return{}},deleteMasterRow:function(a){var n=this;t.debug("This is a custom closeDeleteModal function",a),e.deleteById({id:a.id},function(e){console.log(e),t.debug("Successfully delete company",e),n.refreshMasterRows(function(e){n.masterDetailBroadcast("Delete Master Successfully")})},function(e){t.error("Fail to delete company",e),o.error("Fail to delete the company. "+e.data.error.message,"error")})},masterDetailBroadcast:function(e){s=e,a.$broadcast("MasterDetailBroadcast")},getMessage:function(){return s},saveMaster:function(a){var i=this;a.id?(t.debug("will update company",a),a.defaultStatusObject&&(a.defaultStatus=a.defaultStatusObject.bookingStatus),e.update({where:{id:a.id}},a,function(e){t.debug("updated company",e),o.success("Company was updated successfully",""),n.go("navigator.companies.list"),i.refreshMasterRows(function(e){i.masterDetailBroadcast("Update Master Successfully")})},function(e){t.error("Fail to update position",e),o.error("Fail to update Position "+e.data.error.message,"Error")})):(a.defaultStatusObject&&(a.defaultStatus=a.defaultStatusObject.bookingStatus),a.id=0,t.debug("will create new company",a),e.create(a,function(e){t.debug("created company",e),o.success("Company was created successfully",""),n.go("navigator.companies.list"),i.refreshMasterRows(function(e){i.masterDetailBroadcast("Insert Master Successfully")})},function(e){o.error("Fail to create Position","Error"),o.error("Fail to create Position "+e.data.error.message,"Error")}))}}}]),angular.module("ocsApp").controller("IndexMainCtrl",["$log","mySharedService","$scope","SetClassService","$location",function(e,t,o,a,n){e=e.getInstance("ocsApp.IndexMainCtrl"),e.debug("Hello, I am index controller and url = "+n.path()),this.className=0;var i=this;this.className=a.getClass(),n.path().indexOf("bookingForm")>0&&(this.className=2),o.$on("handleBroadcast",function(){var o=t.message;e.debug("Received a message from LoginCrtl/navigator.MainCtrl = "+o),(o.indexOf("Login successfully")>=0||o.indexOf("Logout successfully")>=0)&&i.changeIt()}),this.changeIt=function(){1==this.className?this.className=0:this.className=1,e.debug("changeIt className to  "+this.className)}}]),angular.module("ocsApp.MakeBooking").controller("CustomPackageCtrl",["$uibModalInstance","CompanyFactory","$log",function(e,t,o){o=o.getInstance("ocsApp.MakeBooking.CustomPackageCtrl"),o.debug("I am CustomPackageCtrl");var a=this;this.companyObject=null,this.assessments=[],t.getCompany(function(e){a.companyObject=e}),this.selectedAss=function(){o.debug("assessments = ",a.assessments)},this.ok=function(){e.close(a.assessments)},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.MakeBooking").controller("MakeBookingMainCtrl",["CompanyFactory","$scope","$cookieStore","$uibModal","$log","toastr","mysqlDate","MakeBookingFactory","mySharedService",function(e,t,o,a,n,i,s,r,l){function d(e,t){n.debug("Update PO,Emails,..."),t.defaultNote&&(u.newBooking.comments=t.defaultNote),t.poNumber&&(u.newBooking.poNumber=t.poNumber),t.projectIdentification&&(u.newBooking.projectIdentification=t.projectIdentification),t.invoiceEmail?1==e.isinvoiceemailtouser?(u.newBooking.invoiceEmail=t.invoiceEmail,NaN+u.user.contactEmail):u.newBooking.invoiceEmail=t.invoiceEmail:1==e.isinvoiceemailtouser&&(u.newBooking.invoiceEmail=u.user.contactEmail),t.resultEmail?1==e.isaddcontactemailtoresult?u.newBooking.resultEmail=t.resultEmail+"; "+u.user.contactEmail:u.newBooking.resultEmail=t.resultEmail:1==e.isaddcontactemailtoresult&&(u.newBooking.resultEmail=u.user.contactEmail)}n=n.getInstance("ocsApp.MakeBooking.MakeBookingMainCtrl"),n.debug("I am make booking controller.");var c=e.getCurrentUser();this.user=e.getCurrentUser(),this.companyObject=null,this.newBooking={},this.newBooking.poNumber="",this.newBooking.newCandidates=[],this.subsidiary={},this.subsidiary2={},this.viewPackage="",this.form={},this.isSubmitted=!1,this.isSubmitingToTheServer=!1,this.isSubsidiary2=!1,this.isNoCandidate=!1,this.paperworkList=["Redimed","Gorgon","BP","Company Specific","CPPC","Rail","Wheatstone","MACA Mining","Aerison paperwork","Newmont","Shell","Woodside Offshore","Boral Paperwork"],this.newBooking.paperwork="Redimed",this.maxPeriod=15;var u=this,m=function(){e.getCompany(function(e){u.companyObject=e,d(u.companyObject,u.companyObject),n.debug("Make booking, get company info")})};m(),t.$on("handleBroadcast",function(){var e=l.message;n.debug("Received a message from ChangeCompanyCtrl = "+e),e.indexOf("Refresh make booking")>=0&&m()}),this.getAllSubsidiaries=function(e){n.debug("getAllSubsidiaries.Loading subsidiaries......"),e(u.companyObject.subsidiaries)},this.isAdminLogin=function(){return c.userType.indexOf("RediMed")>=0},this.newCompany=function(){n.debug("newCompany is running....... ");var e=a.open({animation:!0,templateUrl:"modules/MakeBooking/views/makeBooking.NewCompany.html",controller:"NewCompanyAtMakingBookingCtrl",controllerAs:"NewCompanyAtMakingBookingCtrl",size:"md"});e.result.then(function(e){n.debug("newCompany = ",e),r.newSubsidiaryForRedimed(e).then(function(e){n.debug("created new company sucessfully = ",e),u.newBooking.subsidiary=e,u.subsidiary=e,u.companyObject.subsidiaries.push(e)})},function(){n.debug("Modal New company dismissed at: "+new Date)})},this.submitForm=function(){u.isSubmitted=!0,!u.newBooking.subsidiary&&u.isAdminLogin()&&(u.form.company.$invalid=!0),u.newBooking.newCandidates.length>0?u.isNoCandidate=!1:(u.isNoCandidate=!0,i.error("Please enter candidate information","Error"),n.error("Please enter candidate information"),u.newCandidate()),u.form.$invalid||u.form.company.$invalid?(i.error("Please enter all required fields of booking information","Error"),n.error("Please enter all required fields of booking information",u.form.$error)):(u.isSubmitingToTheServer=!0,r.submitBooking(u.newBooking,u.companyObject,c).then(function(e){u.isSubmitingToTheServer=!1,n.debug("Submit booking successfully",e),i.success("Successfully submitted"),i.success("The booking list will be updated shortly. Please wait !"),u.newBooking={},u.newBooking.newCandidates=[],u.isSubmitted=!1},function(e){u.isSubmitingToTheServer=!1,n.error("Fail to submit booking",e)}))},this.selectedSubsidiary=function(e){n.debug("selectedSubsidiary = ",e),u.newBooking.subsidiary=e,u.subsidiary2={},u.newBooking.subsidiary.subsidiaries?this.isSubsidiary2=u.newBooking.subsidiary.subsidiaries.length>0:this.isSubsidiary2=!1,d(u.companyObject,u.newBooking.subsidiary)},this.isShowSubsidiary2=function(){return this.isSubsidiary2},this.isEditPackage=function(){return!(this.newBooking.newCandidates.length>0)},this.selectedPackage=function(){if(u.maxPeriod=15,n.debug(" selected Package "),u.newBooking["package"].packageName.indexOf("Custom")>=0){u.viewPackage="";var e=a.open({animation:!0,templateUrl:"modules/MakeBooking/views/makeBooking.CustomPackage.html",controller:"CustomPackageCtrl",controllerAs:"CustomPackageCtrl",size:"lg"});e.result.then(function(e){n.debug("customPackage = ",e);var t=[];e.forEach(function(e){t.push(e.id);var o=e.period;o>u.maxPeriod&&(u.maxPeriod=o)}),u.newBooking.customPackage=t,u.newCandidate()},function(){n.debug("Modal Package dismissed at: "+new Date)})}else{u.viewPackage="";for(var t in u.newBooking["package"].AssessmentHeaders){u.viewPackage=u.viewPackage+"<br><b>"+u.newBooking["package"].AssessmentHeaders[t].headerName+"</b>";for(var o in u.newBooking["package"].AssessmentHeaders[t].Assessments){var i=u.newBooking["package"].AssessmentHeaders[t].Assessments[o].period;i>u.maxPeriod&&(u.maxPeriod=i),u.viewPackage=u.viewPackage+"<br> - "+u.newBooking["package"].AssessmentHeaders[t].Assessments[o].assName}}n.debug("View package:",u.viewPackage),u.newCandidate()}},this.isPO=function(){return 1==u.companyObject.ispo},this.isProjectIdentification=function(){return 1==u.companyObject.isproject},this.isNotEditInvoiceAndResultEmails=function(){return 1==u.user.isnoteditemailsheader},this.deleteCandidate=function(e,t){n.debug("Remove candidate at "+e,t),u.newBooking.newCandidates.splice(e,1)},this.newCandidate=function(e,t){if(u.newBooking["package"]||u.newBooking.customPackagepackage){n.debug("New/replace candidate ",t," index = ",e);var o=a.open({animation:!0,backdrop:"static",templateUrl:"modules/MakeBooking/views/makeBooking.NewCandidate.html",controller:"NewCandidateCtrl",controllerAs:"NewCandidateCtrl",size:"lg",resolve:{candidate:function(){return t},indexOfCandidate:function(){return e},maxPeriod:function(){return u.maxPeriod}}});o.result.then(function(e){var t=e.index,o=e.candidate;t>=0?(n.debug("repleace the candidate in the array with index = "+t,o),u.newBooking.newCandidates[t]=o):(n.debug("add candidate into array",o),u.newBooking.newCandidates.push(o))},function(e){n.debug("Modal Candidate dismissed at: "+new Date,e)})}else i.error("Please select a package","Error")}}]),angular.module("ocsApp.MakeBooking").controller("NewCandidateCtrl",["$uibModalInstance","CompanyFactory","RedimedSiteFactory","MakeBookingFactory","mysqlDate","$log","candidate","indexOfCandidate","maxPeriod","$scope","mySocket","toastr",function(e,t,o,a,n,i,s,r,l,d,c,u){function m(){var e=new Date(p.BookingCandidate.preferredToDate);isNaN(e)&&(e=new Date(p.BookingCandidate.preferredFromDate)),e.setDate(e.getDate()+2),i.debug("will getCalendar with maxperiod =",l),p.BookingCandidate.site.id&&o.getCalendar(p.BookingCandidate.site.id,p.BookingCandidate.preferredFromDate,e,l,function(e){p.calendars=e,p.BookingCandidate.slot&&(p.calendars.forEach(function(e){e.date==p.BookingCandidate.slot.calendarDate&&(console.log("found the date in calendars = ",e),e.slots.push(p.BookingCandidate.slot),console.log("new cal = ",e),e.slots=_.sortBy(e.slots,"fromTimeInInt"))}),console.log(">>>>>>>>Calendars after adding the current slot = ",p.calendars))})}i=i.getInstance("ocsApp.MakeBooking.NewCandidateCtrl");var p=this;this.status={},this.BookingCandidate={},this.dateStatus={},this.dateStatus.dobOpened=!1,this.dateStatus.fromDateOpened=!1,this.dateStatus.toDateOpened=!1,this.format="dd/MM/yyyy",this.BookingCandidate.dob=null,this.genderList=["Male","Female"];var g=new Date,f=new Date;f.setDate(g.getDate()+7),this.BookingCandidate.preferredFromDate=g,this.BookingCandidate.preferredToDate=f,this.BookingCandidate.holdingId=0,this.BookingCandidate.period=l,this.companyObject=null,this.sites=null,this.states=null,this.suburbs=null,this.calendars=[{id:1},{id:2}],this.isSubmitted=!1,this.newCandidateForm={},this.occupiedSlotByAnother=null,s?(this.BookingCandidate=s,m()):this.BookingCandidate.candidateTempId=a.getCandidateTempId(),t.getCompany(function(e){p.companyObject=e}),o.getSite(function(e){p.sites=e,i.debug("sites")}),c.on("UpdateCalendar",function(e){i.debug("-->refresh calendars by server occupiedSlot = ",e),e&&(p.occupiedSlotByAnother=e,p.BookingCandidate.slot&&p.BookingCandidate.slot.calId==e.calId&&(u.error("Sorry !, Slot "+p.BookingCandidate.slot.calendarTime+" is not available now. Please select another slot ","Error"),p.BookingCandidate.slot=null),p.calendars.forEach(function(t){t.date==e.calendarDate&&t.slots.forEach(function(o,a){o.calId==e.calId&&t.slots.splice(a,1)})}))}),this.selectedSlot=function(e){i.debug("selected slot = ",e),p.occupiedSlotByAnother&&p.occupiedSlotByAnother.calId==e.calId?u.error("Sorry !, Slot "+e.calendarTime+" is not available now. Please select another slot ","Error"):p.BookingCandidate.slot=e},d.$on("$destroy",function(){i.debug("remove socket.io listener....................."),c.removeListener("UpdateCalendar")}),d.$watch("NewCandidateCtrl.BookingCandidate.slot",function(e,t){e!==t&&(console.log("$watch: that.BookingCandidate.slot changed.",e,t),c.emit("OccupyAppt",e,t,p.BookingCandidate.candidateTempId))}),this.calendarChanged=function(){},this.fromOrToDateChanged=function(){m()},this.selectedSite=function(){i.debug("selectedSite is running"),p.states=p.BookingCandidate.site.States,p.BookingCandidate.suburb=null,p.BookingCandidate.state=null,p.suburbs=null,p.BookingCandidate.calendar=null,p.BookingCandidate.slot=null,m()},this.selectedState=function(){p.BookingCandidate.state&&(p.suburbs=p.BookingCandidate.state.SubStates)},this.isStates=function(){return null!=p.states&&!(p.states.length<=0)},this.isSuburbs=function(){return null!=p.suburbs&&!(p.suburbs.length<=0)},this.openDOB=function(e){p.dateStatus.dobOpened=!0},this.openFromDate=function(e){p.dateStatus.fromDateOpened=!0},this.openToDate=function(e){p.dateStatus.toDateOpened=!0},this.ok=function(){if(p.isSubmitted=!0,p.newCandidateForm.$valid){i.debug("Exit candidate valid",p.BookingCandidate);var t={};t.index=r,t.candidate=p.BookingCandidate,e.close(t)}else i.error("Exit candidate error",p.newCandidateForm.$error)},this.cancel=function(){c.emit("OccupyAppt",null,p.BookingCandidate.slot),e.dismiss(p.BookingCandidate.slot)}}]),angular.module("ocsApp.MakeBooking").controller("NewCompanyAtMakingBookingCtrl",["$uibModalInstance","$log",function(e,t){t=t.getInstance("ocsApp.MakeBooking.NewCompanyAtMakingBookingCtrl"),t.debug("NewCompanyCtrl is running...");
var o=this;this.company={},this.companyObject=null,this.isSubmitted=!1,this.form={},this.ok=function(){o.isSubmitted=!0,t.debug("OK to exit modal valid=",o.form.$valid),t.debug("OK to exit modal invalid=",o.form.$invalid),t.debug("OK to exit modal error=",o.form.$error),o.form.$valid&&e.close(o.company)},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.MakeBooking").factory("MakeBookingFactory",["BookingHeaders","toastr","BookingCandidates","$q","CompanyFactory","mysqlDate","Companies","$log","mySharedService",function(e,t,o,a,n,i,s,r,l){var d=0;return r=r.getInstance("ocsApp.MakeBooking.MakeBookingFactory"),r.save(),{getCandidateTempId:function(){return d++,d},submitBooking:function(s,d,c){r.debug("will submit the booking");var u=a.defer(),m={};m.bookingId=0,m.poNumber=s.poNumber,m.resultEmail=s.resultEmail,m.invoiceEmail=s.invoiceEmail,m.projectIdentofication=s.projectIdentification,m.comments=s.comments,m.packageId=s["package"].id,m.siteId=null,m.companyId=d.id,m.period=null,m.isbookingatredimed=d.id,m.paperwork=s.paperwork,s.bookingPerson?(m.bookingPerson=s.bookingPerson,m.contactNumber=s.contactNumber):(m.bookingPerson=c.bookingPerson,m.contactNumber=c.contactNumber),s.customPackage&&(m.customPackage=s.customPackage),s.subsidiary&&(null==s.subsidiary.fatherId?m.companyId=s.subsidiary.id:m.subCompanyId=s.subsidiary.id),s.subsidiary2&&(m.subCompanyId=s.subsidiary2.id),m.contactEmail=c.contactEmail,m.createdBy=null,m.creationDate=null,m.lastUpdatedBy=null,m.lastUpdateDate=null;var p=[];for(var g in s.newCandidates){if(p[g]={},p[g].bookingId=0,p[g].candidateId=0,p[g].candidatesName=s.newCandidates[g].candidateName,p[g].gender=s.newCandidates[g].gender,p[g].dob=moment(s.newCandidates[g].dob).format("YYYY-MM-DD"),"Invalid date"==p[g].dob&&(p[g].dob=null),p[g].phone=s.newCandidates[g].phone,p[g].email=s.newCandidates[g].email,p[g].position=s.newCandidates[g].position,p[g].period=s.newCandidates[g].period,p[g].appointmentStatus="Pending",p[g].fromDate=moment(s.newCandidates[g].preferredFromDate).format("YYYY-MM-DD"),p[g].toDate=moment(s.newCandidates[g].preferredToDate).format("YYYY-MM-DD"),p[g].siteId=s.newCandidates[g].site.id,p[g].siteName=s.newCandidates[g].site.siteName,p[g].slots=[],s.newCandidates[g].slot){s.newCandidates[g].slot.followingSlots.forEach(function(e,t){p[g].slots.push(e.calId);var o=t+2;o<=5&&(p[g]["calendarId"+o]=e.calId)});var f=s.newCandidates[g].slot;p[g].calendarId=f.calId,p[g].practitionerId=f.doctorId,p[g].redimedNote=f.doctorName,p[g].appointmentTime=moment(i(f.fromTime)).format("YYYY-MM-DD HH:mm "),p[g].appointmentFromTime=moment(i(f.fromTime)).format("YYYY-MM-DD HH:mm "),p[g].appointmentToTime=moment(i(f.toTime)).format("YYYY-MM-DD HH:mm "),p[g].appointmentStatus="Confirmed",p[g].holdingId=s.newCandidates[g].holdingId}else p[g].appointmentStatus="Pending";s.newCandidates[g].state&&(p[g].stateId=s.newCandidates[g].state.id,p[g].stateName=s.newCandidates[g].state.stateName),s.newCandidates[g].suburb&&(p[g].suburbId=s.newCandidates[g].suburb.suburbId,p[g].suburbName=s.newCandidates[g].suburb.suburbName)}return m.candidates=p,r.debug("Will add this booking into the DB",m),e.submitBooking(m,function(e,a){r.debug("Submitted and data return",e),n.refreshBookingList(function(e){r.debug("refresh bookinglist successfully"),l.prepForBroadcast("Refresh booking list successfully")});for(var i in e.booking.bookingCandidates){var s=e.booking.bookingCandidates[i];s.candidateId&&(r.debug("> Will send email to ",s),o.sendConfirmationEmail({id:s.candidateId,type:"new"},function(e){r.debug(">>sendConfirmationEmail",e),e.sentEmailStatus.indexOf("Error")>=0?t.error(e.sentEmailStatus,"Error"):(t.success(e.sentEmailStatus,""),r.save())}))}u.resolve("Created Booking")},function(e){r.error("Fail to Submit the booking",e),"SLOT_NOT_AVAILABLE"==e.data.error.code?t.error(e.data.error.message,"Error"):t.error("Fail to submit the booking ["+e.data.error.message+"]","Error"),u.reject("Created Booking")}),u.promise},newSubsidiaryForRedimed:function(e){r.debug(">>newSubsidiaryForRedimed");var t=a.defer();return e.id=0,e.fatherId=112,r.debug("Will add new company = ",e),s.create(e,function(e){r.debug("new company created",e),t.resolve(e)},function(e){r.error(" fail to create the new company Error = ",e)}),t.promise}}}]),angular.module("ocsApp.MakePEMPhoneBooking").controller("BookingFormCtrl",["$state","RedimedSiteFactory","MakePEMPhoneBookingFactory","toastr","$log","$stateParams","LoopBackAuth",function(e,t,o,a,n,i,s){n=n.getInstance("ocsApp.MakePEMPhoneBooking.BookingFormCtrl"),n.debug("Hello, I am BookingFormCtrl",i.token);var r=this;this.token=i.token,this.loading1=!1,this.loading2=!1,this.token=i.token,this.showClickedValidation=!1,this.allAssessments=[],this.allSites=[],this.states=null,this.suburbs=null,this.assessments=[],this.isAuth=!1,this.isShowNotice=!1,this.isSubmitted=!1,this.isGettingAssessments=!0,this.isSubmitBookingSuccess=!1,this.format="dd/MM/yyyy",this.dateStatus={},this.dateStatus.dobOpened=!1,this.dateStatus.fromDateOpened=!1,this.dateStatus.toDateOpened=!1;var l=new Date,d=new Date;d.setDate(l.getDate()+1),l.setDate(l.getDate()+1),this.paperworkList=["Redimed","Gorgon","BP","Company Specific","CPPC","Rail","Wheatstone","MACA Mining","Aerison paperwork","Newmont","Shell"],this.timeList=["AM","PM"],this.BookingCandidate={},this.BookingCandidate.preferredFromDate=l,this.BookingCandidate.preferredToDate=d,this.BookingCandidate.dob=new Date(1990,0,1),this.BookingCandidate.bookingDate=new Date,this.BookingCandidate.paperwork="Redimed",this.BookingCandidate.preferredTime="AM",n.debug(" accessToken = ",this.token),s.setUser(this.token,1,"phoneBooking"),s.save(),this.openDOB=function(e){r.dateStatus.dobOpened=!0},this.openFromDate=function(e){r.dateStatus.fromDateOpened=!0},this.openToDate=function(e){r.dateStatus.toDateOpened=!0},this.selectedSite=function(){r.states=r.BookingCandidate.site.States,r.BookingCandidate.preferredSuburb=null,r.BookingCandidate.preferredState=null,r.suburbs=null},this.selectedState=function(){r.BookingCandidate.preferredState&&(r.suburbs=r.BookingCandidate.preferredState.SubStates)},this.isStates=function(){return null!=r.states&&!(r.states.length<=0)},this.isSuburbs=function(){return null!=r.suburbs&&!(r.suburbs.length<=0)},o.getAssessments().then(function(e){r.allAssessments=e.assessments,n.debug("assessments"),r.isAuth=!0,r.isGettingAssessments=!1,o.getPhoneBookingHeader().then(function(e){n.debug("bookingHeader = ",e),r.BookingCandidate.bookingId=e.bookingId,r.BookingCandidate.companyId=e.companyId,r.BookingCandidate.companyName=e.companyName,r.BookingCandidate.subCompanyId=e.subCompanyId,r.BookingCandidate.bookingPerson=e.bookingPerson,r.BookingCandidate.bookingPersonNumber=e.contactNumber,r.BookingCandidate.bookingPersonEmail=e.contactEmail}),t.getSite(function(e){n.debug("getSites = ",e),r.allSites=e})},function(e){console.log("MakePEMPhoneBookingFactory.getAssessment = ",e),r.isAuth=!1,r.isShowNotice=!0,r.isGettingAssessments=!1}),this.submit=function(){r.isSubmitted=!0,console.log(" that.BookingCandidate = ",r.BookingCandidate,r.assessments),0==r.assessments.length?a.error("Please select the assessments","Error"):r.form.$valid?o.submitBooking(r.BookingCandidate,r.assessments).then(function(e){r.isSubmitBookingSuccess=!0}):n.error("ForgotPasswordCtrl invalid",r.form.$error)}}]),angular.module("ocsApp.MakePEMPhoneBooking").controller("MakePEMPhoneBookingMainCtrl",["CompanyFactory","$cookieStore","$uibModal","$log","toastr","mysqlDate","MakePEMPhoneBookingFactory","mySharedService",function(e,t,o,a,n,i,s,r){a=a.getInstance("ocsApp.MakePEMPhoneBooking.MakePEMPhoneBookingMainCtrl"),a.debug("I am make MakePEMPhoneBookingMainCtrl controller."),this.user=e.getCurrentUser(),this.companyObject=null,this.newBooking={},this.subsidiary={},this.subsidiary2={},this.form={},this.isSubmitted=!1,this.isSubmitingToTheServer=!1,this.isSubsidiary2=!1,this.isNoCandidate=!1;var l=this,d=t.get("user");e.getCompany(function(e){l.companyObject=e,console.log("getCompany = ",e),a.debug("Make booking, get company info")}),this.getAllSubsidiaries=function(e){a.debug("getAllSubsidiaries.Loading subsidiaries......",l.companyObject.subsidiaries),e(l.companyObject.subsidiaries)},this.isAdminLogin=function(){return d.userType.indexOf("RediMed")>=0},this.newCompany=function(){var e=o.open({animation:!0,templateUrl:"modules/MakePEMPhoneBooking/views/makePEMPhoneBooking.NewCompany.html",controller:"NewPEMPhoneCompanyCtrl",controllerAs:"NewPEMPhoneCompanyCtrl",size:"md"});e.result.then(function(e){a.debug("newCompany = ",e),s.newSubsidiaryForRedimed(e).then(function(e){a.debug("created new company sucessfully = ",e),l.newBooking.subsidiary=e,l.subsidiary=e,l.companyObject.subsidiaries.push(e)})},function(){a.debug("Modal New company dismissed at: "+new Date)})},this.emailBookingForm=function(){l.isSubmitted=!0,!l.newBooking.subsidiary&&l.isAdminLogin()&&(l.form.company.$invalid=!0),l.form.$invalid||l.form.company.$invalid?(n.error("Please enter all required fields of booking information","Error"),a.error("Please enter all required fields of booking information",l.form.$error)):(l.isSubmitingToTheServer=!0,a.debug("will send email the booking form",l.newBooking),s.emailBookingForm(l.newBooking).then(function(e){l.isSubmitingToTheServer=!1,a.debug("Submit booking successfully",e),n.success("Successfully submitted"),n.success("The booking list will be updated shortly. Please wait !"),l.newBooking={},l.newBooking.newCandidates=[],l.isSubmitted=!1},function(e){a.err("Fail to submit booking",e)}))},this.selectedSubsidiary=function(e){a.debug("selectedSubsidiary = ",e),l.newBooking.subsidiary=e,l.subsidiary2={},l.newBooking.subsidiary.subsidiaries?this.isSubsidiary2=l.newBooking.subsidiary.subsidiaries.length>0:this.isSubsidiary2=!1},this.isShowSubsidiary2=function(){return this.isSubsidiary2}}]),angular.module("ocsApp.MakePEMPhoneBooking").controller("NewPEMPhoneCompanyCtrl",["$uibModalInstance","$log",function(e,t){t=t.getInstance("ocsApp.MakePEMPhoneBooking.NewPEMPhoneCompanyCtrl"),t.debug("NewCompanyCtrl is running...");var o=this;this.company={},this.companyObject=null,this.isSubmitted=!1,this.form={},this.ok=function(){o.isSubmitted=!0,t.debug("OK to exit modal valid=",o.form.$valid),t.debug("OK to exit modal invalid=",o.form.$invalid),t.debug("OK to exit modal error=",o.form.$error),o.form.$valid&&e.close(o.company)},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.MakePEMPhoneBooking").factory("MakePEMPhoneBookingFactory",["BookingHeaders","BookingCandidates","Companies","toastr","$log","$q",function(e,t,o,a,n,i){return n=n.getInstance("ocsApp.MakePEMPhoneBooking.MakePEMPhoneBookingFactory"),{emailBookingForm:function(t){n.debug("will send the booking form");var o=i.defer();return e.emailBookingForm(t,function(e,t){n.debug("Submitted and data return",e),o.resolve("Created Booking")},function(e){n.error("Fail to Submit the booking",e),a.error("Fail to submit the booking, please contact Redimed to assit","Error"),o.reject("Created Booking")}),o.promise},getAssessments:function(){n.debug("will get assessments for the booking form");var e=i.defer();return o.getPhoneBookingHeader(function(e,t){n.debug("getPhoneBookingHeader",e)},function(e){n.error("Fail to get assessments",e)}),o.getAssessments(function(t,o){n.debug("get assessments from server",t),e.resolve(t)},function(t){"Authorization Required"==t.data.error.message||"Invalid Access Token"==t.data.error.message?(n.error("Fail to get assessments",t),a.error("Session is expired. Please contact Redimed to receive the new booking form","Error"),e.reject("Fail to get assessments")):(n.error("Fail to get assessments",t),a.error("Fail to get assessments, please contact Redimed to assit ("+t+")","Error"),e.reject("Fail to get assessments"))}),e.promise},getPhoneBookingHeader:function(){n.debug("will get getPhoneBookingHeader for the booking form");var e=i.defer();return o.getPhoneBookingHeader(function(t,o){n.debug("getPhoneBookingHeader",t),e.resolve(t.phoneBookingHeader)},function(t){n.error("Fail to get getPhoneBookingHeader",t),e.reject("Fail to get getPhoneBookingHeader",t)}),e.promise},newSubsidiaryForRedimed:function(e){n.debug(">>newSubsidiaryForRedimed");var t=i.defer();return e.id=0,e.fatherId=112,n.debug("Will add new company = ",e),o.create(e,function(e){n.debug("new company created",e),t.resolve(e)},function(e){n.error(" fail to create the new company Error = ",e)}),t.promise},submitBooking:function(t,o){var s=i.defer(),r={bookingId:t.bookingId,poNumber:t.po,resultEmail:t.resultEmail,invoiceEmail:t.bookingPersonEmail,packageId:0,siteId:null,companyId:t.companyId,subCompanyId:t.subCompanyId,period:null,paperwork:"Redimed",bookingPerson:t.bookingPerson,customPackage:o,contactEmail:t.bookingPersonEmail,comments:t.comment,candidates:[{bookingId:t.bookingId,candidateId:0,candidatesName:t.candidateName,dob:moment(t.dob).format("YYYY-MM-DD"),phone:t.number,email:t.email,position:t.position,appointmentStatus:"Pending",fromDate:moment(t.preferredFromDate).format("YYYY-MM-DD"),toDate:moment(t.preferredToDate).format("YYYY-MM-DD"),siteId:t.site.id,siteName:t.site.siteName,preferredTime:t.preferredTime,isRedimedCallCandidate:t.isRedimedCallCandidate}]};return t.preferredState&&(r.candidates[0].stateId=t.preferredState.id,r.candidates[0].stateName=t.preferredState.siteName),t.preferredSuburb&&(r.candidates[0].suburbId=t.preferredSuburb.id,r.candidates[0].suburbName=t.preferredSuburb.siteName),n.debug("will submit phone booking = ",r),e.submitPhoneBooking(r,function(e){n.debug(" after submitPhoneBooking = ",e),s.resolve(e)},function(e){s.reject(e),n.error(" fail to submitPhoneBooking = ",e),a.error("Fail to submit the booking (err = "+e+")","Error")}),s.promise}}}]),angular.module("ocsApp.MakeTelehealthBooking").controller("MakeTelehealthBookingMainCtrl",["CompanyFactory","$cookieStore","$uibModal","$log","toastr","mysqlDate","MakeTelehealthBookingFactory","mySharedService",function(e,t,o,a,n,i,s,r){var l=this;a=a.getInstance("ocsApp.MakeTelehealthBooking.MakeTelehealthBookingMainCtrl"),a.debug("I am make telehealth booking controller."),this.user=e.getCurrentUser(),console.log(this.user),this.companyObject=null,this.newBooking={companyId:l.user.companyId,employerId:null,patientName:null,dob:null,address:null,postcode:null,state:null,suburb:null,facetime:null,skype:null,contactNumber:null,occupation:null,employer:null,supervisor:null,medicalState:null,emailForDoc:null,injuryCrush:!1,injuryFall:!1,injuryLaceration:!1,injuryOther:!1,injurySprain:!1,descriptionOfInjury:null,bodyPart:null,injuryDate:null,medicalHistory:null,allergies:null,serviceRequired:null,apptDate:null,preferredTime:null,consent:!1,bookingPerson:l.user.bookingPerson},this.subsidiary={},this.subsidiary2={},this.viewPackage="",this.form={},this.isSubmitted=!1,this.isSubmitingToTheServer=!1,this.isSubsidiary2=!1,this.isNoCandidate=!1,this.stateList=["WA","NSW","VIC","SA","TAS","NT","QLD"],this.bodyPartList=["Foot-L","Foot-R","Lower Leg-L","Lower Leg-R","Upper Leg-L","Upper Leg-R","Shoulder-L","Shoulder-R","Arm-L","Arm-R","Wrist-L","Wrist-R","Hand-L","Hand-R","Lower Back","Upper Back","Chest","Abdomen","Head"],this.serviceList=["1st Medical certificate","Progress Medical Certificate","Fitness for Duty","Referral"],this.dateStatus={},this.dateStatus.dobOpened=!1,this.dateStatus.apptDateOpened=!1,this.dateStatus.timeOpened=!1,this.dateStatus.injuryDateOpened=!1,this.format="dd/MM/yyyy",this.openDOB=function(e){l.dateStatus.dobOpened=!0},this.timechanged=function(){console.log("Time changed to: ",l.newBooking.preferredTime)},this.openApptDate=function(e){l.dateStatus.apptDateOpened=!0},this.openInjuryDate=function(e){l.dateStatus.injuryDateOpened=!0},this.isShowOtherInjyryDesc=!1,l.descriptionOfInjuryInvalid=!0,this.injuryDescChange=function(){l.newBooking.injuryOther||l.newBooking.injuryLaceration||l.newBooking.injuryCrush||l.newBooking.injurySprain||l.newBooking.injuryFall?l.descriptionOfInjuryInvalid=!1:l.descriptionOfInjuryInvalid=!0,l.newBooking.injuryOther?l.isShowOtherInjyryDesc=!0:l.isShowOtherInjyryDesc=!1};var d=t.get("user");e.getCompany(function(e){l.companyObject=e,a.debug("Make booking, get company info")}),this.getAllSubsidiaries=function(e){a.debug("getAllSubsidiaries.Loading subsidiaries......",l.companyObject.subsidiaries),e(l.companyObject.subsidiaries)},this.isAdminLogin=function(){return d.userType.indexOf("RediMed")>=0},this.newCompany=function(){var e=o.open({animation:!0,templateUrl:"modules/MakeTelehealthBooking/views/makeTelehealthBooking.NewCompany.html",controller:"NewTelehealthCompanyCtrl",controllerAs:"NewTelehealthCompanyCtrl",size:"md"});e.result.then(function(e){a.debug("newCompany = ",e),s.newSubsidiaryForRedimed(l.user.companyId,e).then(function(e){a.debug("created new company sucessfully = ",e),l.newBooking.employer=e,l.newBooking.email=e.resultEmail,l.companyObject.subsidiaries.push(e)})},function(){a.debug("Modal New company dismissed at: "+new Date)})},this.submitForm=function(){l.isSubmitted=!0,console.log(this.newBooking),l.form.$invalid?(n.error("Please enter all required fields of booking information","Error"),a.error("Please enter all required fields of booking information",l.form.$error)):(l.isSubmitingToTheServer=!0,s.submitBooking(l.newBooking,l.companyObject,d).then(function(e){l.isSubmitingToTheServer=!1,a.debug("Submit booking successfully",e),n.success("Successfully submitted"),n.success("The booking list will be updated shortly. Please wait !"),l.newBooking={companyId:l.user.companyId,employerId:null,patientName:null,dob:null,address:null,postcode:null,state:null,suburb:null,facetime:null,skype:null,contactNumber:null,occupation:null,employer:null,supervisor:null,medicalState:null,emailForDoc:null,injuryCrush:!1,injuryFall:!1,injuryLaceration:!1,injuryOther:!1,injurySprain:!1,descriptionOfInjury:null,bodyPart:null,injuryDate:null,medicalHistory:null,allergies:null,serviceRequired:null,apptDate:null,preferredTime:null,consent:!1,bookingPerson:l.user.bookingPerson},l.isSubmitted=!1},function(e){a.err("Fail to submit booking",e)}))},this.selectedSubsidiary=function(e){a.debug("selectedSubsidiary = ",e),l.newBooking.email=e.resultEmail},this.isShowSubsidiary2=function(){return this.isSubsidiary2}}]),angular.module("ocsApp.MakeTelehealthBooking").controller("NewTelehealthCompanyCtrl",["$uibModalInstance","$log",function(e,t){t=t.getInstance("ocsApp.MakeTelehealthBooking.NewTelehealthCompanyCtrl"),t.debug("NewCompanyCtrl is running...");var o=this;this.company={},this.companyObject=null,this.isSubmitted=!1,this.form={},this.ok=function(){o.isSubmitted=!0,t.debug("OK to exit modal valid=",o.form.$valid),t.debug("OK to exit modal invalid=",o.form.$invalid),t.debug("OK to exit modal error=",o.form.$error),o.form.$valid&&e.close(o.company)},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.MakeBooking").factory("MakeTelehealthBookingFactory",["TelehealthBookings","toastr","$q","CompanyFactory","mysqlDate","Companies","$log","mySharedService",function(e,t,o,a,n,i,s,r){return s=s.getInstance("ocsApp.MakeBooking.MakeBookingFactory"),{submitBooking:function(a,n,i){var r=o.defer(),l={bookingId:0,companyId:a.companyId,patientName:a.patientName,dob:moment(a.dob).format("YYYY-MM-DD"),address:a.address,postcode:a.postcode,state:a.state,suburb:a.suburb,facetime:a.facetime,skype:a.skype,contactNumber:a.contactNumber,occupation:a.occupation,employer:a.employer.companyName,employerId:a.employer.id,supervisor:a.supervisor,medicalState:a.medicalState,emailForDoc:a.email,injuryCrush:a.injuryCrush?1:0,injuryFall:a.injuryFall?1:0,injuryLaceration:a.injuryLaceration?1:0,injuryOther:a.injuryOther?1:0,injurySprain:a.injurySprain?1:0,descriptionOfInjury:a.descriptionOfInjury,bodyPart:a.bodyPart,injuryDate:moment(a.injuryDate).format("YYYY-MM-DD"),medicalHistory:a.medicalHistory,allergies:a.allergies,serviceRequired:a.serviceRequired,apptDate:moment(a.apptDate).format("YYYY-MM-DD")+" "+moment(a.preferredTime).format("HH:mm"),preferredTime:moment(a.preferredTime).format("HH:mm"),consent:a.consent?1:0,bookingPerson:a.bookingPerson,apptStatus:"Confirmed"};return s.debug("will submit the telehealth booking",l),e.create(l,function(e){s.debug("Submitted and data return",e),r.resolve("Created Booking")},function(e){s.error("Fail to Submit the booking",e),t.error("Fail to submit the booking, please contact Redimed to assit","Error"),r.reject("Created Booking")}),r.promise},newSubsidiaryForRedimed:function(e,t){s.debug(">>newSubsidiaryForRedimed");var a=o.defer();return t.id=0,t.fatherId=e,s.debug("Will add new company = ",t),i.create(t,function(e){s.debug("new company created",e),a.resolve(e)},function(e){s.error(" fail to create the new company Error = ",e)}),a.promise}}}]),angular.module("ocsApp.Navigator").controller("IdleAlertCtrl",["$uibModalInstance","$scope",function(e,t){}]),angular.module("ocsApp.Navigator").controller("NavigatorMainCtrl",["CompanyFactory","Accounts","$state","$cookieStore","$uibModal","Idle","Keepalive","$scope","$uibModalStack","mySharedService","$log","mySocket",function(e,t,o,a,n,i,s,r,l,d,c,u){c=c.getInstance("ocsApp.Navigator.NavigatorMainCtrl"),c.debug("I am navigator controller."),i.watch();var m=this;this.isRedimed=!1,this.isKaja=!1;var p=getLogo();console.log(p),"REDIMED"==p&&(this.isRedimed=!0),"KAJA"==p&&(this.isKaja=!0),this.user=e.getCurrentUser(),this.currentCompany=null,c.debug("user = ",this.user);var g=function(){m.currentCompany=e.getCurrentCompany()};g(),r.$on("handleBroadcast",function(){var e=d.message;c.debug("Received a message from ChangeCompanyCtrl = "+e),e.indexOf("Refresh navigator")>=0&&g()}),this.user.userType.indexOf("RediMed")>=0?(c.debug("I am admin"),o.go("navigator.bookings")):(c.debug("I am company"),1==m.user.istelehealthBooking?o.go("navigator.makeTelehealthBooking"):o.go("navigator.makeBooking")),r.$on("IdleStart",function(){c.debug("IdleStart");var e=n.open({animation:!0,templateUrl:"modules/Navigator/views/navigator.idleAlert.html",controller:"IdleAlertCtrl",size:"md"});e.result.then(function(e){},function(){c.debug("Modal Idle dismissed at: "+new Date)})}),r.$on("IdleEnd",function(){c.debug("IdleEnd"),l.dismissAll()}),r.$on("IdleTimeout",function(){c.debug("IdleTimeout"),l.dismissAll(),m.logout()}),this.isPackage=function(){return 1==m.user.isall||1==m.user.ispackage},this.isPosition=function(){return 1==m.user.isall||1==m.user.isposition},this.isSetting=function(){return 1==m.user.isall||1==m.user.issetting},this.isBookingList=function(){return 1==m.user.isall||1==m.user.isbooking},this.isMakeBooking=function(){return 1==m.user.isall||1==m.user.ismakebooking},this.isTelehealthBooking=function(){return 1==m.user.isall||1==m.user.istelehealthBooking},this.isReports=function(){return this.user.userType.indexOf("RediMed")>=0},this.logout=function(){c.debug("NavigatorMainCtrl.logout runs......"),t.logout(function(e,t){u.emit("logout"),d.prepForBroadcast("Logout successfully"),c.debug("Logout : ",e),c.debug("Logout : ",t),o.go("init")},function(e){c.error("Logout failed: ",e)})},this.myProfile=function(){var e=n.open({animation:!0,templateUrl:"modules/Settings/views/settings.NewAccount.html",controller:"NewAccountCtrl",controllerAs:"NewAccountCtrl",size:"lg",resolve:{account:function(){return m.user}}});e.result.then(function(e){},function(){c.debug("Modal profile dismissed at: "+new Date)})},this.changeCompany=function(){var e=n.open({animation:!0,templateUrl:"modules/Settings/views/settings.ChangeCompany.html",controller:"ChangeCompanyCtrl",controllerAs:"ChangeCompanyCtrl",size:"md",resolve:{account:function(){return m.user}}});e.result.then(function(e){},function(){c.debug("Modal profile dismissed at: "+new Date)})}}]),angular.module("ocsApp.Positions").controller("ConfirmToDeletePackageCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.Packages").controller("PackagesMainCtrl",["$uibModal","$scope","CompanyFactory","Packages","$log","mySharedService",function(e,t,o,a,n,i){n=n.getInstance("ocsApp.Packages.PackagesMainCtrl"),n.debug("I am package list controller.");var s=this;this.packages=[];var r=function(){o.getCompany(function(e){n.debug("Get company info"),s.packages=e.packages})};r(),t.$on("handleBroadcast",function(){var e=i.message;n.debug("Received a message from ChangeCompanyCtrl = "+e),e.indexOf("Refresh packages")>=0&&r()}),this.deletePackage=function(t){var i=e.open({animation:!0,templateUrl:"modules/Packages/views/packages.ConfirmToDeletePackage.html",controller:"ConfirmToDeletePackageCtrl",controllerAs:"ConfirmToDeletePackageCtrl",size:"md"});i.result.then(function(e){a.deleteById({id:t},function(e){console.log(e),o.refreshPackageList(function(e){console.log("Make booking, get company info = ",e),s.packages=e.packages})})},function(){n.debug("Modal delete package dismissed at: "+new Date)})},this.newOrEditPackage=function(t){var o=e.open({animation:!0,templateUrl:"modules/Packages/views/packages.NewPackage.html",controller:"NewPackageCtrl",controllerAs:"NewPackageCtrl",size:"lg",resolve:{"package":function(){return t}}});o.result.then(function(e){r()},function(){n.debug("Modal New or edit package dismissed at: "+new Date)})}}]),angular.module("ocsApp.Positions").controller("NewPackageCtrl",["Packages","$uibModalInstance","package","CompanyFactory","$log","toastr",function(e,t,o,a,n,i){n=n.getInstance("ocsApp.Positions.Packages"),n.debug("I am  new or edit position controller.",o);var s=this;if(this.form={},this.assessments=[],this.companyObject={},this.companyId=a.getCompanyId(),o){this.packageName=o.packageName;for(var r in o.AssessmentHeaders){var l=o.AssessmentHeaders[r];for(var d in l.Assessments)this.assessments.push(l.Assessments[d].assId)}}n.debug("Assessments = ",this.assessments),a.getCompany(function(e){s.companyObject=e}),this.ok=function(){if(s.isSubmitted=!0,s.form.$valid){var r={};r["package"]=o,r.assessments=s.assessments,r.packageName=s.packageName,r.companyId=s.companyId,n.debug("will insert/update upsertData = ",r),e.upsertPackage(r,function(e){n.debug("New/update package successfully ",e),i.success("Successfully submitted"),a.refreshPackageList(function(e){n.debug(">>>>>>Refesh packages after insert or edit",e.packages),t.close({})})},function(e){n.error("Fail to new/update package",e),i.error("Fail to save the package","Error")})}else n.error("Data error",s.form.$error),i.error("Please check the input data","Error")},this.cancel=function(){t.dismiss("cancel")}}]),angular.module("ocsApp.Positions").controller("ConfirmToDeletePositionCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.Positions").controller("PositionsMainCtrl",["$uibModal","$scope","CompanyFactory","Positions","$log","mySharedService",function(e,t,o,a,n,i){n=n.getInstance("ocsApp.Packages.PackagesMainCtrl"),n.debug("I am position list controller.");var s=this;this.positions=[],this.show=!1;var r=function(){o.getCompany(function(e){console.log("Make booking, get company info = ",e),s.positions=e.positions})};r(),t.$on("handleBroadcast",function(){var e=i.message;n.debug("Received a message from ChangeCompanyCtrl = "+e),e.indexOf("Refresh positions")>=0&&r()}),this.deletePosition=function(t){var i=e.open({animation:!0,templateUrl:"modules/Positions/views/positions.ConfirmToDeletePosition.html",controller:"ConfirmToDeletePositionCtrl",controllerAs:"ConfirmToDeletePositionCtrl",size:"md"});i.result.then(function(e){a.deleteById({id:t},function(e){console.log(e),o.refreshPositionList(function(e){console.log("Make booking, get company info = ",e),s.positions=e.positions})})},function(){n.info("Modal dismissed at: "+new Date)})},this.newOrEditPosition=function(t){var a=e.open({animation:!0,templateUrl:"modules/Positions/views/positions.NewPosition.html",controller:"NewPositionCtrl",controllerAs:"NewPositionCtrl",size:"md",resolve:{position:function(){return t}}});a.result.then(function(e){o.refreshPositionList(function(e){console.log("Make booking, get company info = ",e),s.positions=e.positions})},function(){n.info("Modal dismissed at: "+new Date)})}}]),angular.module("ocsApp.Positions").controller("NewPositionCtrl",["Positions","$uibModalInstance","position","CompanyFactory","$log","toastr",function(e,t,o,a,n,i){n=n.getInstance("ocsApp.Positions.NewPositionCtrl"),n.debug("I am  new or edit position controller.",o);var s=this;this.form={},this.companyId=a.getCompanyId(),o&&(this.positionName=o.positionName),this.ok=function(){if(s.isSubmitted=!0,s.form.$valid)if(o)n.debug("will update position",o),e.update({where:{id:o.id}},{positionName:s.positionName},function(e){n.debug("updated position",e),i.success("Position was updated successfully",""),t.close({})},function(e){n.error("Fail to update position",e),i.error("Fail to update Position","Error"),t.close({})});else{var a={};a.positionName=s.positionName,a.companyId=s.companyId,a.id=0,console.log(a),e.create(a,function(e){n.debug("created position",e),i.success("Position was created successfully",""),t.close({})},function(e){i.error("Fail to create Position","Error"),n.error("failt to create position",e)})}else n.error("Save postion err ",s.form.$error)},this.cancel=function(){t.dismiss("cancel")}}]),angular.module("ocsApp.Scheduler").controller("EditRosterCtrl",["$uibModalInstance","fromTime","toTime","isRemove",function(e,t,o,a){var n=this;this.dateStatus={},this.dateStatus.fromTimeOpened=!1,this.dateStatus.toTimeOpened=!1,this.format="dd/MM/yyyy HH:mm:ss",this.fromTime=new Date(t.format("YYYY-MM-DD HH:mm:ss")),this.toTime=new Date(o.format("YYYY-MM-DD HH:mm:ss")),this.title="Do you want to remove slots ?",this.header="Remove Slots",a||(this.title="Do you want to unremove slots ?",this.header="Unremove Slots"),this.openFromTime=function(e){n.dateStatus.fromTimeOpened=!0},this.openFromTime=function(e){n.dateStatus.toTimeOpened=!0},this.ok=function(){e.close({fromTime:n.fromTime,toTime:n.toTime})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.Scheduler").controller("SchedulerMainCtrl",["$uibModal","$scope","RedimedSiteFactory","CompanyFactory","BookingFactory","$log",function(e,t,o,a,n,i){i=i.getInstance("ocsApp.Packages.SchedulerMainCtrl"),i.debug("I am Scheduler controller.");var s=[],r=new Date,l=new Date,d=function(t,a){var n=e.open({animation:!1,backdrop:"static",windowTopClass:"modal1",templateUrl:"modules/Scheduler/views/scheduler.editRoster.html",controller:"EditRosterCtrl",controllerAs:"EditRosterCtrl",size:"lg",resolve:{fromTime:function(){return t.start},toTime:function(){return t.end},isRemove:function(){return a}}});n.result.then(function(e){i.debug("modal return value = ",e),i.debug("isRemove = ",a);var n=function(){$("#calendar").fullCalendar("refetchEvents")};a?o.removeSlots(t.resourceId,e.fromTime,e.toTime,n):o.unRemoveSlots(t.resourceId,e.fromTime,e.toTime,n)},function(e){})};r.setDate(r.getDate()-1),l.setDate(l.getDate()+7),a.getCompany(function(e){i.debug("Make booking, get company info"),s=e.packages}),o.getResources(1,r,l,function(e){$("#calendar").fullCalendar({defaultView:"agendaDay",defaultDate:moment(),editable:!1,selectable:!1,slotDuration:"00:15:00",minTime:"07:00:00",maxTime:"18:00:00",eventLimit:!0,header:{left:"prev,next today",center:"title"},views:{agendaTwoDay:{type:"agenda",duration:{days:2},groupByResource:!0}},resources:e.resources,events:function(e,t,a,n){console.log("start = ",e," - end =",t),o.getEvents(1,moment(e.format("DD/MM/YYYY"),"DD/MM/YYYY"),moment(t.format("DD/MM/YYYY"),"DD/MM/YYYY"),function(e){console.log("RedimedSiteFactory.getEvents = ",e.events),n(e.events)})},eventClick:function(e,t,o){console.log("You clicked on an event:",e),e.Candidate?n.viewBookingDetail(s,e.Candidate):"NoUse"==e.title?d(e,!1):d(e,!0)},select:function(e,t,o,a,n){console.log("select",e.format(),t.format(),n?n.id:"(no resource)");
},dayClick:function(e,t,o,a){console.log("dayClick",e.format(),a?a.id:"(no resource)")}})})}]),angular.module("ocsApp.Positions").controller("ConfirmToDeletePackageCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.Settings").controller("ChangeCompanyCtrl",["Accounts","$uibModalInstance","account","CompanyFactory","$cookieStore","$log","toastr","mySharedService",function(e,t,o,a,n,i,s,r){i=i.getInstance("ocsApp.Settings.NewAccountCtrl"),i.debug("I am  new or edit account controller.",o);var l=this;this.companies=[],this.user=a.getCurrentUser(),this.firstCompany=n.get("firstCompany"),this.companies.push({Companies:this.firstCompany}),n.get("companies").forEach(function(e){l.companies.push(e)}),this.currentCompany=a.getCurrentCompany(),this.companies.forEach(function(e){e.Companies.id==l.currentCompany.id?e.isCurrent=!0:e.isCurrent=!1}),this.selectCompany=function(t){i.debug("select company = ",t,"that.currentCompany = ",l.currentCompany),t.id!=l.currentCompany.id&&(l.currentCompany=t,a.setCurrentCompany(t),e.setCompany({companyId:t.id},function(e){console.log("data = ",e),l.companies.forEach(function(e){e.Companies.id==l.currentCompany.id?e.isCurrent=!0:e.isCurrent=!1}),a.init(function(e){r.prepForBroadcast("Refresh booking list successfully"),r.prepForBroadcast("Refresh make booking"),r.prepForBroadcast("Refresh packages"),r.prepForBroadcast("Refresh positions"),r.prepForBroadcast("Refresh settings"),r.prepForBroadcast("Refresh navigator")})},function(e){console.log("error = ",e)}))},this.cancel=function(){t.dismiss("cancel")}}]),angular.module("ocsApp.Settings").controller("SettingsMainCtrl",["$uibModal","$scope","CompanyFactory","Packages","$log","mySharedService",function(e,t,o,a,n,i){n=n.getInstance("ocsApp.Settings.SettingsMainCtrl"),n.debug("I am package list controller.");var s=this;this.accounts=[],this.companies=[];var r=function(){o.getCompany(function(e){s.accounts=e.accounts,s.companies=e.subsidiaries;for(var t in s.accounts)s.accounts[t].company&&(s.accounts[t].companyName=s.accounts[t].company.companyName)})};r(),t.$on("handleBroadcast",function(){var e=i.message;n.debug("Received a message from ChangeCompanyCtrl = "+e),e.indexOf("Refresh settings")>=0&&r()}),this.deletePackage=function(t){var i=e.open({animation:!0,templateUrl:"modules/Packages/views/packages.ConfirmToDeletePackage.html",controller:"ConfirmToDeletePackageCtrl",controllerAs:"ConfirmToDeletePackageCtrl",size:"md"});i.result.then(function(e){a.deleteById({id:t},function(e){console.log(e),o.refreshPackageList(function(e){console.log("Make booking, get company info = ",e),s.packages=e.packages})})},function(){n.info("Modal dismissed at: "+new Date)})},this.newOrEditPackage=function(t){var a=e.open({animation:!0,templateUrl:"modules/Settings/views/settings.NewAccount.html",controller:"NewAccountCtrl",controllerAs:"NewAccountCtrl",size:"lg",resolve:{account:function(){return t}}});a.result.then(function(e){o.refreshAccountList(function(e){console.log(">>>>>>Refesh packages after insert or edit= ",e),s.accounts=e.accounts})},function(){n.info("Modal dismissed at: "+new Date)})}}]),angular.module("ocsApp.Settings").controller("NewAccountCtrl",["Accounts","$uibModalInstance","account","CompanyFactory","$cookieStore","$log","toastr",function(e,t,o,a,n,i,s){i=i.getInstance("ocsApp.Settings.NewAccountCtrl"),i.debug("I am  new or edit account controller.",o);var r=this;this.user=a.getCurrentUser(),this.isSubmitted=!1,this.form={},this.companyObject={},this.companyId=a.getCompanyId(),this.accountObj={},this.companies=[],i.debug("current user = ",this.user),a.getCompany(function(e){console.log("New Account, get company info = ",e),r.companies=e.subsidiaries}),this.isAdmin=function(){return!o&&r.user.userType.indexOf("RediMed")>=0},o?this.accountObj=o:(this.accountObj.isproject=0,this.accountObj.iscalendar=0,this.accountObj.isall=0,this.accountObj.isenable=0,this.accountObj.ismakebooking=0,this.accountObj.isbooking=0,this.accountObj.ispackage=0,this.accountObj.isposition=0,this.accountObj.issetting=0,this.accountObj.isallcompanydata=0),a.getCompany(function(e){r.companyObject=e}),this.isOpenCheckBoxControl=function(){return 1==r.user.isall||1==r.user.issetting},this.isPassRequire=function(){return null==o},this.emailChanged=function(e){r.accountObj.invoiceemail=e,r.accountObj.resultEmail=e},this.ok=function(){r.isSubmitted=!0,r.form.$valid?o?(""==r.accountObj.password&&delete r.accountObj.password,i.debug("will update this",r.accountObj),e.updateAccount(r.accountObj,function(e){console.log("updated account",e),t.close({})},function(e){i.error("Fail to update an account",e),s.error("Fail to update an account ! Err:"+e.data.error.message)})):(r.accountObj.id=-1,r.accountObj.companyId||(r.accountObj.companyId=r.companyId),r.accountObj.userType="Company",i.debug("will add this",r.accountObj),e.updateAccount(r.accountObj,function(e){console.log("After new acc = ",e),t.close({})},function(e){i.error("Fail to create an new account",e),s.error("Fail to create an new account ! Err:"+e.data.error.message)})):i.debug("there is error in UI",r.form.$error)},this.cancel=function(){t.dismiss("cancel")}}]),angular.module("ocsApp.Companies").controller("ConfirmToDeleteCompanyCtrl",["$uibModalInstance","row",function(e,t){this.formDefines={div1:{type:"div",fieldClass:"modal-header",fields:{h3:{type:"h3",fieldClass:"modal-title",label:"Delete Company",controllerAs:"ConfirmToDeleteCompanyCtrl"}}},div2:{type:"div",fieldClass:"modal-body",fields:{h3:{type:"h3",fieldClass:"modal-title",label:"Do you want to delete company ?"}}},div3:{type:"div",fieldClass:"modal-footer",fields:{btn1:{type:"button",fieldClass:"btn btn-primary",ngClick:"ok()",label:"Save"},btn2:{type:"button",fieldClass:"btn btn-warning",ngClick:"cancel()",label:"Cancel"}}}},this.ok=function(){e.close(t)},this.cancel=function(){e.dismiss(t)}}]),angular.module("ocsApp.Sites").controller("SitesMainCtrl",["$uibModal","$log","DetailModal","DeleteModal","$state","SiteModuleFactory","$scope",function(e,t,o,a,n,i,s){TableBaseCtrl.call(this,s,t,i,a,"SitesMainCtrl");this.isSubmitted=!1,this.form={},this.company={},this.setDeleteTemplateUrl('<my-dynamic-form formdefine = "{{ConfirmToDeleteCompanyCtrl.formDefines}}" ></my-dynamic-form>'),this.setDeleteController("ConfirmToDeleteCompanyCtrl"),this.setDeleteWindowSize("md"),this.setCloseDeleteModal(function(e){CompanyModuleFactory.deleteCompany(e)}),this.detail=function(e){console.log(" prepare to go to detail with rowData",e),e?n.go("navigator.sites.detail",{row:e.id}):n.go("navigator.sites.detail",{row:null})}}]),angular.module("ocsApp.Sites").controller("NewCalendarCtrl",["Calendar","row","$log","toastr","SiteModuleFactory","$uibModalInstance","DetailModal","DeleteModal","toastr",function(e,t,o,a,n,i,s,r,a){DetailWithTableBaseCtrl.call(this,i,t,o,a,s,r,"NewSubCompanyCtrl");var l=this;this.row.defaultStatusObject={},this.bookingStatus=[];t.Calendars;t?this.windowTitle="Update Sub Company":this.windowTitle="New Sub Company",o.debug("modalTitle = ",this.windowTitle),this.saveRow=function(){if(t){o.debug("will update calendar",t.available);var n=0;n=t.available&&t.available.length>0?Number(t.available.substr(1,2)):0,e.findById({id:t.calId},function(s){var r=s.available,d=Number(l.row.newAvailable),c=r-n,u=Number(d)+Number(c);o.debug("will update calendar",s,"currentAvailable = "+n+" newSlot = "+u),e.update({where:{calId:t.calId}},{available:u},function(e){o.debug("updated calendar successfully",e),o.save(),a.success("update calendar successfully"),i.close({})},function(e){o.error("fail to update calendar",e),a.error("Fail to update calendar, Please contact Phuong","Error")})})}},this.cancel=function(){i.dismiss("cancel")},this.formDefines={div1:{type:"div",fieldClass:"modal-header",controllerAs:"NewCalendarCtrl",isSubmitedVar:"isSubmitted",fields:{h3:{type:"h3",label:"{{NewSubCompanyCtrl.windowTitle}}",fieldClass:"modal-title"}}},div2:{type:"div",fieldClass:"modal-body",fields:{form:{type:"form",name:"form",fieldClass:"form-horizontal form-row-seperated",fields:{fromTime:{field:"fromTime",ngModel:"row.fromTime",label:"Appointment Time",width:"100",isList:!0,isNew:!0,isReadOnly:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},available:{field:"available",ngModel:"row.available",label:"Available",width:"100",isList:!0,isNew:!0,isReadOnly:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},newAvailable:{field:"newAvailable",ngModel:"row.newAvailable",label:"New Available",placeholder:"New Available",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"}}}}},div3:{type:"div",fieldClass:"modal-footer",fields:{SaveButton:{type:"button",label:"Save",fieldClass:"btn btn-primary",ngClick:"ok()"},CancelButton:{type:"button",label:"Cancel",fieldClass:"btn btn-warning",ngClick:"cancel()"}}}},console.log(this.formDefines)}]),angular.module("ocsApp.Sites").controller("NewSiteCtrl",["$state","$stateParams","Companies","$log","toastr","BookingStatusFactory","DetailModal2","DeleteModal","SiteModuleFactory","mysqlDate",function(e,t,o,a,n,i,s,r,l,d){var c=parseInt(t.row),u=l.getMasterRow(c),m=this,p=u.AdminCalendars;DetailWithTableBaseCtrl.call(this,l,u,a,n,s,r,"NewCompanyCtrl"),this.row.defaultStatusObject={},this.bookingStatus=[],this.setDetailTemplateUrl('<my-dynamic-form formdefine = "{{NewCalendarCtrl.formDefines}}" ></my-dynamic-form>'),this.setDetailController("NewCalendarCtrl"),this.setDetailWindowSize("lg"),this.setCloseDetailModal(function(){l.getCalendars(u.id,function(e){m.row.AdminCalendars=e[0].AdminCalendars})}),this.cancel=function(){e.go("navigator.companies.list")},u?(this.windowTitle="Update Company",l.getCalendars(u.id,function(e){m.row.AdminCalendars=e[0].AdminCalendars})):this.windowTitle="New Company",this.saveDetail=function(){console.log(u.Calendars)},this.filterDetail=function(e,t){var o=[];if(p)for(var a=0;a<p.length;a++){var n=d(p[a].fromTime);e&&t&&n>=e&&n<=t&&o.push(p[a])}u.AdminCalendars=o,console.log(u.AdminCalendars)},a.debug("modalTitle = ",this.windowTitle)}]),angular.module("ocsApp.Sites").factory("SiteModuleFactory",["Redimedsites","$log","toastr","$rootScope","$state",function(e,t,o,a,n){t=t.getInstance("ocsApp.Sites.SiteModuleFactory");var i=null,s="",r=function(t){e.find(function(e){console.log("Get company from server",e),i=e,t(i)})};return{getCalendars:function(t,o){e.find({filter:{where:{id:t},include:{relation:"AdminCalendars",scope:{limit:1e3}}}},function(e){console.log("Get calendar from server for siteId = "+t,e),o(e)})},getMasterRows:function(e){i?(console.log("Get company from memory",i),e(i)):r(e)},refreshMasterRows:function(e){r(e)},getMasterRow:function(e){if(t.debug("Get master row with id = ",e),console.log("Get master rows  = ",i),i){var o=i[_.findIndex(i,"id",e)];return o}return{}},deleteMasterRow:function(a){var n=this;t.debug("This is a custom closeDeleteModal function",a),e.deleteById({id:a.id},function(e){console.log(e),t.debug("Successfully delete company",e),n.refreshMasterRows(function(e){n.masterDetailBroadcast("Delete Master Successfully")})},function(e){t.error("Fail to delete company",e),o.error("Fail to delete the company. "+e.data.error.message,"error")})},masterDetailBroadcast:function(e){s=e,a.$broadcast("MasterDetailBroadcast")},getMessage:function(){return s},saveMaster:function(a){var i=this;a.id?(t.debug("will update company",a),a.defaultStatusObject&&(a.defaultStatus=a.defaultStatusObject.bookingStatus),e.update({where:{id:a.id}},a,function(e){t.debug("updated company",e),o.success("Company was updated successfully",""),n.go("navigator.companies.list"),i.refreshMasterRows(function(e){i.masterDetailBroadcast("Update Master Successfully")})},function(e){t.error("Fail to update position",e),o.error("Fail to update Position "+e.data.error.message,"Error")})):(a.defaultStatusObject&&(a.defaultStatus=a.defaultStatusObject.bookingStatus),a.id=0,t.debug("will create new company",a),e.create(a,function(e){t.debug("created company",e),o.success("Company was created successfully",""),n.go("navigator.companies.list"),i.refreshMasterRows(function(e){i.masterDetailBroadcast("Insert Master Successfully")})},function(e){o.error("Fail to create Position","Error"),o.error("Fail to create Position "+e.data.error.message,"Error")}))}}}]),angular.module("ocsApp.TelehealthBookings").controller("TelehealthBookingsMainCtrl",["uiGridConstants","$scope","$window","CompanyFactory","$uibModal","$cookieStore","$log","mysqlDate","mySharedService","Packages","$q",function(e,t,o,a,n,i,s,r,l,d,c){s=s.getInstance("ocsApp.TelehealthBookings.TelehealthBookingsMainCtrl"),s.debug("I am telehealth booking list controller.");var u=this;this.window=o;var m=[];this.loading=!1,this.user=a.getCurrentUser();var p=[{field:"employer",displayName:"Employer Name",width:"150"},{field:"patientName",displayName:"Patient Name",width:"200"},{field:"dob",displayName:"DOB",width:"100",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy'"},{field:"apptDate",displayName:"Appointment Date",width:"150",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy'"},{field:"preferredTime",displayName:"Preferred Time",width:"100"},{field:"address",displayName:"Address",width:"100"},{field:"suburb",displayName:"Suburb",width:"100"},{field:"state",displayName:"State",width:"100"},{field:"facetime",displayName:"Facetime",width:"100"},{field:"skype",displayName:"Skype",width:"100"},{field:"contactNumber",displayName:"Contact Number",width:"100"},{field:"bookingPerson",displayName:"Booking Person",width:"150"},{field:"creationDate",displayName:"Creation Date",width:"200",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm'"},{field:"createdBy",displayName:"By",width:"50"},{field:"linkId",displayName:"Link ID",width:"50"}];this.isAdmin=function(){return this.user.userType.indexOf("RediMed")>=0},this.gridOptions={enableSorting:!0,enableColumnResizing:!0,enableFiltering:!0,appScopeProvider:this,columnDefs:p,onRegisterApi:function(e){t.gridApi=e,t.gridApi.core.on.sortChanged(t,function(e,t){})},enableGridMenu:!0,enableRowSelection:!1,enableSelectAll:!1,exporterMenuPdf:!1,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location"))},t.$on("handleBroadcast",function(){var e=l.message;s.debug("Received a message from AdminEditBookingCtrl = "+e),e.indexOf("Refresh booking list successfully")>=0&&a.getCompany(function(e){s.debug("Refresh bookings, get company info"),toastr.success("The booking list has been refreshed !"),u.gridOptions.data=e.telehealthBookings})}),this.refreshBooking=function(){s.debug("will refresh booking ; get data from DB......"),u.loading=!0,a.refreshTelehealthBookingList(function(e){s.debug("refreshed booking ; get data from DB......"),u.gridOptions.data=e.telehealthBookings,u.loading=!1})},a.getCompany(function(e){s.debug("Make booking, get company info"),u.gridOptions.data=e.telehealthBookings,u.loading=!1,m=e.packages})}]);