function DetailWithTableBaseCtrl(e,t,a,o,n,i,s){a=a.getInstance(s),a.debug("I am  new or edit position controller.",t);var r=this;this.form={},this.row={},this.windowTitle="This is 'this.windowTitle' variable, Please set for the widow title",t&&(this.row=t),this.isSubmitted=!1,this.formDefines={},this.tableDefines={},this.closeModalAfterSave=function(){},this.setHeader=function(e){r.currentColumnName=e,r.currentSortReverse=!r.currentSortReverse},this.isUp=function(e){return r.currentColumnName==e&&r.currentSortReverse},this.isDown=function(e){return r.currentColumnName==e&&!r.currentSortReverse},this.setDetailTemplateUrl=function(e){n.setTemplateUrl(e)},this.setDetailController=function(e){n.setControllerName(e)},this.setDetailWindowSize=function(e){n.setSize(e)},this.setCloseDetailModal=function(e){n.setCloseModalFunc(e)},this.setDismissDetailModal=function(e){n.setDismissModalFunc(e)},this.setDetailWindowTitle=function(e,t){n.setResolve(e,t)},this.setDeleteTemplateUrl=function(e){i.setTemplateUrl(e)},this.setDeleteController=function(e){i.setControllerName(e)},this.setDeleteWindowSize=function(e){i.setSize(e)},this.setCloseDeleteModal=function(e){i.setCloseModalFunc(e)},this.setDismissDeleteModal=function(e){i.setDismissModalFunc(e)},this.newOrEditRow=n.newOrEditRow,this.deleteRow=i.deleteRow,this.saveRow=function(){a.debug("This is  'this.saveRow()' function, Please override ! Remember to close modal by 'this.closeModalAfterSave()'"),e.saveMaster(r.row),r.closeModalAfterSave()},this.ok=function(){r.isSubmitted=!0,r.form.$valid?r.saveRow():(o.error("Please re-check all their fields again !","error"),a.error("Save postion err ",r.form.$error))},this.cancel=function(){}}function TableBaseCtrl(e,t,a,o,n){t=t.getInstance(n),t.debug("controller is running....");var i=this;this.selectedRow={},this.detailResolve={},this.currentColumnName="",this.currentSortReverse=!1,this.rows=[],this.getDataFromService=function(){a.getMasterRows(function(e){i.rows=e})},this.getDataFromService(),e.$on("MasterDetailBroadcast",function(){var e=a.getMessage();t.debug("Received a message from detail = "+e),(e.indexOf("Insert Master Successfully")>=0||e.indexOf("Update Master Successfully")>=0||e.indexOf("Delete Master Successfully")>=0)&&i.getDataFromService()}),this.detailResolve.row=function(){return t.debug("Please override 'detailResolve.row' object to process the resolve data for the detail modal"),i.selectedRow},this.setHeader=function(e){i.currentColumnName=e,i.currentSortReverse=!i.currentSortReverse},this.isUp=function(e){return i.currentColumnName==e&&i.currentSortReverse},this.isDown=function(e){return i.currentColumnName==e&&!i.currentSortReverse},this.setDeleteTemplateUrl=function(e){o.setTemplateUrl(e)},this.setDeleteController=function(e){o.setControllerName(e)},this.setDeleteWindowSize=function(e){o.setSize(e)},this.setCloseDeleteModal=function(e){o.setCloseModalFunc(e)},this.setDismissDeleteModal=function(e){o.setDismissModalFunc(e)},this.deleteRow=o.deleteRow}angular.module("TableBaseController",[]).controller("tableBaseController",["$uibModal","$log",TableBaseCtrl]),angular.module("DynamicForm",["toastr"]).directive("myDynamicForm",["$q","$parse","$compile","$document",function(e,t,a,o){return{restrict:"E",terminal:!0,link:function(n,i,s){var r=s.formdefine;r=r.replace(/\u00a0/g," ");var l={div:{element:"div"},h1:{element:"h1"},h2:{element:"h2"},h3:{element:"h3"},span:{element:"span"},form:{element:"form",editable:!1,textBased:!1},table:{element:"table",editable:!1,textBased:!1},text:{element:"input",type:"text",editable:!0,textBased:!0},date:{element:"input",type:"date",editable:!0,textBased:!0},datetime:{element:"input",type:"datetime",editable:!0,textBased:!0},"datetime-local":{element:"input",type:"datetime-local",editable:!0,textBased:!0},email:{element:"input",type:"email",editable:!0,textBased:!0},month:{element:"input",type:"month",editable:!0,textBased:!0},number:{element:"input",type:"number",editable:!0,textBased:!0},password:{element:"input",type:"password",editable:!0,textBased:!0},search:{element:"input",type:"search",editable:!0,textBased:!0},tel:{element:"input",type:"tel",editable:!0,textBased:!0},textarea:{element:"textarea",editable:!0,textBased:!0},time:{element:"input",type:"time",editable:!0,textBased:!0},url:{element:"input",type:"url",editable:!0,textBased:!0},week:{element:"input",type:"week",editable:!0,textBased:!0},checkbox:{element:"input",type:"checkbox",editable:!0,textBased:!1},color:{element:"input",type:"color",editable:!0,textBased:!1},file:{element:"input",type:"file",editable:!0,textBased:!1},range:{element:"input",type:"range",editable:!0,textBased:!1},select:{element:"select",editable:!0,textBased:!1},checklist:{element:"div",editable:!1,textBased:!1},horizontalFieldGroup:{element:"div",editable:!1,textBased:!1},radio:{element:"div",editable:!1,textBased:!1},button:{element:"button",type:"button",editable:!1,textBased:!1},hidden:{element:"input",type:"hidden",editable:!1,textBased:!1},image:{element:"input",type:"image",editable:!1,textBased:!1},legend:{element:"legend",editable:!1,textBased:!1},reset:{element:"button",type:"reset",editable:!1,textBased:!1},submit:{element:"button",type:"submit",editable:!1,textBased:!1}};e.when(t(r)(n)).then(function(e){var t={},s="",r="",d="",c=function(e,a){var n=angular.element(o[0].createElement(l[e.type].element));if(e.controllerAs&&(s=e.controllerAs+"."),e.isSubmitedVar&&(d=e.controllerAs+"."+e.isSubmitedVar),angular.isDefined(l[e.type].type)&&n.attr("type",l[e.type].type),angular.isDefined(l[e.type].editable)&&l[e.type].editable&&(e.field&&n.attr("name",e.field),e.ngModel&&(e.isAttachControllerAs&&0==e.isAttachControllerAs?n.attr("ng-model",e.ngModel):n.attr("ng-model",s+e.ngModel)),e.isRequire&&n.attr("ng-required",e.isRequire),angular.isDefined(e.readonly)&&n.attr("ng-readonly",e.readonly),angular.isDefined(e.val)&&n.attr("value",e.val)),angular.isDefined(l[e.type].textBased)&&l[e.type].textBased&&(angular.isDefined(e.minLength)&&n.attr("ng-minlength",e.minLength),angular.isDefined(e.maxLength)&&n.attr("ng-maxlength",e.maxLength),angular.isDefined(e.validate)&&n.attr("ng-pattern",e.validate),e.placeholder&&e.placeholder.length>0&&n.attr("placeholder",e.placeholder),e.isReadOnly&&n.attr("ng-readonly",e.isReadOnly)),e.name&&(r=e.name,n.attr("name",s+e.name)),e.fieldClass&&n.addClass(e.fieldClass),e.type.indexOf("form")>=0&&n.attr("action","#"),e.ngClick&&["button","legend","reset","submit"].indexOf(e.type)>-1&&n.attr("ng-click",s+e.ngClick),e.ngShow&&n.attr("ng-show",e.ngShow),e.uiView&&n.attr("ui-view",e.uiView),"checkbox"===e.type?(angular.isDefined(e.isOn)&&n.attr("ng-true-value",e.isOn),angular.isDefined(e.isOff)&&n.attr("ng-false-value",e.isOff),angular.isDefined(e.slaveTo)&&n.attr("ng-checked",e.slaveTo)):"select"===e.type&&(angular.isDefined(e.multiple)&&e.multiple!==!1&&n.attr("multiple","multiple"),angular.isDefined(e.empty)&&e.empty!==!1&&n.append(angular.element(o[0].createElement("option")).attr("value","").html(e.empty)),angular.isDefined(e.ngOptions)?n.attr("ng-options",e.ngOptions):angular.isDefined(e.options)&&(angular.forEach(e.options,function(e,a){newChild=angular.element(o[0].createElement("option")),newChild.attr("value",a),angular.isDefined(e.disabled)&&newChild.attr("ng-disabled",e.disabled),angular.isDefined(e.slaveTo)&&newChild.attr("ng-selected",e.slaveTo),angular.isDefined(e.label)&&newChild.html(e.label),angular.isDefined(e.group)?(angular.isDefined(t[e.group])||(t[e.group]=angular.element(o[0].createElement("optgroup")),t[e.group].attr("label",e.group)),t[e.group].append(newChild)):n.append(newChild)}),angular.equals(t,{})||(angular.forEach(t,function(e){n.append(e)}),t={}))),angular.isDefined(e.label))if(["button","legend","reset","submit","h1","h2","h3","span"].indexOf(e.type)>-1)n.html(e.label),this.append(n);else{var i=angular.element("<div></div>");e.formGroupClass&&i.attr("class",e.formGroupClass);var u=angular.element("<label>"+e.label+":</label>");e.labelClass&&u.attr("class",e.labelClass);var m=angular.element("<div></div>");e.fieldGroupClass&&m.attr("class",e.fieldGroupClass),m.append(n),e.isRequire&&(u.append(angular.element('<span class="required"> * </span>')),e.requiredHelpBlock&&m.append(angular.element('<span for="'+e.field+'" class="help-block" ng-show=" '+d+" && "+s+r+"."+e.field+'.$error.required">'+e.requiredHelpBlock+"</span>")),i.attr("ng-class","{'has-error' : "+d+" && "+s+r+"."+e.field+".$invalid}")),e.type.indexOf("email")>-1&&e.emailHelpBlock&&m.append(angular.element('<span for="'+e.field+'" class="help-block" ng-show=" '+d+" && "+s+r+"."+e.field+'.$error.email">'+e.emailHelpBlock+"</span>")),i.append(u),i.append(m),this.append(i)}else this.append(n);if(e.fields)if(e.type.indexOf("table")>-1){var p=angular.element("<thead></thead>"),f=angular.element("<tbody></tbody>"),g=angular.element("<tr></tr>"),h=angular.element("<tr></tr>"),y=angular.element("<tr></tr>"),b="",k="",C=(angular.element("<p> "+s+e.dataSource+"= {{controllerAs + field.dataSource}}</p>"),null);e.ngClick&&(C=s+e.ngClick),angular.forEach(e.fields,function(t,a){var o=angular.element("<th></th>"),n=angular.element("<td></td>");if(t.type){console.log("value = ",t);var i={};i.element=t,angular.forEach(i,c,n)}else{var r="";t.filter&&(r=t.filter),n.html("{{row."+t.field+r+"}}")}if(e.isSearch&&!t.type)if(t.rangeFilter){console.log("range filter");var l=angular.element("<td></td>");angular.forEach(t.rangeFilter.template,c,l),l.append(d),h.append(l),k+=t.rangeFilter.filter}else{console.log(" filter");var l=angular.element("<td></td>"),d=angular.element('<input type="text" class="form-control" ng-model="'+s+"search."+t.field+'"></input>');l.append(d),h.append(l),b=b.length>0?b+","+t.field+":"+s+"search."+t.field:t.field+":"+s+"search."+t.field,console.log(" filter = "+b)}else{var l=angular.element("<td></td>");h.append(l)}if(e.isSort&&!t.type){var u=s+"setHeader('"+t.field+"')",m=angular.element('<a ng-click="'+u+'">'+t.displayName+"</a>"),p=s+"isDown('"+t.field+"')",f=angular.element("<span></span>");f.attr("ng-show",p),f.addClass("fa fa-caret-down"),p=s+"isUp('"+t.field+"')";var v=angular.element("<span></span>");v.attr("ng-show",p),v.addClass("fa fa-caret-up"),m.append(f),m.append(v),o.append(m)}else o.html(t.displayName);C&&!t.type&&n.attr("ng-click",C),g.append(o),y.append(n)}),e.dataSource&&y.attr("ng-repeat","row in "+s+e.dataSource+"|orderBy:"+s+"currentColumnName:"+s+"currentSortReverse|filter:{"+b+"}"),p.append(g),e.isSearch&&p.append(h),f.append(y),n.append(p),n.append(f)}else angular.forEach(e.fields,c,n)},u=angular.element("<div></div>");angular.forEach(e,c,u),a(u)(n),i.replaceWith(u)})}}}]);var module=angular.module("$dynamicState",[]).provider("$dynamicState",function(e){this.$get=function(t){return{addState:function(a,o,n,i,s){var r={};i.indexOf(".html")>0?r[s]={templateUrl:i,controller:n,controllerAs:n}:r[s]={template:i,controller:n,controllerAs:n};var l=t.get(),d=_.findIndex(l,"name",a);console.log("states = ",l,d),d==-1&&(s?e.state(a,{url:"/"+o,"abstract":!1,sticky:!0,views:r}):i.indexOf(".html")>0?e.state(a,{url:"/"+o,"abstract":!1,sticky:!0,templateUrl:i,controller:n,controllerAs:n}):e.state(a,{url:"/"+o,"abstract":!1,sticky:!0,template:i,controller:n,controllerAs:n}))}}}}),module=angular.module("$logServices",["helper"]);module.config(["$provide",function(e){var t=function(e,t){function a(e,t){return"undefined"==typeof t&&(t=!1),t&&(e<10?e="00"+e:e<100&&(e="0"+e)),e.toString().length<2?"0"+e:e}return t=t||"%Y/%M/%d %h:%m:%s.%z",t.replace(/%([a-zA-Z])/g,function(t,o){switch(o){case"Y":return e.getFullYear();case"M":return a(e.getMonth()+1);case"d":return a(e.getDate());case"h":return a(e.getHours());case"m":return a(e.getMinutes());case"s":return a(e.getSeconds());case"z":return a(e.getMilliseconds(),!0);default:throw new Error("Unsupported format code: "+o)}})},a=function(e,t,a){return a=a||/\{([^\{\}]*)\}/g,e.replace(a,function(e,a){var o=a.split("."),n=t;try{for(var i in o)n=n[o[i]]}catch(s){n=e}return"string"==typeof n||"number"==typeof n?n:e})};e.decorator("$log",["$delegate","$window","LocationOfClientFactory","apiServerUrl",function(e,o,n,i){var s=[],r=["debug","info","warn","error"],l={},d="",c={};n.getLocation(function(e){c=e}),_.each(r,function(a){var o=e[a];e[a]=_.wrap(o,function(a){var o=Array.prototype.slice.call(arguments,1);a.apply(e,o);var n={userid:l.id,logtime:t(new Date),content1:o[0],browser:c.browser,country:c.country,fingerprint:c.fingerprint,ip:c.ip,loc:c.loc,region:c.region};o.length>1&&(n.content2=CircularJSON.stringify(o[1])),s.push(n),s.length>10&&u()})});var u=function(){var e=s;s=[],$.post(i+"/AngularLogs/insertLogs?access_token="+d,{logs:e}).then(function(e){},function(e){})},m=function(){var e=o.navigator.userAgent,t={chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie:/internet explorer/i};for(var a in t)if(t[a].test(e))return a;return"unknown"};colorify=function(e,t){var a="chrome"==m()||"phantomjs"==m(),o=a&&void 0!==t;return o?["%c"+e,t]:[e]};var p=function(e,o,n,i){var s=function(){try{var i=Array.prototype.slice.call(arguments),s=t(new Date);i[0]=a("{0} - {1}{2}",[s,n,i[0]]),e.apply(null,i),o.indexOf("error")>=0&&u()}catch(r){console.log("LogEnhancer ERROR: "+r)}};return s.logs=[],s},f=function(t,a,o){var n="::";t=void 0!==t?t+(o||n):"",e.setUser=function(e){l=e},e.setAccessToken=function(e){d=e},e.save=u;var i={log:p(e.log,"log",t,a),info:p(e.info,"info",t,a),warn:p(e.warn,"warn",t,a),debug:p(e.debug,"debug",t,a),error:p(e.error,"error",t),setAccessToken:e.setAccessToken,setUser:e.setUser,save:e.save};return i};return e.getInstance=f,e.setUser=function(e){l=e},e.save=u,e}])}]);var getPort=function(){return console.log("Current length port is : "+(window.location.port.length+"")),0==window.location.port.length?(console.log("api port = 443"),443):(console.log("api port = 2000"),8181)};angular.module("helper",[]).factory("apiServerUrl",function(){return"https://medicalbookings.redimed.com.au:"+getPort()+"/api"}).factory("serverUrl",function(){return"https://medicalbookings.redimed.com.au:"+getPort()}).service("fingerPrint",function(){return function(){var e=(new Fingerprint).get();return e}}).service("browser",["$window",function(e){var t=e.navigator.userAgent,a="unknow";console.log("userAgent = ",t);var o={edge:/Edge/i,chrome:/chrome/i,safari:/safari/i,firefox:/firefox/i,ie11:/Trident/i,ie10:/MSIE 10/i,ie9:/MSIE 9/i,ie8:/MSIE 8/i,ie7:/MSIE 7/i,ie6:/MSIE 6/i};for(var n in o)if(o[n].test(t)){a=n;break}return function(){return console.log("browser = ",a),a}}]).factory("LocationOfClientFactory",["browser","fingerPrint","$window",function(e,t,a){var o;return{getLocation:function(n){o?(o.errortime=moment().format("YYYY/MM/DD h:mm:ss a"),n(o)):$.get("https://api.ipify.org/?format=json").success(function(i){o={},o.ip=i.ip,o.browser=e(),o.fingerprint=t(),o.errorurl=a.location.href,o.errortime=moment().format("YYYY/MM/DD h:mm:ss a"),n(o)})}}}]).filter("dateFilter",function(){return function(e){if(e){var t=e.split(/[- : T .]/),a=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]);return a}return""}}).factory("mysqlDate",function(){return function(e){if(e){var t=e.split(/[- : T .]/);if(t.length>=6){var a=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]);return a}var a=new Date(t[0],t[1]-1,t[2]);return a}return""}}).factory("storeToken",function(){var e="";return{setAccessToken:function(t){e=t},getAccessToken:function(){return e}}}),function(e,t,a){"use strict";var o=function(){return console.log("Current length port is : "+(e.location.port.length+"")),0==e.location.port.length?(console.log("api port = 443"),443):(console.log("api port = 2000"),2e3)},n="https://medicalbookings.redimed.com.au:"+o()+"/api",i="authorization",s=t.module("lbServices",["ngResource"]);s.factory("User",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/Users/:id",{id:"@id"},{prototype$__findById__accessTokens:{params:{fk:"@fk"},url:n+"/Users/:id/accessTokens/:fk",method:"GET"},prototype$__destroyById__accessTokens:{params:{fk:"@fk"},url:n+"/Users/:id/accessTokens/:fk",method:"DELETE"},prototype$__updateById__accessTokens:{params:{fk:"@fk"},url:n+"/Users/:id/accessTokens/:fk",method:"PUT"},prototype$__get__accessTokens:{isArray:!0,url:n+"/Users/:id/accessTokens",method:"GET"},prototype$__create__accessTokens:{url:n+"/Users/:id/accessTokens",method:"POST"},prototype$__delete__accessTokens:{url:n+"/Users/:id/accessTokens",method:"DELETE"},prototype$__count__accessTokens:{url:n+"/Users/:id/accessTokens/count",method:"GET"},create:{url:n+"/Users",method:"POST"},createMany:{isArray:!0,url:n+"/Users",method:"POST"},upsert:{url:n+"/Users",method:"PUT"},exists:{url:n+"/Users/:id/exists",method:"GET"},findById:{url:n+"/Users/:id",method:"GET"},find:{isArray:!0,url:n+"/Users",method:"GET"},findOne:{url:n+"/Users/findOne",method:"GET"},updateAll:{url:n+"/Users/update",method:"POST"},deleteById:{url:n+"/Users/:id",method:"DELETE"},count:{url:n+"/Users/count",method:"GET"},prototype$updateAttributes:{url:n+"/Users/:id",method:"PUT"},createChangeStream:{url:n+"/Users/change-stream",method:"POST"},login:{params:{include:[{relation:"user",scope:{include:["AccountCompanies"]}}]},interceptor:{response:function(e){var a=e.data;return t.setUser(a.id,a.userId,a.user),t.rememberMe=e.config.params.rememberMe!==!1,t.save(),e.resource}},url:n+"/Users/login",method:"POST"},logout:{interceptor:{response:function(e){return t.clearUser(),t.clearStorage(),e.resource}},url:n+"/Users/logout",method:"POST"},confirm:{url:n+"/Users/confirm",method:"GET"},resetPassword:{url:n+"/Users/reset",method:"POST"},"::get::AccessToken::user":{url:n+"/AccessTokens/:id/user",method:"GET"},getCurrent:{url:n+"/Users/:id",method:"GET",params:{id:function(){var e=t.currentUserId;return null==e&&(e="__anonymous__"),e}},interceptor:{response:function(e){return t.currentUserData=e.data,e.resource}},__isGetCurrentUser__:!0}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.getCachedCurrent=function(){var e=t.currentUserData;return e?new o(e):null},o.isAuthenticated=function(){return null!=this.getCurrentId()},o.getCurrentId=function(){return t.currentUserId},o.modelName="User",o.accessTokens=function(){var e=a.get("AccessToken"),t=e["::get::User::accessTokens"];return t.apply(o,arguments)},o.accessTokens.count=function(){var e=a.get("AccessToken"),t=e["::count::User::accessTokens"];return t.apply(o,arguments)},o.accessTokens.create=function(){var e=a.get("AccessToken"),t=e["::create::User::accessTokens"];return t.apply(o,arguments)},o.accessTokens.createMany=function(){var e=a.get("AccessToken"),t=e["::createMany::User::accessTokens"];return t.apply(o,arguments)},o.accessTokens.destroyAll=function(){var e=a.get("AccessToken"),t=e["::delete::User::accessTokens"];return t.apply(o,arguments)},o.accessTokens.destroyById=function(){var e=a.get("AccessToken"),t=e["::destroyById::User::accessTokens"];return t.apply(o,arguments)},o.accessTokens.findById=function(){var e=a.get("AccessToken"),t=e["::findById::User::accessTokens"];return t.apply(o,arguments)},o.accessTokens.updateById=function(){var e=a.get("AccessToken"),t=e["::updateById::User::accessTokens"];return t.apply(o,arguments)},o}]),s.factory("AccessToken",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/AccessTokens/:id",{id:"@id"},{prototype$__get__user:{url:n+"/AccessTokens/:id/user",method:"GET"},create:{url:n+"/AccessTokens",method:"POST"},createMany:{isArray:!0,url:n+"/AccessTokens",method:"POST"},upsert:{url:n+"/AccessTokens",method:"PUT"},exists:{url:n+"/AccessTokens/:id/exists",method:"GET"},findById:{url:n+"/AccessTokens/:id",method:"GET"},find:{isArray:!0,url:n+"/AccessTokens",method:"GET"},findOne:{url:n+"/AccessTokens/findOne",method:"GET"},updateAll:{url:n+"/AccessTokens/update",method:"POST"},deleteById:{url:n+"/AccessTokens/:id",method:"DELETE"},count:{url:n+"/AccessTokens/count",method:"GET"},prototype$updateAttributes:{url:n+"/AccessTokens/:id",method:"PUT"},createChangeStream:{url:n+"/AccessTokens/change-stream",method:"POST"},"::findById::User::accessTokens":{params:{fk:"@fk"},url:n+"/Users/:id/accessTokens/:fk",method:"GET"},"::destroyById::User::accessTokens":{params:{fk:"@fk"},url:n+"/Users/:id/accessTokens/:fk",method:"DELETE"},"::updateById::User::accessTokens":{params:{fk:"@fk"},url:n+"/Users/:id/accessTokens/:fk",method:"PUT"},"::get::User::accessTokens":{isArray:!0,url:n+"/Users/:id/accessTokens",method:"GET"},"::create::User::accessTokens":{url:n+"/Users/:id/accessTokens",method:"POST"},"::createMany::User::accessTokens":{isArray:!0,url:n+"/Users/:id/accessTokens",method:"POST"},"::delete::User::accessTokens":{url:n+"/Users/:id/accessTokens",method:"DELETE"},"::count::User::accessTokens":{url:n+"/Users/:id/accessTokens/count",method:"GET"},"::findById::accounts::accessTokens":{params:{fk:"@fk"},url:n+"/accounts/:id/accessTokens/:fk",method:"GET"},"::destroyById::accounts::accessTokens":{params:{fk:"@fk"},url:n+"/accounts/:id/accessTokens/:fk",method:"DELETE"},"::updateById::accounts::accessTokens":{params:{fk:"@fk"},url:n+"/accounts/:id/accessTokens/:fk",method:"PUT"},"::get::accounts::accessTokens":{isArray:!0,url:n+"/accounts/:id/accessTokens",method:"GET"},"::create::accounts::accessTokens":{url:n+"/accounts/:id/accessTokens",method:"POST"},"::createMany::accounts::accessTokens":{isArray:!0,url:n+"/accounts/:id/accessTokens",method:"POST"},"::delete::accounts::accessTokens":{url:n+"/accounts/:id/accessTokens",method:"DELETE"},"::count::accounts::accessTokens":{url:n+"/accounts/:id/accessTokens/count",method:"GET"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="AccessToken",o.user=function(){var e=a.get("User"),t=e["::get::AccessToken::user"];return t.apply(o,arguments)},o}]),s.factory("Accounts",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/accounts/:id",{id:"@id"},{prototype$__findById__accessTokens:{params:{fk:"@fk"},url:n+"/accounts/:id/accessTokens/:fk",method:"GET"},prototype$__destroyById__accessTokens:{params:{fk:"@fk"},url:n+"/accounts/:id/accessTokens/:fk",method:"DELETE"},prototype$__updateById__accessTokens:{params:{fk:"@fk"},url:n+"/accounts/:id/accessTokens/:fk",method:"PUT"},prototype$__get__company:{url:n+"/accounts/:id/company",method:"GET"},prototype$__get__accessTokens:{isArray:!0,url:n+"/accounts/:id/accessTokens",method:"GET"},prototype$__create__accessTokens:{url:n+"/accounts/:id/accessTokens",method:"POST"},prototype$__delete__accessTokens:{url:n+"/accounts/:id/accessTokens",method:"DELETE"},prototype$__count__accessTokens:{url:n+"/accounts/:id/accessTokens/count",method:"GET"},create:{url:n+"/accounts",method:"POST"},createMany:{isArray:!0,url:n+"/accounts",method:"POST"},upsert:{url:n+"/accounts",method:"PUT"},exists:{url:n+"/accounts/:id/exists",method:"GET"},findById:{url:n+"/accounts/:id",method:"GET"},find:{isArray:!0,url:n+"/accounts",method:"GET"},findOne:{url:n+"/accounts/findOne",method:"GET"},updateAll:{url:n+"/accounts/update",method:"POST"},deleteById:{url:n+"/accounts/:id",method:"DELETE"},count:{url:n+"/accounts/count",method:"GET"},prototype$updateAttributes:{url:n+"/accounts/:id",method:"PUT"},createChangeStream:{url:n+"/accounts/change-stream",method:"POST"},login:{params:{include:"user"},interceptor:{response:function(e){var a=e.data;return t.setUser(a.id,a.userId,a.user),t.rememberMe=e.config.params.rememberMe!==!1,t.save(),e.resource}},url:n+"/accounts/login",method:"POST"},logout:{interceptor:{response:function(e){return t.clearUser(),t.clearStorage(),e.resource}},url:n+"/accounts/logout",method:"POST"},confirm:{url:n+"/accounts/confirm",method:"GET"},resetPassword:{url:n+"/accounts/reset",method:"POST"},updateAccount:{url:n+"/accounts/updateAccount",method:"POST"},updatePassword:{url:n+"/accounts/updatePassword",method:"POST"},setCompany:{url:n+"/accounts/setCompany",method:"POST"},"::findById::Companies::accounts":{params:{fk:"@fk"},url:n+"/Companies/:id/accounts/:fk",method:"GET"},"::destroyById::Companies::accounts":{params:{fk:"@fk"},url:n+"/Companies/:id/accounts/:fk",method:"DELETE"},"::updateById::Companies::accounts":{params:{fk:"@fk"},url:n+"/Companies/:id/accounts/:fk",method:"PUT"},"::get::Companies::accounts":{isArray:!0,url:n+"/Companies/:id/accounts",method:"GET"},"::create::Companies::accounts":{url:n+"/Companies/:id/accounts",method:"POST"},"::createMany::Companies::accounts":{isArray:!0,url:n+"/Companies/:id/accounts",method:"POST"},"::delete::Companies::accounts":{url:n+"/Companies/:id/accounts",method:"DELETE"},"::count::Companies::accounts":{url:n+"/Companies/:id/accounts/count",method:"GET"},getCurrent:{url:n+"/accounts/:id",method:"GET",params:{id:function(){var e=t.currentUserId;return null==e&&(e="__anonymous__"),e}},interceptor:{response:function(e){return t.currentUserData=e.data,e.resource}},__isGetCurrentUser__:!0}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.getCachedCurrent=function(){var e=t.currentUserData;return e?new o(e):null},o.isAuthenticated=function(){return null!=this.getCurrentId()},o.getCurrentId=function(){return t.currentUserId},o.modelName="Accounts",o.accessTokens=function(){var e=a.get("AccessToken"),t=e["::get::accounts::accessTokens"];return t.apply(o,arguments)},o.accessTokens.count=function(){var e=a.get("AccessToken"),t=e["::count::accounts::accessTokens"];return t.apply(o,arguments)},o.accessTokens.create=function(){var e=a.get("AccessToken"),t=e["::create::accounts::accessTokens"];return t.apply(o,arguments)},o.accessTokens.createMany=function(){var e=a.get("AccessToken"),t=e["::createMany::accounts::accessTokens"];return t.apply(o,arguments)},o.accessTokens.destroyAll=function(){var e=a.get("AccessToken"),t=e["::delete::accounts::accessTokens"];return t.apply(o,arguments)},o.accessTokens.destroyById=function(){var e=a.get("AccessToken"),t=e["::destroyById::accounts::accessTokens"];return t.apply(o,arguments)},o.accessTokens.findById=function(){var e=a.get("AccessToken"),t=e["::findById::accounts::accessTokens"];return t.apply(o,arguments)},o.accessTokens.updateById=function(){var e=a.get("AccessToken"),t=e["::updateById::accounts::accessTokens"];return t.apply(o,arguments)},o.company=function(){var e=a.get("Companies"),t=e["::get::accounts::company"];return t.apply(o,arguments)},o}]),s.factory("BookingHeaders",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/BookingHeaders/:id",{id:"@id"},{prototype$__findById__candidates:{params:{fk:"@fk"},url:n+"/BookingHeaders/:id/candidates/:fk",method:"GET"},prototype$__destroyById__candidates:{params:{fk:"@fk"},url:n+"/BookingHeaders/:id/candidates/:fk",method:"DELETE"},prototype$__updateById__candidates:{params:{fk:"@fk"},url:n+"/BookingHeaders/:id/candidates/:fk",method:"PUT"},prototype$__get__candidates:{isArray:!0,url:n+"/BookingHeaders/:id/candidates",method:"GET"},prototype$__create__candidates:{url:n+"/BookingHeaders/:id/candidates",method:"POST"},prototype$__delete__candidates:{url:n+"/BookingHeaders/:id/candidates",method:"DELETE"},prototype$__count__candidates:{url:n+"/BookingHeaders/:id/candidates/count",method:"GET"},create:{url:n+"/BookingHeaders",method:"POST"},createMany:{isArray:!0,url:n+"/BookingHeaders",method:"POST"},upsert:{url:n+"/BookingHeaders",method:"PUT"},exists:{url:n+"/BookingHeaders/:id/exists",method:"GET"},findById:{url:n+"/BookingHeaders/:id",method:"GET"},find:{isArray:!0,url:n+"/BookingHeaders",method:"GET"},findOne:{url:n+"/BookingHeaders/findOne",method:"GET"},updateAll:{url:n+"/BookingHeaders/update",method:"POST"},deleteById:{url:n+"/BookingHeaders/:id",method:"DELETE"},count:{url:n+"/BookingHeaders/count",method:"GET"},prototype$updateAttributes:{url:n+"/BookingHeaders/:id",method:"PUT"},createChangeStream:{url:n+"/BookingHeaders/change-stream",method:"POST"},submitBooking:{url:n+"/BookingHeaders/submitBooking",method:"POST"},emailBookingForm:{url:n+"/BookingHeaders/emailBookingForm",method:"POST"},submitPhoneBooking:{url:n+"/BookingHeaders/submitPhoneBooking",method:"POST"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="BookingHeaders",o.candidates=function(){var e=a.get("BookingCandidates"),t=e["::get::BookingHeaders::candidates"];return t.apply(o,arguments)},o.candidates.count=function(){var e=a.get("BookingCandidates"),t=e["::count::BookingHeaders::candidates"];return t.apply(o,arguments)},o.candidates.create=function(){var e=a.get("BookingCandidates"),t=e["::create::BookingHeaders::candidates"];return t.apply(o,arguments)},o.candidates.createMany=function(){var e=a.get("BookingCandidates"),t=e["::createMany::BookingHeaders::candidates"];return t.apply(o,arguments)},o.candidates.destroyAll=function(){var e=a.get("BookingCandidates"),t=e["::delete::BookingHeaders::candidates"];return t.apply(o,arguments)},o.candidates.destroyById=function(){var e=a.get("BookingCandidates"),t=e["::destroyById::BookingHeaders::candidates"];return t.apply(o,arguments)},o.candidates.findById=function(){var e=a.get("BookingCandidates"),t=e["::findById::BookingHeaders::candidates"];return t.apply(o,arguments)},o.candidates.updateById=function(){var e=a.get("BookingCandidates"),t=e["::updateById::BookingHeaders::candidates"];return t.apply(o,arguments)},o}]),s.factory("BookingCandidates",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/BookingCandidates/:id",{id:"@id"},{create:{url:n+"/BookingCandidates",method:"POST"},createMany:{isArray:!0,url:n+"/BookingCandidates",method:"POST"},upsert:{url:n+"/BookingCandidates",method:"PUT"},exists:{url:n+"/BookingCandidates/:id/exists",method:"GET"},findById:{url:n+"/BookingCandidates/:id",method:"GET"},find:{isArray:!0,url:n+"/BookingCandidates",method:"GET"},findOne:{url:n+"/BookingCandidates/findOne",method:"GET"},updateAll:{url:n+"/BookingCandidates/update",method:"POST"},deleteById:{url:n+"/BookingCandidates/:id",method:"DELETE"},count:{url:n+"/BookingCandidates/count",method:"GET"},prototype$updateAttributes:{url:n+"/BookingCandidates/:id",method:"PUT"},createChangeStream:{url:n+"/BookingCandidates/change-stream",method:"POST"},sendConfirmationEmail:{url:n+"/BookingCandidates/sendConfirmationEmail",method:"GET"},"::findById::BookingHeaders::candidates":{params:{fk:"@fk"},url:n+"/BookingHeaders/:id/candidates/:fk",method:"GET"},"::destroyById::BookingHeaders::candidates":{params:{fk:"@fk"},url:n+"/BookingHeaders/:id/candidates/:fk",method:"DELETE"},"::updateById::BookingHeaders::candidates":{params:{fk:"@fk"},url:n+"/BookingHeaders/:id/candidates/:fk",method:"PUT"},"::get::BookingHeaders::candidates":{isArray:!0,url:n+"/BookingHeaders/:id/candidates",method:"GET"},"::create::BookingHeaders::candidates":{url:n+"/BookingHeaders/:id/candidates",method:"POST"},"::createMany::BookingHeaders::candidates":{isArray:!0,url:n+"/BookingHeaders/:id/candidates",method:"POST"},"::delete::BookingHeaders::candidates":{url:n+"/BookingHeaders/:id/candidates",method:"DELETE"},"::count::BookingHeaders::candidates":{url:n+"/BookingHeaders/:id/candidates/count",method:"GET"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="BookingCandidates",o}]),s.factory("Positions",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/Positions/:id",{id:"@id"},{create:{url:n+"/Positions",method:"POST"},createMany:{isArray:!0,url:n+"/Positions",method:"POST"},upsert:{url:n+"/Positions",method:"PUT"},exists:{url:n+"/Positions/:id/exists",method:"GET"},findById:{url:n+"/Positions/:id",method:"GET"},find:{isArray:!0,url:n+"/Positions",method:"GET"},findOne:{url:n+"/Positions/findOne",method:"GET"},updateAll:{url:n+"/Positions/update",method:"POST"},deleteById:{url:n+"/Positions/:id",method:"DELETE"},count:{url:n+"/Positions/count",
method:"GET"},prototype$updateAttributes:{url:n+"/Positions/:id",method:"PUT"},createChangeStream:{url:n+"/Positions/change-stream",method:"POST"},"::findById::Companies::positions":{params:{fk:"@fk"},url:n+"/Companies/:id/positions/:fk",method:"GET"},"::destroyById::Companies::positions":{params:{fk:"@fk"},url:n+"/Companies/:id/positions/:fk",method:"DELETE"},"::updateById::Companies::positions":{params:{fk:"@fk"},url:n+"/Companies/:id/positions/:fk",method:"PUT"},"::get::Companies::positions":{isArray:!0,url:n+"/Companies/:id/positions",method:"GET"},"::create::Companies::positions":{url:n+"/Companies/:id/positions",method:"POST"},"::createMany::Companies::positions":{isArray:!0,url:n+"/Companies/:id/positions",method:"POST"},"::delete::Companies::positions":{url:n+"/Companies/:id/positions",method:"DELETE"},"::count::Companies::positions":{url:n+"/Companies/:id/positions/count",method:"GET"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="Positions",o}]),s.factory("Packages",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/Packages/:id",{id:"@id"},{prototype$__findById__Assessments:{params:{fk:"@fk"},url:n+"/Packages/:id/Assessments/:fk",method:"GET"},prototype$__destroyById__Assessments:{params:{fk:"@fk"},url:n+"/Packages/:id/Assessments/:fk",method:"DELETE"},prototype$__updateById__Assessments:{params:{fk:"@fk"},url:n+"/Packages/:id/Assessments/:fk",method:"PUT"},prototype$__link__Assessments:{params:{fk:"@fk"},url:n+"/Packages/:id/Assessments/rel/:fk",method:"PUT"},prototype$__unlink__Assessments:{params:{fk:"@fk"},url:n+"/Packages/:id/Assessments/rel/:fk",method:"DELETE"},prototype$__exists__Assessments:{params:{fk:"@fk"},url:n+"/Packages/:id/Assessments/rel/:fk",method:"HEAD"},prototype$__findById__packagesAssessments:{params:{fk:"@fk"},url:n+"/Packages/:id/packagesAssessments/:fk",method:"GET"},prototype$__destroyById__packagesAssessments:{params:{fk:"@fk"},url:n+"/Packages/:id/packagesAssessments/:fk",method:"DELETE"},prototype$__updateById__packagesAssessments:{params:{fk:"@fk"},url:n+"/Packages/:id/packagesAssessments/:fk",method:"PUT"},prototype$__findById__AssessmentHeaders:{params:{fk:"@fk"},url:n+"/Packages/:id/AssessmentHeaders/:fk",method:"GET"},prototype$__destroyById__AssessmentHeaders:{params:{fk:"@fk"},url:n+"/Packages/:id/AssessmentHeaders/:fk",method:"DELETE"},prototype$__updateById__AssessmentHeaders:{params:{fk:"@fk"},url:n+"/Packages/:id/AssessmentHeaders/:fk",method:"PUT"},prototype$__get__Assessments:{isArray:!0,url:n+"/Packages/:id/Assessments",method:"GET"},prototype$__create__Assessments:{url:n+"/Packages/:id/Assessments",method:"POST"},prototype$__delete__Assessments:{url:n+"/Packages/:id/Assessments",method:"DELETE"},prototype$__count__Assessments:{url:n+"/Packages/:id/Assessments/count",method:"GET"},prototype$__get__packagesAssessments:{isArray:!0,url:n+"/Packages/:id/packagesAssessments",method:"GET"},prototype$__create__packagesAssessments:{url:n+"/Packages/:id/packagesAssessments",method:"POST"},prototype$__delete__packagesAssessments:{url:n+"/Packages/:id/packagesAssessments",method:"DELETE"},prototype$__count__packagesAssessments:{url:n+"/Packages/:id/packagesAssessments/count",method:"GET"},prototype$__get__AssessmentHeaders:{isArray:!0,url:n+"/Packages/:id/AssessmentHeaders",method:"GET"},prototype$__create__AssessmentHeaders:{url:n+"/Packages/:id/AssessmentHeaders",method:"POST"},prototype$__delete__AssessmentHeaders:{url:n+"/Packages/:id/AssessmentHeaders",method:"DELETE"},prototype$__count__AssessmentHeaders:{url:n+"/Packages/:id/AssessmentHeaders/count",method:"GET"},create:{url:n+"/Packages",method:"POST"},createMany:{isArray:!0,url:n+"/Packages",method:"POST"},upsert:{url:n+"/Packages",method:"PUT"},exists:{url:n+"/Packages/:id/exists",method:"GET"},findById:{url:n+"/Packages/:id",method:"GET"},find:{isArray:!0,url:n+"/Packages",method:"GET"},findOne:{url:n+"/Packages/findOne",method:"GET"},updateAll:{url:n+"/Packages/update",method:"POST"},deleteById:{url:n+"/Packages/:id",method:"DELETE"},count:{url:n+"/Packages/count",method:"GET"},prototype$updateAttributes:{url:n+"/Packages/:id",method:"PUT"},createChangeStream:{url:n+"/Packages/change-stream",method:"POST"},upsertPackage:{url:n+"/Packages/upsertPackage",method:"POST"},listAssessments:{url:n+"/Packages/assessments",method:"GET"},"::findById::Companies::packages":{params:{fk:"@fk"},url:n+"/Companies/:id/packages/:fk",method:"GET"},"::destroyById::Companies::packages":{params:{fk:"@fk"},url:n+"/Companies/:id/packages/:fk",method:"DELETE"},"::updateById::Companies::packages":{params:{fk:"@fk"},url:n+"/Companies/:id/packages/:fk",method:"PUT"},"::get::Companies::packages":{isArray:!0,url:n+"/Companies/:id/packages",method:"GET"},"::create::Companies::packages":{url:n+"/Companies/:id/packages",method:"POST"},"::createMany::Companies::packages":{isArray:!0,url:n+"/Companies/:id/packages",method:"POST"},"::delete::Companies::packages":{url:n+"/Companies/:id/packages",method:"DELETE"},"::count::Companies::packages":{url:n+"/Companies/:id/packages/count",method:"GET"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="Packages",o}]),s.factory("Companies",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/Companies/:id",{id:"@id"},{prototype$__findById__packages:{params:{fk:"@fk"},url:n+"/Companies/:id/packages/:fk",method:"GET"},prototype$__destroyById__packages:{params:{fk:"@fk"},url:n+"/Companies/:id/packages/:fk",method:"DELETE"},prototype$__updateById__packages:{params:{fk:"@fk"},url:n+"/Companies/:id/packages/:fk",method:"PUT"},prototype$__findById__positions:{params:{fk:"@fk"},url:n+"/Companies/:id/positions/:fk",method:"GET"},prototype$__destroyById__positions:{params:{fk:"@fk"},url:n+"/Companies/:id/positions/:fk",method:"DELETE"},prototype$__updateById__positions:{params:{fk:"@fk"},url:n+"/Companies/:id/positions/:fk",method:"PUT"},prototype$__findById__accounts:{params:{fk:"@fk"},url:n+"/Companies/:id/accounts/:fk",method:"GET"},prototype$__destroyById__accounts:{params:{fk:"@fk"},url:n+"/Companies/:id/accounts/:fk",method:"DELETE"},prototype$__updateById__accounts:{params:{fk:"@fk"},url:n+"/Companies/:id/accounts/:fk",method:"PUT"},prototype$__findById__subsidiaries:{params:{fk:"@fk"},url:n+"/Companies/:id/subsidiaries/:fk",method:"GET"},prototype$__destroyById__subsidiaries:{params:{fk:"@fk"},url:n+"/Companies/:id/subsidiaries/:fk",method:"DELETE"},prototype$__updateById__subsidiaries:{params:{fk:"@fk"},url:n+"/Companies/:id/subsidiaries/:fk",method:"PUT"},prototype$__findById__bookings:{params:{fk:"@fk"},url:n+"/Companies/:id/bookings/:fk",method:"GET"},prototype$__destroyById__bookings:{params:{fk:"@fk"},url:n+"/Companies/:id/bookings/:fk",method:"DELETE"},prototype$__updateById__bookings:{params:{fk:"@fk"},url:n+"/Companies/:id/bookings/:fk",method:"PUT"},prototype$__get__packages:{isArray:!0,url:n+"/Companies/:id/packages",method:"GET"},prototype$__create__packages:{url:n+"/Companies/:id/packages",method:"POST"},prototype$__delete__packages:{url:n+"/Companies/:id/packages",method:"DELETE"},prototype$__count__packages:{url:n+"/Companies/:id/packages/count",method:"GET"},prototype$__get__positions:{isArray:!0,url:n+"/Companies/:id/positions",method:"GET"},prototype$__create__positions:{url:n+"/Companies/:id/positions",method:"POST"},prototype$__delete__positions:{url:n+"/Companies/:id/positions",method:"DELETE"},prototype$__count__positions:{url:n+"/Companies/:id/positions/count",method:"GET"},prototype$__get__accounts:{isArray:!0,url:n+"/Companies/:id/accounts",method:"GET"},prototype$__create__accounts:{url:n+"/Companies/:id/accounts",method:"POST"},prototype$__delete__accounts:{url:n+"/Companies/:id/accounts",method:"DELETE"},prototype$__count__accounts:{url:n+"/Companies/:id/accounts/count",method:"GET"},prototype$__get__subsidiaries:{isArray:!0,url:n+"/Companies/:id/subsidiaries",method:"GET"},prototype$__create__subsidiaries:{url:n+"/Companies/:id/subsidiaries",method:"POST"},prototype$__delete__subsidiaries:{url:n+"/Companies/:id/subsidiaries",method:"DELETE"},prototype$__count__subsidiaries:{url:n+"/Companies/:id/subsidiaries/count",method:"GET"},prototype$__get__bookings:{isArray:!0,url:n+"/Companies/:id/bookings",method:"GET"},prototype$__create__bookings:{url:n+"/Companies/:id/bookings",method:"POST"},prototype$__delete__bookings:{url:n+"/Companies/:id/bookings",method:"DELETE"},prototype$__count__bookings:{url:n+"/Companies/:id/bookings/count",method:"GET"},create:{url:n+"/Companies",method:"POST"},createMany:{isArray:!0,url:n+"/Companies",method:"POST"},upsert:{url:n+"/Companies",method:"PUT"},exists:{url:n+"/Companies/:id/exists",method:"GET"},findById:{url:n+"/Companies/:id",method:"GET"},find:{isArray:!0,url:n+"/Companies",method:"GET"},findOne:{url:n+"/Companies/findOne",method:"GET"},updateAll:{url:n+"/Companies/update",method:"POST"},deleteById:{url:n+"/Companies/:id",method:"DELETE"},count:{url:n+"/Companies/count",method:"GET"},prototype$updateAttributes:{url:n+"/Companies/:id",method:"PUT"},createChangeStream:{url:n+"/Companies/change-stream",method:"POST"},getRediSubsidiaries:{url:n+"/Companies/getRediSubsidiaries",method:"GET"},initData:{url:n+"/Companies/initData",method:"GET"},getPackages:{url:n+"/Companies/getPackages",method:"GET"},getAssessments:{url:n+"/Companies/getAssessments",method:"GET"},getPhoneBookingHeader:{url:n+"/Companies/getPhoneBookingHeader",method:"GET"},listBookings:{url:n+"/Companies/listBookings",method:"GET"},listTelehealthBookings:{url:n+"/Companies/listTelehealthBookings",method:"GET"},countBookings:{url:n+"/Companies/countBookings",method:"GET"},listUser:{url:n+"/Companies/list-user",method:"GET"},getSites:{url:n+"/Companies/getSites",method:"GET"},getCalendars:{url:n+"/Companies/getCalendars",method:"POST"},getStatus:{url:n+"/Companies/getStatus",method:"GET"},"::get::accounts::company":{url:n+"/accounts/:id/company",method:"GET"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="Companies",o.packages=function(){var e=a.get("Packages"),t=e["::get::Companies::packages"];return t.apply(o,arguments)},o.packages.count=function(){var e=a.get("Packages"),t=e["::count::Companies::packages"];return t.apply(o,arguments)},o.packages.create=function(){var e=a.get("Packages"),t=e["::create::Companies::packages"];return t.apply(o,arguments)},o.packages.createMany=function(){var e=a.get("Packages"),t=e["::createMany::Companies::packages"];return t.apply(o,arguments)},o.packages.destroyAll=function(){var e=a.get("Packages"),t=e["::delete::Companies::packages"];return t.apply(o,arguments)},o.packages.destroyById=function(){var e=a.get("Packages"),t=e["::destroyById::Companies::packages"];return t.apply(o,arguments)},o.packages.findById=function(){var e=a.get("Packages"),t=e["::findById::Companies::packages"];return t.apply(o,arguments)},o.packages.updateById=function(){var e=a.get("Packages"),t=e["::updateById::Companies::packages"];return t.apply(o,arguments)},o.positions=function(){var e=a.get("Positions"),t=e["::get::Companies::positions"];return t.apply(o,arguments)},o.positions.count=function(){var e=a.get("Positions"),t=e["::count::Companies::positions"];return t.apply(o,arguments)},o.positions.create=function(){var e=a.get("Positions"),t=e["::create::Companies::positions"];return t.apply(o,arguments)},o.positions.createMany=function(){var e=a.get("Positions"),t=e["::createMany::Companies::positions"];return t.apply(o,arguments)},o.positions.destroyAll=function(){var e=a.get("Positions"),t=e["::delete::Companies::positions"];return t.apply(o,arguments)},o.positions.destroyById=function(){var e=a.get("Positions"),t=e["::destroyById::Companies::positions"];return t.apply(o,arguments)},o.positions.findById=function(){var e=a.get("Positions"),t=e["::findById::Companies::positions"];return t.apply(o,arguments)},o.positions.updateById=function(){var e=a.get("Positions"),t=e["::updateById::Companies::positions"];return t.apply(o,arguments)},o.accounts=function(){var e=a.get("Accounts"),t=e["::get::Companies::accounts"];return t.apply(o,arguments)},o.accounts.count=function(){var e=a.get("Accounts"),t=e["::count::Companies::accounts"];return t.apply(o,arguments)},o.accounts.create=function(){var e=a.get("Accounts"),t=e["::create::Companies::accounts"];return t.apply(o,arguments)},o.accounts.createMany=function(){var e=a.get("Accounts"),t=e["::createMany::Companies::accounts"];return t.apply(o,arguments)},o.accounts.destroyAll=function(){var e=a.get("Accounts"),t=e["::delete::Companies::accounts"];return t.apply(o,arguments)},o.accounts.destroyById=function(){var e=a.get("Accounts"),t=e["::destroyById::Companies::accounts"];return t.apply(o,arguments)},o.accounts.findById=function(){var e=a.get("Accounts"),t=e["::findById::Companies::accounts"];return t.apply(o,arguments)},o.accounts.updateById=function(){var e=a.get("Accounts"),t=e["::updateById::Companies::accounts"];return t.apply(o,arguments)},o}]),s.factory("Redimedsites",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/Redimedsites/:id",{id:"@id"},{prototype$__findById__States:{params:{fk:"@fk"},url:n+"/Redimedsites/:id/States/:fk",method:"GET"},prototype$__destroyById__States:{params:{fk:"@fk"},url:n+"/Redimedsites/:id/States/:fk",method:"DELETE"},prototype$__updateById__States:{params:{fk:"@fk"},url:n+"/Redimedsites/:id/States/:fk",method:"PUT"},prototype$__findById__AdminCalendars:{params:{fk:"@fk"},url:n+"/Redimedsites/:id/AdminCalendars/:fk",method:"GET"},prototype$__destroyById__AdminCalendars:{params:{fk:"@fk"},url:n+"/Redimedsites/:id/AdminCalendars/:fk",method:"DELETE"},prototype$__updateById__AdminCalendars:{params:{fk:"@fk"},url:n+"/Redimedsites/:id/AdminCalendars/:fk",method:"PUT"},prototype$__findById__Calendars:{params:{fk:"@fk"},url:n+"/Redimedsites/:id/Calendars/:fk",method:"GET"},prototype$__destroyById__Calendars:{params:{fk:"@fk"},url:n+"/Redimedsites/:id/Calendars/:fk",method:"DELETE"},prototype$__updateById__Calendars:{params:{fk:"@fk"},url:n+"/Redimedsites/:id/Calendars/:fk",method:"PUT"},prototype$__get__States:{isArray:!0,url:n+"/Redimedsites/:id/States",method:"GET"},prototype$__create__States:{url:n+"/Redimedsites/:id/States",method:"POST"},prototype$__delete__States:{url:n+"/Redimedsites/:id/States",method:"DELETE"},prototype$__count__States:{url:n+"/Redimedsites/:id/States/count",method:"GET"},prototype$__get__AdminCalendars:{isArray:!0,url:n+"/Redimedsites/:id/AdminCalendars",method:"GET"},prototype$__create__AdminCalendars:{url:n+"/Redimedsites/:id/AdminCalendars",method:"POST"},prototype$__delete__AdminCalendars:{url:n+"/Redimedsites/:id/AdminCalendars",method:"DELETE"},prototype$__count__AdminCalendars:{url:n+"/Redimedsites/:id/AdminCalendars/count",method:"GET"},prototype$__get__Calendars:{isArray:!0,url:n+"/Redimedsites/:id/Calendars",method:"GET"},prototype$__create__Calendars:{url:n+"/Redimedsites/:id/Calendars",method:"POST"},prototype$__delete__Calendars:{url:n+"/Redimedsites/:id/Calendars",method:"DELETE"},prototype$__count__Calendars:{url:n+"/Redimedsites/:id/Calendars/count",method:"GET"},create:{url:n+"/Redimedsites",method:"POST"},createMany:{isArray:!0,url:n+"/Redimedsites",method:"POST"},upsert:{url:n+"/Redimedsites",method:"PUT"},exists:{url:n+"/Redimedsites/:id/exists",method:"GET"},findById:{url:n+"/Redimedsites/:id",method:"GET"},find:{isArray:!0,url:n+"/Redimedsites",method:"GET"},findOne:{url:n+"/Redimedsites/findOne",method:"GET"},updateAll:{url:n+"/Redimedsites/update",method:"POST"},deleteById:{url:n+"/Redimedsites/:id",method:"DELETE"},count:{url:n+"/Redimedsites/count",method:"GET"},prototype$updateAttributes:{url:n+"/Redimedsites/:id",method:"PUT"},createChangeStream:{url:n+"/Redimedsites/change-stream",method:"POST"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="Redimedsites",o}]),s.factory("Calendar",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/Calendars/:id",{id:"@id"},{create:{url:n+"/Calendars",method:"POST"},createMany:{isArray:!0,url:n+"/Calendars",method:"POST"},upsert:{url:n+"/Calendars",method:"PUT"},exists:{url:n+"/Calendars/:id/exists",method:"GET"},findById:{url:n+"/Calendars/:id",method:"GET"},find:{isArray:!0,url:n+"/Calendars",method:"GET"},findOne:{url:n+"/Calendars/findOne",method:"GET"},updateAll:{url:n+"/Calendars/update",method:"POST"},deleteById:{url:n+"/Calendars/:id",method:"DELETE"},count:{url:n+"/Calendars/count",method:"GET"},prototype$updateAttributes:{url:n+"/Calendars/:id",method:"PUT"},createChangeStream:{url:n+"/Calendars/change-stream",method:"POST"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="Calendar",o}]),s.factory("Email",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/Emails/:id",{id:"@id"},{});return o.modelName="Email",o}]),s.factory("ClientLogs",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/ClientLogs/:id",{id:"@id"},{create:{url:n+"/ClientLogs",method:"POST"},createMany:{isArray:!0,url:n+"/ClientLogs",method:"POST"},upsert:{url:n+"/ClientLogs",method:"PUT"},exists:{url:n+"/ClientLogs/:id/exists",method:"GET"},findById:{url:n+"/ClientLogs/:id",method:"GET"},find:{isArray:!0,url:n+"/ClientLogs",method:"GET"},findOne:{url:n+"/ClientLogs/findOne",method:"GET"},updateAll:{url:n+"/ClientLogs/update",method:"POST"},deleteById:{url:n+"/ClientLogs/:id",method:"DELETE"},count:{url:n+"/ClientLogs/count",method:"GET"},prototype$updateAttributes:{url:n+"/ClientLogs/:id",method:"PUT"},createChangeStream:{url:n+"/ClientLogs/change-stream",method:"POST"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="ClientLogs",o}]),s.factory("AngularLog",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/AngularLogs/:id",{id:"@id"},{create:{url:n+"/AngularLogs",method:"POST"},createMany:{isArray:!0,url:n+"/AngularLogs",method:"POST"},upsert:{url:n+"/AngularLogs",method:"PUT"},exists:{url:n+"/AngularLogs/:id/exists",method:"GET"},findById:{url:n+"/AngularLogs/:id",method:"GET"},find:{isArray:!0,url:n+"/AngularLogs",method:"GET"},findOne:{url:n+"/AngularLogs/findOne",method:"GET"},updateAll:{url:n+"/AngularLogs/update",method:"POST"},deleteById:{url:n+"/AngularLogs/:id",method:"DELETE"},count:{url:n+"/AngularLogs/count",method:"GET"},prototype$updateAttributes:{url:n+"/AngularLogs/:id",method:"PUT"},createChangeStream:{url:n+"/AngularLogs/change-stream",method:"POST"},insertLogs:{url:n+"/AngularLogs/insertLogs",method:"POST"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="AngularLog",o}]),s.factory("BookingCandidateByApptDateV",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/BookingCandidateByApptDateVs/:id",{id:"@id"},{create:{url:n+"/BookingCandidateByApptDateVs",method:"POST"},createMany:{isArray:!0,url:n+"/BookingCandidateByApptDateVs",method:"POST"},upsert:{url:n+"/BookingCandidateByApptDateVs",method:"PUT"},exists:{url:n+"/BookingCandidateByApptDateVs/:id/exists",method:"GET"},findById:{url:n+"/BookingCandidateByApptDateVs/:id",method:"GET"},find:{isArray:!0,url:n+"/BookingCandidateByApptDateVs",method:"GET"},findOne:{url:n+"/BookingCandidateByApptDateVs/findOne",method:"GET"},updateAll:{url:n+"/BookingCandidateByApptDateVs/update",method:"POST"},deleteById:{url:n+"/BookingCandidateByApptDateVs/:id",method:"DELETE"},count:{url:n+"/BookingCandidateByApptDateVs/count",method:"GET"},prototype$updateAttributes:{url:n+"/BookingCandidateByApptDateVs/:id",method:"PUT"},createChangeStream:{url:n+"/BookingCandidateByApptDateVs/change-stream",method:"POST"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="BookingCandidateByApptDateV",o}]),s.factory("BookingCandidateByBookingDateV",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/BookingCandidateByBookingDateVs/:id",{id:"@id"},{create:{url:n+"/BookingCandidateByBookingDateVs",method:"POST"},createMany:{isArray:!0,url:n+"/BookingCandidateByBookingDateVs",method:"POST"},upsert:{url:n+"/BookingCandidateByBookingDateVs",method:"PUT"},exists:{url:n+"/BookingCandidateByBookingDateVs/:id/exists",method:"GET"},findById:{url:n+"/BookingCandidateByBookingDateVs/:id",method:"GET"},find:{isArray:!0,url:n+"/BookingCandidateByBookingDateVs",method:"GET"},findOne:{url:n+"/BookingCandidateByBookingDateVs/findOne",method:"GET"},updateAll:{url:n+"/BookingCandidateByBookingDateVs/update",method:"POST"},deleteById:{url:n+"/BookingCandidateByBookingDateVs/:id",method:"DELETE"},count:{url:n+"/BookingCandidateByBookingDateVs/count",method:"GET"},prototype$updateAttributes:{url:n+"/BookingCandidateByBookingDateVs/:id",method:"PUT"},createChangeStream:{url:n+"/BookingCandidateByBookingDateVs/change-stream",method:"POST"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="BookingCandidateByBookingDateV",o}]),s.factory("CalendarHoldings",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/CalendarHoldings/:id",{id:"@id"},{create:{url:n+"/CalendarHoldings",method:"POST"},createMany:{isArray:!0,url:n+"/CalendarHoldings",method:"POST"},upsert:{url:n+"/CalendarHoldings",method:"PUT"},exists:{url:n+"/CalendarHoldings/:id/exists",method:"GET"},findById:{url:n+"/CalendarHoldings/:id",method:"GET"},find:{isArray:!0,url:n+"/CalendarHoldings",method:"GET"},findOne:{url:n+"/CalendarHoldings/findOne",method:"GET"},updateAll:{url:n+"/CalendarHoldings/update",method:"POST"},deleteById:{url:n+"/CalendarHoldings/:id",method:"DELETE"},count:{url:n+"/CalendarHoldings/count",method:"GET"},prototype$updateAttributes:{url:n+"/CalendarHoldings/:id",method:"PUT"},createChangeStream:{url:n+"/CalendarHoldings/change-stream",method:"POST"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="CalendarHoldings",o}]),s.factory("TelehealthBookings",["LoopBackResource","LoopBackAuth","$injector",function(e,t,a){var o=e(n+"/TelehealthBookings/:id",{id:"@id"},{create:{url:n+"/TelehealthBookings",method:"POST"},createMany:{isArray:!0,url:n+"/TelehealthBookings",method:"POST"},upsert:{url:n+"/TelehealthBookings",method:"PUT"},exists:{url:n+"/TelehealthBookings/:id/exists",method:"GET"},findById:{url:n+"/TelehealthBookings/:id",method:"GET"},find:{isArray:!0,url:n+"/TelehealthBookings",method:"GET"},findOne:{url:n+"/TelehealthBookings/findOne",method:"GET"},updateAll:{url:n+"/TelehealthBookings/update",method:"POST"},deleteById:{url:n+"/TelehealthBookings/:id",method:"DELETE"},count:{url:n+"/TelehealthBookings/count",method:"GET"},prototype$updateAttributes:{url:n+"/TelehealthBookings/:id",method:"PUT"},createChangeStream:{url:n+"/TelehealthBookings/change-stream",method:"POST"},sendConfirmationEmail:{url:n+"/TelehealthBookings/sendConfirmationEmail",method:"GET"}});return o.updateOrCreate=o.upsert,o.update=o.updateAll,o.destroyById=o.deleteById,o.removeById=o.deleteById,o.modelName="TelehealthBookings",o}]),s.factory("LoopBackAuth",function(){function e(){var e=this;n.forEach(function(t){e[t]=o(t)}),this.rememberMe=a,this.currentUserData=null}function t(e,t,a){var o=i+t;null==a&&(a=""),e[o]=a}function o(e){var t=i+e;return localStorage[t]||sessionStorage[t]||null}var n=["accessTokenId","currentUserId"],i="$LoopBack$";return e.prototype.save=function(){var e=this,a=this.rememberMe?localStorage:sessionStorage;n.forEach(function(o){t(a,o,e[o])})},e.prototype.setUser=function(e,t,a){this.accessTokenId=e,this.currentUserId=t,this.currentUserData=a},e.prototype.clearUser=function(){this.accessTokenId=null,this.currentUserId=null,this.currentUserData=null},e.prototype.clearStorage=function(){n.forEach(function(e){t(sessionStorage,e,null),t(localStorage,e,null)})},new e}).config(["$httpProvider",function(e){e.interceptors.push("LoopBackAuthRequestInterceptor")}]).factory("LoopBackAuthRequestInterceptor",["$q","LoopBackAuth",function(e,t){return{request:function(o){if(o.url.substr(0,n.length)!==n)return o;if(t.accessTokenId)o.headers[i]=t.accessTokenId;else if(o.__isGetCurrentUser__){var s={body:{error:{status:401}},status:401,config:o,headers:function(){return a}};return e.reject(s)}return o||e.when(o)}}}]).provider("LoopBackResource",function(){this.setAuthHeader=function(e){i=e},this.setUrlBase=function(e){n=e},this.getUrlBase=function(){return n},this.$get=["$resource",function(e){return function(t,a,o){var n=e(t,a,o);return n.prototype.$save=function(e,t){var a=n.upsert.call(this,{},this,e,t);return a.$promise||a},n}}]})}(window,window.angular),angular.module("MasterDetailDirective",["toastr","DynamicForm","$logServices"]).directive("mainMasterDetailDirective",["$dynamicState","$q","$parse","$compile","$document","$state","$log",function(e,t,a,o,n,i,s){return{restrict:"E",scope:{},link:function(n,r,l){var d=function(e){var t="{";if("object"!=typeof e)return"string"==typeof e?"&quot;"+e.replace(/ /g,"&nbsp;")+"&quot;":e+"";for(var a in e)e.hasOwnProperty(a)&&(t+=a+":"+d(e[a])+",");return t.substring(0,t.length-1)+"}"};s.debug("direcgive setup = ");var c=i.current;s.debug("currentState = ",c),t.when(a(l.setup)(n)).then(function(t){if(s.debug("setup object = ",t),n.formDefines={},t.master&&(n.formDefines.div1={type:"div",uiView:t.master.name,ngShow:"$root.$state.includes('"+c.name+"."+t.master.name+"')"},e.addState(c.name+"."+t.master.name,"list",t.master.controller,"<my-dynamic-form formdefine = "+d(t.master.layout)+" ></my-dynamic-form>",t.master.name)),t.detail&&(n.formDefines.div2={type:"div",uiView:t.detail.name,ngShow:" $root.$state.includes('"+c.name+"."+t.detail.name+"')"},e.addState(c.name+"."+t.detail.name,"/:row",t.detail.controller,'<my-dynamic-form formdefine = "'+d(t.detail.layout)+'" ></my-dynamic-form>',t.detail.name),console.log("states = ",i.get())),t.master){var a=angular.element('<my-dynamic-form formdefine = "{{formDefines}}" ></my-dynamic-form>');o(a)(n),r.replaceWith(a),i.go(c.name+"."+t.master.name)}else{var a=angular.element("<p>"+d(t.detail.layout)+"</p>");o(a)(n),r.replaceWith(a)}})}}}]).directive("listDirective",["$q","$parse","$compile","$document",function(e,t,a,o){return{restrict:"E",scope:{},controller:"@",name:"controllerName",controllerAs:"MainCtrl",link:function(e,t,o){e[o.controllerName]=e.MainCtrl;var n=angular.element('<my-dynamic-form formdefine = "{{MainCtrl.tableDefines}}" ></my-dynamic-form>');a(n)(e),t.replaceWith(n)}}}]),angular.module("MasterDetailDirective").factory("DetailModal",["$uibModal","$log",function(e,t){t=t.getInstance("MasterDetailDirective.DetailModal");var a="",o="",n="",i={},s=function(e){t.debug("this is 'closeModal' function, please override by setCloseModalFunc() ",e)},r=function(e){t.info("Modal dismissed at: "+new Date),t.debug("this is 'dismissModal' function, please override by setDismissModalFunc() ",e)};return{setTemplateUrl:function(e){a=e},setControllerName:function(e){o=e},setSize:function(e){n=e},setCloseModalFunc:function(e){s=e},setDismissModalFunc:function(e){r=e},setResolve:function(e,t){i[e]=t,console.log("pResolve=",i)},newOrEditRow:function(t){console.log("DetailModal",a),i.row=function(){return t},console.log("pResolve=",i);var l=e.open({animation:!0,template:a,controller:o,controllerAs:o,size:n,resolve:i});l.result.then(function(e){s(e)},function(e){r(e)})}}}]).factory("DetailModal2",["$uibModal","$log",function(e,t){t=t.getInstance("MasterDetailDirective.DetailModal");var a="",o="",n="",i={},s=function(e){t.debug("this is 'closeModal' function, please override by setCloseModalFunc() ",e)},r=function(e){t.info("Modal dismissed at: "+new Date),t.debug("this is 'dismissModal' function, please override by setDismissModalFunc() ",e)};return{setTemplateUrl:function(e){a=e},setControllerName:function(e){o=e},setSize:function(e){n=e},setCloseModalFunc:function(e){s=e},setDismissModalFunc:function(e){r=e},setResolve:function(e,t){i[e]=t,console.log("pResolve=",i)},newOrEditRow:function(t){console.log("DetailModal",a),i.row=function(){return t},console.log("pResolve=",i);var l=e.open({animation:!0,template:a,controller:o,controllerAs:o,size:n,resolve:i});l.result.then(function(e){s(e)},function(e){r(e)})}}}]).factory("DeleteModal",["$uibModal","$log",function(e,t){t=t.getInstance("MasterDetailDirective.DeleteModal");var a="",o="",n="",i={},s=function(e){t.debug("this is 'closeModal' function, please override by setCloseModalFunc() ",e)},r=function(e){t.info("Modal dismissed at: "+new Date),t.debug("this is 'dismissModal' function, please override by setDismissModalFunc() ",e)};return{setTemplateUrl:function(e){a=e},setControllerName:function(e){o=e},setSize:function(e){n=e},setCloseModalFunc:function(e){s=e},setDismissModalFunc:function(e){r=e},setResolve:function(e,t){i[e]=t,console.log("pResolve=",i)},deleteRow:function(t){console.log("DetailModal",a),i.row=function(){return t},console.log("pResolve=",i);var l=e.open({animation:!0,template:a,controller:o,controllerAs:o,size:n,resolve:i});l.result.then(function(e){s(e)},function(e){r(e)})}}}]),angular.module("ocsApp.Authentication",["toastr","lbServices","ocsApp.Navigator"]).config(["$stateProvider",function(e){e.state("authentication",{"abstract":!0,views:{root:{templateUrl:"modules/Authentication/views/authen.main.html",controller:"AuthenMainCtrl"}}}).state("authentication.login",{url:"/",views:{"main-content":{templateUrl:"modules/Authentication/views/authen.login.html",controller:"LoginCtrl",controllerAs:"loginCtrl"}}}).state("authentication.forgotpass",{url:"/forgotpass",views:{"main-content":{templateUrl:"modules/Authentication/views/authen.forgotpass.html",controller:"ForgotPasswordCtrl",controllerAs:"forgotPasswordCtrl"}}}).state("authentication.resetpass",{url:"/reset-pass/:token",views:{"main-content":{templateUrl:"modules/Authentication/views/authen.resetpass.html",controller:"ResetPasswordCtrl",controllerAs:"resetPasswordCtrl"}}}).state("authentication.bookingreportsdirectly",{url:"/bookingreports",views:{"main-content":{templateUrl:"modules/BookingReports/views/bookingreports.main.html",controller:"BookingReportsMainCtrl",controllerAs:"BookingReportsMainCtrl"}}}).state("authentication.registration",{url:"/registration",views:{"main-content":{templateUrl:"modules/Authentication/views/authen.registration.html"}}})}]),angular.module("ocsApp.BookingReports",["toastr","zingchart-angularjs"]).config(["$stateProvider",function(e){e.state("navigator.bookingreports",{"abstract":!1,url:"/bookingreports",templateUrl:"modules/BookingReports/views/bookingreports.main.html",controller:"BookingReportsMainCtrl",controllerAs:"BookingReportsMainCtrl"})}]),angular.module("ocsApp.Bookings",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.bookings",{"abstract":!1,url:"/bookings",templateUrl:"modules/Bookings/views/bookings.main.html",controller:"BookingsMainCtrl",controllerAs:"BookingsMainCtrl"})}]),angular.module("ocsApp.Companies",["lbServices","MasterDetailDirective","ct.ui.router.extras.sticky","ct.ui.router.extras.dsr","ct.ui.router.extras.statevis"]).config(["$stateProvider","$stickyStateProvider",function(e,t){t.enableDebug(!1),e.state("navigator.companies",{"abstract":!1,url:"/companies",controller:function(e){e=e.getInstance("ocsApp.Companies"),e.debug("I am controller of Company");var t={div:{type:"div",fieldClass:"portlet box green portet-datatable",fields:{div:{type:"div",isSubmitedVar:"isSubmitted",controllerAs:"CompaniesMainCtrl",fieldClass:"portlet-title",fields:{div1:{type:"div",fieldClass:"caption bold",fields:{span:{
type:"span",label:"Company List",fieldClass:"caption-subject bold uppercase"}}},div2:{type:"div",fieldClass:"tools",fields:{newButton:{type:"button",label:"New Company",fieldClass:"btn btn-primary",ngClick:"detail()"}}}}},div2:{type:"div",fieldClass:"portlet-body",fields:{table:{type:"table",isSort:!0,isSearch:!0,dataSource:"rows",fieldClass:"table table-striped table-bordered table-hover order-column",ngClick:"detail(row)",fields:{companyName:{field:"companyName",displayName:"Company Name",width:"100"},addr:{field:"addr",displayName:"Address",width:"100"},state:{field:"state",displayName:"State",width:"100"},country:{field:"country",displayName:"Country",width:"100"},deleteRow:{type:"button",label:"Delete",displayName:"Action",fieldClass:"btn btn-warning",ngClick:"deleteRow(row)"}}}}}}}},a={div1:{type:"div",fieldClass:"modal-header",controllerAs:"NewCompanyCtrl",isSubmitedVar:"isSubmitted",fields:{h3:{type:"h3",label:"{{NewCompanyCtrl.windowTitle}}",fieldClass:"modal-title"}}},div2:{type:"div",fieldClass:"modal-body",fields:{form:{type:"form",name:"form",fieldClass:"form-horizontal form-row-seperated",fields:{companyName:{field:"companyName",ngModel:"row.companyName",label:"Company Name",placeholder:"Company name",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},addr:{field:"addr",ngModel:"row.addr",label:"Address",placeholder:"Address",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},state:{field:"state",ngModel:"row.state",label:"State",placeholder:"State",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{ACT:{label:"Australian Capital Territory"},NSW:{label:"New South Wales"},VIC:{label:"Victoria"},QLD:{label:"Queensland"},SA:{label:"South Australia"},WA:{label:"Western Australia"},NT:{label:"Northern Territory"}}},country:{field:"country",ngModel:"row.country",label:"Country",placeholder:"Country",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{Australia:{label:"Australia"}}},defaultStatus:{field:"defaultStatus",ngModel:"row.defaultStatusObject",label:"Default Status",placeholder:"Default status",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",ngOptions:"status.bookingStatus for status in NewCompanyCtrl.bookingStatus"},description:{field:"description",ngModel:"row.description",label:"Description",placeholder:"Description",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},industry:{field:"industry",ngModel:"row.industry",label:"Industry",placeholder:"Industry",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},invoiceEmail:{field:"invoiceEmail",ngModel:"row.invoiceEmail",label:"Invoice Email",placeholder:"Invoice email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Invoice email is required",emailHelpBlock:"Email is invalid"},resultEmail:{field:"resultEmail",ngModel:"row.resultEmail",label:"Result Email",placeholder:"Result email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Result email is required",emailHelpBlock:"Email is invalid"},reportToEmail:{field:"reportToEmail",ngModel:"row.reportToEmail",label:"Report Email",placeholder:"",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"email",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Report email is required",emailHelpBlock:"Email is invalid"},fieldGroup:{type:"horizontalFieldGroup",fieldClass:"col-md-12",columnClass:"col-md-3",fields:{isaddcontactemailtoresult:{field:"isaddcontactemailtoresult",ngModel:"row.isaddcontactemailtoresult",label:"Is Result Email",placeholder:"Is Result Email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},isinvoiceemailtouser:{field:"isinvoiceemailtouser",ngModel:"row.isinvoiceemailtouser",label:"Is Invoice Email",placeholder:"Is Invoice Email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},ispo:{field:"ispo",ngModel:"row.ispo",label:"PO",placeholder:"PO",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},isproject:{field:"isproject",ngModel:"row.isproject",label:"Project",placeholder:"Project",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0}}},poNumber:{field:"poNumber",ngModel:"row.poNumber",label:"PO Number",placeholder:"PO Number",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"}}},table:{type:"table",controllerAs:"NewCompanyCtrl",isSubmitedVar:"isSubmitted",dataSource:"row.subsidiaries",fieldClass:"table table-striped table-bordered table-hover order-column",ngClick:"newOrEditRow(row)",fields:{companyName:{field:"companyName",displayName:"Company Name",width:"100"},addr:{field:"addr",displayName:"Address",width:"100"},state:{field:"state",displayName:"State",width:"100"},country:{field:"country",displayName:"Country",width:"100"}}}}},div3:{type:"div",fieldClass:"modal-footer",fields:{SaveButton:{type:"button",label:"Save",fieldClass:"btn btn-primary",ngClick:"ok()"},CancelButton:{type:"button",label:"Cancel",fieldClass:"btn btn-warning",ngClick:"cancel()"},NewButton:{type:"button",label:"New Sub Company",fieldClass:"btn btn-warning",ngClick:"newOrEditRow()"}}}};this.masterDetailDefs={master:{name:"list",controller:"CompaniesMainCtrl",layout:t},detail:{name:"detail",controller:"NewCompanyCtrl",layout:a}}},controllerAs:"companyForm",template:'<main-master-detail-directive setup="{{companyForm.masterDetailDefs}}" ></main-master-detail-directive>'})}]),angular.module("ocsApp.MakeBooking",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.makeBooking",{"abstract":!1,url:"/makeBooking",templateUrl:"modules/MakeBooking/views/makeBooking.main.html",controller:"MakeBookingMainCtrl",controllerAs:"MakeBookingMainCtrl"})}]),angular.module("ocsApp.MakePEMPhoneBooking",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.makePEMPhoneBooking",{"abstract":!1,url:"/makePEMPhoneBooking",templateUrl:"modules/MakePEMPhoneBooking/views/makePEMPhoneBooking.main.html",controller:"MakePEMPhoneBookingMainCtrl",controllerAs:"MakePEMPhoneBookingMainCtrl"}).state("authentication.bookingForm",{url:"/bookingForm/:token",views:{"main-content":{templateUrl:"modules/MakePEMPhoneBooking/views/makePEMPhoneBooking.bookingForm.html",controller:"BookingFormCtrl",controllerAs:"BookingFormCtrl"}}})}]),angular.module("ocsApp.MakeTelehealthBooking",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.makeTelehealthBooking",{"abstract":!1,url:"/makeTelehealthBooking",templateUrl:"modules/MakeTelehealthBooking/views/makeTelehealthBooking.main.html",controller:"MakeTelehealthBookingMainCtrl",controllerAs:"MakeTelehealthBookingMainCtrl"})}]),angular.module("ocsApp.Navigator",["toastr","ocsApp.MakeBooking","ocsApp.MakePEMPhoneBooking","ocsApp.MakeTelehealthBooking","ocsApp.TelehealthBookings","ocsApp.Bookings","ocsApp.Positions","ocsApp.Packages","ocsApp.Settings","ocsApp.BookingReports","ocsApp.Companies","ocsApp.Sites","ngIdle","ui.bootstrap"]).config(["$stateProvider",function(e){e.state("navigator",{"abstract":!1,url:"/navigator",views:{root:{templateUrl:"modules/Navigator/views/navigator.main.html",controller:"NavigatorMainCtrl",controllerAs:"NavigatorMainCtrl"}}})}]).config(["IdleProvider","KeepaliveProvider",function(e,t){e.idle(900),e.timeout(10),t.interval(10)}]).run(["Idle",function(e){e.watch()}]),angular.module("ocsApp.Packages",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.packages",{"abstract":!1,url:"/packages",templateUrl:"modules/Packages/views/packages.main.html",controller:"PackagesMainCtrl",controllerAs:"PackagesMainCtrl"})}]),angular.module("ocsApp.Positions",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.positions",{"abstract":!1,url:"/positions",templateUrl:"modules/Positions/views/positions.main.html",controller:"PositionsMainCtrl",controllerAs:"PositionsMainCtrl"})}]),angular.module("ocsApp.Settings",["lbServices","toastr"]).config(["$stateProvider",function(e){e.state("navigator.settings",{"abstract":!1,url:"/settings",templateUrl:"modules/Settings/views/settings.main.html",controller:"SettingsMainCtrl",controllerAs:"SettingsMainCtrl"})}]),angular.module("ocsApp.Sites",["lbServices","MasterDetailDirective","ct.ui.router.extras.sticky","ct.ui.router.extras.dsr","ct.ui.router.extras.statevis"]).config(["$stateProvider","$stickyStateProvider",function(e,t){e.state("navigator.sites",{"abstract":!1,url:"/sites",controller:function(e){e=e.getInstance("ocsApp.Sites"),e.debug("I am controller of Site");var t={div:{type:"div",fieldClass:"portlet box green portet-datatable",fields:{div:{type:"div",isSubmitedVar:"isSubmitted",controllerAs:"SitesMainCtrl",fieldClass:"portlet-title",fields:{div1:{type:"div",fieldClass:"caption bold",fields:{span:{type:"span",label:"Site List",fieldClass:"caption-subject bold uppercase"}}},div2:{type:"div",fieldClass:"tools",fields:{newButton:{type:"button",label:"New Site",fieldClass:"btn btn-primary",ngClick:"detail()"}}}}},div2:{type:"div",fieldClass:"portlet-body",fields:{table:{type:"table",isSort:!0,isSearch:!0,dataSource:"rows",fieldClass:"table table-striped table-bordered table-hover order-column",ngClick:"detail(row)",fields:{companyName:{field:"siteName",displayName:"Site Name",width:"100"},addr:{field:"siteAddr",displayName:"Address",width:"100"},state:{field:"state",displayName:"State",width:"100"},country:{field:"country",displayName:"Country",width:"100"},deleteRow:{type:"button",label:"Delete",displayName:"Action",fieldClass:"btn btn-warning",ngClick:"deleteRow(row)"}}}}}}}},a={div1:{type:"div",fieldClass:"modal-header",controllerAs:"NewSiteCtrl",isSubmitedVar:"isSubmitted",fields:{h3:{type:"h3",label:"{{NewCompanyCtrl.windowTitle}}",fieldClass:"modal-title"}}},div2:{type:"div",fieldClass:"modal-body",fields:{form:{type:"form",name:"form",fieldClass:"form-horizontal form-row-seperated",fields:{companyName:{field:"siteName",ngModel:"row.siteName",label:"Site Name",placeholder:"Site name",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Site name is required"},addr:{field:"siteAddr",ngModel:"row.siteAddr",label:"Address",placeholder:"Address",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},state:{field:"state",ngModel:"row.state",label:"State",placeholder:"State",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{ACT:{label:"Australian Capital Territory"},NSW:{label:"New South Wales"},VIC:{label:"Victoria"},QLD:{label:"Queensland"},SA:{label:"South Australia"},WA:{label:"Western Australia"},NT:{label:"Northern Territory"}}},country:{field:"country",ngModel:"row.country",label:"Country",placeholder:"Country",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{Australia:{label:"Australia"}}}}},div3:{type:"div",fieldClass:"portlet box green",fields:{div1:{type:"div",fieldClass:"portlet-title",fields:{div:{type:"div",label:"Search",fieldClass:"caption"}}},div2:{type:"div",fieldClass:"portlet-body",fields:{form:{type:"form",fieldClass:"form-horizontal",fields:{div:{type:"div",fieldClass:"form-group",fields:{fromDate:{type:"date",ngModel:"fromDate",label:"Date",fieldClass:"form-control",labelClass:"col-md-1",fieldGroupClass:"col-md-3"},toDate:{type:"date",ngModel:"toDate",label:"",fieldClass:"form-control",labelClass:"col-md-1",fieldGroupClass:"col-md-3"},search:{type:"button",label:"Search",ngClick:"filterDetail(NewSiteCtrl.fromDate,NewSiteCtrl.toDate)",fieldClass:"col-md-2 btn btn-primary"}}}}}}}}},table:{type:"table",dataSource:"row.AdminCalendars",isSort:!0,isSearch:!0,fieldClass:"table table-striped table-bordered table-hover order-column",ngClick:"newOrEditRow(row)",fields:{fromTime:{field:"fromTime",displayName:"From time",width:"100",filter:"|dateFilter| date:'dd/MM/yyyy HH:mm'"},available:{field:"available",displayName:"Available",width:"100"}}}}},div3:{type:"div",fieldClass:"modal-footer",fields:{SaveButton:{type:"button",label:"Save",fieldClass:"btn btn-primary",ngClick:"ok()"},CancelButton:{type:"button",label:"Cancel",fieldClass:"btn btn-warning",ngClick:"cancel()"}}}};this.masterDetailDefs={master:{name:"list",controller:"SitesMainCtrl",layout:t},detail:{name:"detail",controller:"NewSiteCtrl",layout:a}}},controllerAs:"companyForm",template:'<main-master-detail-directive setup="{{companyForm.masterDetailDefs}}" ></main-master-detail-directive>'})}]),angular.module("ocsApp.TelehealthBookings",["toastr"]).config(["$stateProvider",function(e){e.state("navigator.telehealthBookings",{"abstract":!1,url:"/telehealthBookings",templateUrl:"modules/TelehealthBookings/views/telehealthBookings.main.html",controller:"TelehealthBookingsMainCtrl",controllerAs:"TelehealthBookingsMainCtrl"})}]),angular.module("ocsApp.Authentication").controller("ForgotPasswordCtrl",["$state","Accounts","toastr","$log",function(e,t,a,o){o=o.getInstance("ocsApp.Authentication.ForgotPasswordCtrl"),o.debug("Hello, I am ForgotPasswordCtrl");var n=this;this.loading1=!1,this.loading2=!1,this.showClickedValidation=!1,this.goBackLogin=function(){o.debug("go back login..."),e.go("authentication.login")},this.forgotPassword=function(){o.debug("forgot password function"),n.showClickedValidation=!0,this.form.username.$error.required&&a.error("Please enter username","Error"),this.form.email.$error.required&&a.error("Please enter email","Error"),n.form.$valid?(o.debug("login",this.username),t.resetPassword({username:this.username,email:this.email},function(e){n.showClickedValidation=!1,o.debug("Send an email to reset pass successfully !",e),o.save(),a.success("Sent an email to reset the password in your email, Please check the email"),n.username="",n.email=""},function(e){o.error("Send an email to reset pass  failed !",e),a.error("Wrong username or password. Please check your username or password","Error")})):o.error("ForgotPasswordCtrl invalid",n.form.$error)}}]),angular.module("ocsApp.Authentication").controller("LoginCtrl",["$state","Accounts","toastr","$cookieStore","CompanyFactory","RedimedSiteFactory","$log","mySharedService","storeToken","mySocket",function(e,t,a,o,n,i,s,r,l,d){s=s.getInstance("ocsApp.Authentication.LoginCtrl"),s.debug("Starting main application"),s.debug("Hello, I am login controller");var c=this;this.loading1=!1,this.loading2=!1,this.showClickedValidation=!1,this.login=function(){this.showClickedValidation=!0,this.loginForm.username.$error.required&&a.error("Please enter username","Error"),this.loginForm.password.$error.required&&a.error("Please enter password","Error"),c.loginForm.$valid?(s.debug("login",this.username),d.emit("msg",{message:"will login into the system with account = "+this.username+" and password = "+this.password}),t.login({username:this.username,password:this.password},function(t,a){n.setCurrentCompany(t.user.Company),n.setCurrentUser(t.user),c.loading1=!0,c.loading2=!0,o.put("firstCompany",t.user.Company),o.put("companies",t.user.AccountCompanies),s.setUser(t.user),s.setAccessToken(t.id),s.debug("Login successfully !",t.user),l.setAccessToken(t.id),n.init(function(a){s.debug("After login, get company info = "),c.loading1=!1,d.emit("login",{message:"Login successfully",userName:t.user.username,userId:t.user.id,companyId:t.user.companyId,companyName:a.companyName}),i.getSite(function(t){c.loading2=!1,c.loading1||c.loading2||(r.prepForBroadcast("Login successfully"),e.go("navigator"))})})},function(e){s.error("Login failed !",e),e.statusText.indexOf("Unauthorized")>=0?a.error("Wrong username or password. Please check your username or password","Error"):a.error("Cannot connect to the server. Please refesh your browser !","Error")})):s.error("form is invalid",c.loginForm.$error)}}]),angular.module("ocsApp.Authentication").controller("AuthenMainCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("ocsApp.Authentication").controller("ResetPasswordCtrl",["$state","Accounts","toastr","$log","$stateParams",function(e,t,a,o,n){o=o.getInstance("ocsApp.Authentication.ResetPasswordCtrl"),o.debug("Hello, I am ResetPasswordCtrl",n.token);var i=this;this.loading1=!1,this.loading2=!1,this.token=n.token,this.showClickedValidation=!1,this.reset=function(){o.debug("forgot password function"),i.showClickedValidation=!0,i.form.password.$error.required&&a.error("Please enter password","Error"),i.form.repassword.$error.required&&a.error("Please enter re-password","Error"),i.form.$valid?i.password==i.repassword?$.post("https://medicalbookings.redimed.com.au:8181/api/Accounts/updatePassword?access_token="+i.token,{password:i.password}).then(function(t){o.debug("succ",t),o.save(),e.go("authentication.login")}).fail(function(e){o.error("error",e),e.statusText.indexOf("Unauthorized")>=0?a.error("Sorry, Time out, please reset password again!","Error"):a.error("Sorry, Can not process to reset password, Please contact Redimed !","Error")}):a.error("Password and Re-password are not match together, Please re-enter again !","Error"):o.error("ForgotPasswordCtrl invalid",i.form.$error)}}]),angular.module("ocsApp.Authentication").factory("CompanyFactory",["Companies","$log","CalendarHoldings",function(e,t,a){function o(a){e.initData(function(e,o){console.log(">initData",e),n=e.initData,t.debug("init company data get data from server"),a(n)},function(e){t.error("init company failed",e)})}var n,i=null,s=null;return t=t.getInstance("ocsApp.Authentication.CompanyFactory"),{init:function(e){o(e)},setCurrentCompany:function(e){i=e},getCurrentCompany:function(){return i},setCurrentUser:function(e){s=e},getCurrentUser:function(){return s},refreshSubsidiaryList:function(a){e.getRediSubsidiaries(function(e){t.debug("refreshSubsidiaryList from server"),n.subsidiaries=e.subsidiaries,a(n)},function(e){t.error("init company failed",e)})},refreshBookingList:function(a){e.listBookings(function(e){t.debug("refreshBookingList from server"),n.allBookings=e.bookings,a(n)},function(e){t.error("refreshBookingList failed",e)})},refreshTelehealthBookingList:function(a){e.listTelehealthBookings(function(e){t.debug("refreshBookingList from server"),n.telehealthBookings=e.bookings,a(n)},function(e){t.error("refreshBookingList failed",e)})},refreshPositionList:function(e){o(e)},refreshPackageList:function(e){o(e)},refreshAllPackageList:function(a){e.getPackages(function(e){t.debug("refreshAllPackageList from server"),n.allViewPackages=e.packages,a(n)},function(e){t.error("refreshPackageList failed",e)})},refreshAccountList:function(a){e.accounts({id:0},function(e){t.debug("refreshAccountList from server"),n.accounts=e,a(n)},function(e){t.error("refreshAccountList failed",e)})},getCompanyId:function(){return null==n?null:n.id},getCompany:function(e){n?(t.debug("getCompany from memory"),e(n)):o(e)}}}]).factory("RedimedSiteFactory",["Companies","$log","CalendarHoldings",function(e,t,a){var o;return t=t.getInstance("RedimedSiteFactory"),{getSite:function(a){o?(t.debug("getSite from memory"),a(o)):e.getSites(function(e){t.debug("getSite from server"),o=e.sites,a(o)},function(e){t.error("getSite from server failed",e)})},getCalendar:function(a,o,n,i){e.getCalendars({id:a,from:o,to:n},function(e){t.debug("getCalendar from server"),i(e.calendars)},function(e){t.error("getCalendar from server failed",e)})},setHolding:function(e,o){t.debug("Will set holding calID = "+e),a.create({holdingId:0,calendarId:e},function(e){t.debug("Hold the calendar =",e),o(e)},function(e){t.error("Holding from server failed",e)})},removeHolding:function(e,o,n){t.debug("Will remove holding calID = "+o),a.deleteById({id:e},function(e){t.debug("Remove the calendar =",e),n(e)},function(e){t.error("Holding from server failed",e)})}}}]).factory("BookingStatusFactory",["Companies","$log",function(e,t){var a;return t=t.getInstance("BookingStatusFactory"),{getStatus:function(o){a?(t.debug("getStatus from memory"),o(a)):e.getStatus(function(e){t.debug("getStatus from server",e),a=e.status,o(a)},function(e){t.error("getStatus from server failed",e)})}}}]),angular.module("ocsApp.Positions").controller("ConfirmToDeletePositionCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.BookingReports").controller("BookingReportsMainCtrl",["BookingCandidateByApptDateV","BookingCandidateByBookingDateV","mysqlDate","mySocket",function(e,t,a,o){function n(e,t){var o=moment(a(e)).format(t);return"Invalid date"==o?"":o}function i(){s.apptSumary=[],s.totalApptToday=0,s.bookingTodaySumary=[],s.totalBookingToday=0,e.find({filter:{where:{apptDate:{between:[s.fromDate,s.toDate]}},order:"apptDate"}},function(e){var t=[],a=[],o="",i=-1,r=[],l=[],d=[],c=["#1c8d62","#2c9ff2","#3cadd2","#4dba62","#5cc162","#61d5b2","#74e4b2","#81fd67","#f91264"],u=[];for(var m in e){var p=_.indexOf(a,e[m].siteName);p==-1&&void 0!=e[m].siteName&&(a.push(e[m].siteName),l.push([]))}a=a.sort();for(var m in e)if(o!=e[m].apptDate+""){var f={};for(var g in a)f[a[g]]=0;i++,o=e[m].apptDate+"",f.apptDate=(e[m].apptDate+"").substr(0,10),f[e[m].siteName]=e[m].quantity,t.push(f)}else t[i][e[m].siteName]=e[m].quantity;l.push([]);for(var m in t)if(dateFortmat=n(t[m].apptDate,"DD MMM"),r.push(dateFortmat),dateFortmat+""==s.todayDate+""){var h=0;for(var g in a){var y=t[m][a[g]];l[g].push(y),h+=y,s.apptSumary.push({site:a[g],quantity:y})}l[a.length].push(h),s.totalApptToday=h}else{var h=0;for(var g in a)l[g].push(t[m][a[g]]),h+=t[m][a[g]];l[a.length].push(h)}a.push("Total");for(var g in a){var b={values:l[g],"line-color":c[g],aspect:"spline","background-color":"#fc8d62","alpha-area":".3","font-family":"Roboto","font-size":"14px",text:a[g]};d.push(b);var k={text:a[g]+": %plot-"+g+"-value","default-value":"",color:c[g],x:5+15*g+"%",y:50,width:120,"text-align":"left",bold:0,"font-size":"12px","font-weight":"bold"};u.push(k)}s.myJson={globals:{"font-family":"Roboto"},graphset:[{type:"area","background-color":"#fff",utc:!0,title:{y:"15px",text:"Patient Attending Today","background-color":"none","font-color":"#05636c","font-size":"24px",height:"25px","adjust-layout":!0},plotarea:{"margin-top":"10%","margin-right":"dynamic","margin-bottom":"dynamic","margin-left":"dynamic","adjust-layout":!0},labels:u,"scale-x":{label:{text:"Date Range","font-size":"14px","font-weight":"normal","offset-x":"10%","font-angle":360},item:{"text-align":"center","font-color":"#05636c"},zooming:1,labels:r,"items-overlap":!0,guide:{"line-width":"0px"},tick:{"line-width":"2px"}},"crosshair-x":{"line-color":"#fff","line-width":1,"plot-label":{visible:!1}},"scale-y":{item:{"font-color":"#05636c","font-weight":"normal"},label:{text:"Metrics","font-size":"14px"},guide:{"line-width":"0px",alpha:.2,"line-style":"dashed"}},plot:{"line-width":2,marker:{size:1,visible:!1},tooltip:{"font-family":"Roboto","font-size":"14px",text:"There were %v %t on %data-days","text-align":"left"}},series:d}]}}),t.find({filter:{where:{bookingDate:{between:[new Date(s.fromDate),new Date(s.toDate)]}},order:"bookingDate"}},function(e){var t=[],a=[],o="",i=-1,r=[],l=[],d=[],c=["#1c8d62","#2c9ff2","#3cadd2","#4dba62","#5cc162","#61d5b2","#74e4b2","#81fd67","#f91264"],u=[];for(var m in e){var p=_.indexOf(a,e[m].siteName);p==-1&&void 0!=e[m].siteName&&(a.push(e[m].siteName),l.push([]))}a=a.sort();for(var m in e)if(o!=e[m].bookingDate+""){var f={};for(var g in a)f[a[g]]=0;i++,o=e[m].bookingDate+"",f.bookingDate=(e[m].bookingDate+"").substr(0,10),f[e[m].siteName]=e[m].quantity,t.push(f)}else t[i][e[m].siteName]=e[m].quantity;l.push([]);for(var m in t)if(dateFortmat=n(t[m].bookingDate,"DD MMM"),r.push(dateFortmat),dateFortmat+""==s.todayDate+""){var h=0;for(var g in a){var y=t[m][a[g]];l[g].push(y),h+=y,s.bookingTodaySumary.push({site:a[g],quantity:y})}l[a.length].push(h),s.totalBookingToday=h}else{var h=0;for(var g in a)l[g].push(t[m][a[g]]),h+=t[m][a[g]];l[a.length].push(h)}a.push("Total");for(var g in a){var b={values:l[g],"line-color":c[g],aspect:"spline","background-color":"#fc8d62","alpha-area":".3","font-family":"Roboto","font-size":"14px",text:a[g]};d.push(b);var k={text:a[g]+": %plot-"+g+"-value","default-value":"",color:c[g],x:5+15*g+"%",y:50,width:120,"text-align":"left",bold:0,"font-size":"12px","font-weight":"bold"};u.push(k)}s.myJson2={globals:{"font-family":"Roboto"},graphset:[{type:"area","background-color":"#fff",utc:!0,title:{y:"15px",text:"New Booking Today","background-color":"none","font-color":"#05636c","font-size":"24px",height:"25px","adjust-layout":!0},plotarea:{"margin-top":"10%","margin-right":"dynamic","margin-bottom":"dynamic","margin-left":"dynamic","adjust-layout":!0},labels:u,"scale-x":{label:{text:"Date Range","font-size":"14px","font-weight":"normal","offset-x":"10%","font-angle":360},item:{"text-align":"center","font-color":"#05636c"},zooming:1,labels:r,"items-overlap":!0,guide:{"line-width":"0px"},tick:{"line-width":"2px"}},"crosshair-x":{"line-color":"#fff","line-width":1,"plot-label":{visible:!1}},"scale-y":{item:{"font-color":"#05636c","font-weight":"normal"},label:{text:"Metrics","font-size":"14px"},guide:{"line-width":"0px",alpha:.2,"line-style":"dashed"}},plot:{"line-width":2,marker:{size:1,visible:!1},tooltip:{"font-family":"Roboto","font-size":"14px",text:"There were %v %t on %data-days","text-align":"left"}},series:d}]}})}console.log("I am booking report controller.");var s=this;this.positions=[],this.myJson={},this.myJson2={},this.dateStatus={},this.dateStatus.fromDateOpened=!1,this.dateStatus.toDateOpened=!1,this.format="dd/MM/yyyy",this.apptSumary=[],this.totalApptToday=0,this.bookingTodaySumary=[],this.totalBookingToday=0,this.todayDate=moment(new Date).format("DD MMM"),this.fromDate=new Date,this.toDate=new Date,this.fromDate.setDate(this.fromDate.getDate()-7),this.toDate.setDate(this.toDate.getDate()+7);var r=[{field:"onlineAt",displayName:"loginAt",width:"150",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm:ss'"},{field:"loginAt",displayName:"loginAt",width:"150",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm:ss'"},{field:"logoutAt",displayName:"logoutAt",width:"150",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm:ss'"},{field:"offlineAt",displayName:"offlineAt",width:"150",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm:ss'"},{field:"userName",displayName:"userName",width:"100"},{field:"socketId",displayName:"socketId",width:"100"},{field:"ip",displayName:"ip",width:"170"},{field:"companyName",displayName:"companyName",width:"100"},{field:"pid",displayName:"pid",width:"100"},{field:"worker",displayName:"worker",width:"100"}];this.gridOptions={enableSorting:!0,enableColumnResizing:!0,enableFiltering:!0,appScopeProvider:this,columnDefs:r,enableGridMenu:!0,enableRowSelection:!1,enableSelectAll:!1,exporterMenuPdf:!1,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location"))},o.on("OnlineUsersData",function(e){console.log("Receive OnlineUsers = "),s.gridOptions.data=e}),o.emit("GetOnlineUsers"),i(),this.openFromDate=function(e){console.log("emitting data"),s.dateStatus.fromDateOpened=!0},this.openToDate=function(e){s.dateStatus.toDateOpened=!0},this.fromOrToDateChanged=function(){i()}}]),angular.module("ocsApp.Positions").controller("NewPositionCtrl",["Positions","$uibModalInstance","position","CompanyFactory","$log","toastr",function(e,t,a,o,n,i){n=n.getInstance("ocsApp.Positions.NewPositionCtrl"),n.debug("I am  new or edit position controller.",a);var s=this;this.form={},this.companyId=o.getCompanyId(),a&&(this.positionName=a.positionName),this.ok=function(){if(s.isSubmitted=!0,s.form.$valid)if(a)n.debug("will update position",a),e.update({where:{id:a.id}},{positionName:s.positionName},function(e){n.debug("updated position",e),i.success("Position was updated successfully",""),t.close({})},function(e){n.error("Fail to update position",e),i.error("Fail to update Position","Error"),t.close({})});else{var o={};o.positionName=s.positionName,o.companyId=s.companyId,o.id=0,console.log(o),e.create(o,function(e){n.debug("created position",e),i.success("Position was created successfully",""),t.close({})},function(e){i.error("Fail to create Position","Error"),n.error("failt to create position",e)})}else n.error("Save postion err ",s.form.$error)},this.cancel=function(){t.dismiss("cancel")}}]),angular.module("ocsApp.Bookings").controller("AdminEditBookingCtrl",["candidate","RedimedSiteFactory","BookingStatusFactory","BookingCandidates","toastr","$uibModalInstance","mysqlDate","$log","CompanyFactory","mySharedService","mysqlDate","$cookieStore","$uibModal","$scope","mySocket",function(e,t,a,o,n,i,s,r,l,d,s,c,u,m,p){function f(){var e=new Date,a=new Date;a.setDate(a.getDate()+60),t.getCalendar(h.site.id,e,a,function(e){h.calendars=e,r.debug("received data from server getCalendar with current calendar =",h.calendar),h.calendar&&h.calendars.unshift(h.calendar)})}function g(){r.debug("will getCalendar....",h.user);var e=new Date,a=new Date;a.setDate(a.getDate()+60),t.getCalendar(h.site.id,e,a,function(e){r.debug("finished getCalendar....",h.user),console.log(" RedimedSiteFactory.getCalendar = ",e),h.calendars=e,h.calendar=h.calendars[_.findIndex(h.calendars,"calId",h.candidate.calendarId)],
h.calendars.length>0?(h.isCalendarList=!0,h.isAppointmentTime=!1):(h.isCalendarList=!1,h.isAppointmentTime=!0),h.user.userType.indexOf("RediMed")==-1&&(h.isAppointmentTime=!1),console.log("that.calendars = ",h.calendars,"that.calendar = ",h.calendar)})}r=r.getInstance("ocsApp.Bookings.AdminEditBookingCtrl"),r.debug("I am admin edit booking ctrl"),r.debug("Candidate = ",e);var h=this,y=e.appointmentStatus,b=0;this.candidate=e,this.user=l.getCurrentUser(),this.sites=[],this.states=[],this.suburbs=[],this.site={},this.state={},this.suburb={},this.calendars=[],this.calendar={},this.statuses=[],this.isSubmitted=!1,this.form={},this.dateStatus={},this.dateStatus.fromDateOpened=!1,this.dateStatus.toDateOpened=!1,this.dateStatus.timeOpened=!1,this.isCalendarList=!1,this.isAppointmentTime=!1,this.apptTimeAfterConvert=null,this.format="dd/MM/yyyy HH:mm",this.apptDateAfterConvert=s(this.candidate.appointmentTime),this.candidate.appointmentTime&&(this.apptTimeAfterConvert=s(this.candidate.appointmentTime)),this.isAppointmentTimeChange=!1,""==this.apptTimeAfterConvert&&(this.apptTimeAfterConvert="00:00"),p.on("UpdateCalendar",function(e){r.debug("refresh calendars by server"),h.site.id&&f()}),m.$watch("AdminEditBookingCtrl.calendar",function(e,a){e!==a&&(a&&t.removeHolding(b,a.calId,function(e){console.log(" holdingData = ",e)}),e&&t.setHolding(e.calId,function(t){console.log(" holdingData = ",t),b=t.holdingId,p.emit("OccupyAppt",e)}),console.log("$watch: that.BookingCandidate.calendar changed.",e,a))}),this.appointmentTimeChanged=function(){h.isAppointmentTimeChange=!0,console.log(this.apptTimeAfterConvert)},this.openTime=function(){h.dateStatus.timeOpened=!0},this.openFromDate=function(e){h.dateStatus.fromDateOpened=!0},a.getStatus(function(e){h.statuses=e,r.debug(" status = ",h.statuses)}),t.getSite(function(e){r.debug("get sites..."),h.sites=e,h.site=h.sites[_.findIndex(h.sites,"id",h.candidate.siteId)],h.site.States.length>0&&(h.states=h.site.States,h.state=h.states[_.findIndex(h.states,"stateName",h.candidate.stateName)],h.state.SubStates.length>0&&(h.suburbs=h.state.SubStates,h.suburb=h.suburbs[_.findIndex(h.suburbs,"suburbName",h.candidate.suburbName)])),h.site&&g()}),this.selectedSite=function(){r.debug("Get calendar from the factory"),h.states=h.site.States,h.suburb=null,h.state=null,h.suburbs=null,g()},this.selectedState=function(){h.state&&(h.suburb=null,h.suburbs=h.state.SubStates)},this.isStates=function(){return null!=h.states&&!(h.states.length<=0)},this.isSuburbs=function(){return null!=h.suburbs&&!(h.suburbs.length<=0)},this.isSendEmailDisabled=function(){return("Confirmed"==this.candidate.appointmentStatus||"Pending"==this.candidate.appointmentStatus)&&!h.isNotSave()},this.isNotSave=function(){return h.form.$pristine},this.isAttended=function(){return"Reschedule"==h.candidate.appointmentStatus||"Confirmed"==h.candidate.appointmentStatus},this.isShowAttendedButton=function(){return h.user.userType.indexOf("RediMed")!=-1},this.attended=function(){var e={};e.appointmentStatus="Attended",o.update({where:{candidateId:h.candidate.candidateId}},e,function(e,t){r.debug("updated successfully"),n.success("Successfully updated. The booking list will refresh shortly !"),h.form.$setPristine(),l.refreshBookingList(function(e){n.success("The booking list has been refresh"),d.prepForBroadcast("Refresh booking list successfully")})},function(e){r.error("updated failed",e),n.error("Fail to update","Error")})},this.sendConfirmationEmail=function(){r.debug("> Will send email to ",h.candidate),h.candidate.appointmentStatus.indexOf("Pending")>=0?o.sendConfirmationEmail({id:h.candidate.candidateId,type:"pending"},function(t){r.debug(">>sendConfirmationEmail",t),t.sentEmailStatus.indexOf("Error")>=0?(n.error(t.sentEmailStatus,"Error"),r.error("> Fail to send email to ",e)):(n.success(t.sentEmailStatus,""),r.debug("> Send email successfullt ",t.sentEmailStatus))}):o.sendConfirmationEmail({id:h.candidate.candidateId,type:"new"},function(t){r.debug(">>sendConfirmationEmail",t),t.sentEmailStatus.indexOf("Error")>=0?(n.error(t.sentEmailStatus,"Error"),r.error("> Fail to send email to ",e)):(n.success(t.sentEmailStatus,""),r.debug("> Send email successfullt ",t.sentEmailStatus))})},this.save=function(t){h.isSubmitted=!0;var a=!1;if(!h.candidate.appointmentTime&&h.calendars.length>0&&(void 0==h.calendar||null==h.calendar)&&t)n.error("Please select the calendar","Error");else if(h.form.$valid){var i={};y.indexOf("Pending")>=0&&(h.calendar||h.apptTimeAfterConvert)&&(i.appointmentStatus="Confirmed",h.candidate.appointmentStatus="Confirmed",a=!0),h.calendar?(y.indexOf("Confirmed")>=0||y.indexOf("Reschedule")>=0)&&h.calendar.calId!=e.calendarId&&(i.appointmentStatus="Reschedule",h.candidate.appointmentStatus="Reschedule",a=!0):(y.indexOf("Confirmed")>=0||y.indexOf("Reschedule")>=0)&&h.apptTimeAfterConvert&&h.isAppointmentTimeChange&&(i.appointmentStatus="Reschedule",h.candidate.appointmentStatus="Reschedule",a=!0),i.appointmentNotes=h.candidate.appointmentNotes,i.siteId=h.site.id,i.siteName=h.site.siteName,(i.siteName.indexOf("Eastern States")>=0||i.siteName.indexOf("WA")>=0||!t)&&(a=!1),h.state?(i.stateName=h.state.stateName,i.stateId=h.state.id):(i.stateName=null,i.stateId=null),h.suburb?(i.suburbName=h.suburb.suburbName,i.suburbId=h.suburb.id):(i.suburbName=null,i.suburbId=null),console.log("that.calendar = ",h.calendar),h.calendar?(i.appointmentTime=moment(s(h.calendar.fromTime)).format("YYYY-MM-DD hh:mm"),i.calendarId=h.calendar.calId):h.apptTimeAfterConvert&&(i.appointmentTime=moment(h.apptDateAfterConvert).format("YYYY-MM-DD")+" "+moment(h.apptTimeAfterConvert).format("hh:mm")),r.debug("will update",i),o.update({where:{candidateId:h.candidate.candidateId}},i,function(e,t){r.debug("updated successfully"),n.success("Successfully updated. The booking list will refresh shortly !"),h.form.$setPristine(),a&&h.sendConfirmationEmail(),l.refreshBookingList(function(e){n.success("The booking list has been refresh"),d.prepForBroadcast("Refresh booking list successfully")})},function(e){r.error("updated failed",e),n.error("Fail to update","Error")})}},this.cancel=function(){i.dismiss("cancel")},this.canCancelAppt=function(){return h.candidate.appointmentStatus.indexOf("Confirmed")>=0||h.candidate.appointmentStatus.indexOf("Reschedule")>=0},this.cancelAppt=function(){i.dismiss("cancel");var e=u.open({templateUrl:"modules/Bookings/views/booking.ConfirmToCancelAppt.html",controller:"ConfirmToCancelApptCtrl",controllerAs:"ConfirmToCancelApptCtrl"});e.result.then(function(e){var t={};t.appointmentNotes=h.candidate.appointmentNotes,t.appointmentStatus="Cancel",t.calendarId=-1,r.debug("will cancel the booking ",t),o.update({where:{candidateId:h.candidate.candidateId}},t,function(e,t){r.debug("updated successfully"),n.success("Successfully updated. The booking list will refresh shortly !"),h.sendConfirmationEmail(),l.refreshBookingList(function(e){n.success("The booking list has been refresh"),d.prepForBroadcast("Refresh booking list successfully")})},function(e){r.error("updated failed",e),n.error("Fail to update","Error")})},function(){r.info("Modal dismissed at: "+new Date)})},this.isAdmin=function(){return h.user.userType.indexOf("RediMed")>=0}}]),angular.module("ocsApp.Bookings").controller("ConfirmToCancelApptCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.Bookings").controller("BookingsMainCtrl",["uiGridConstants","$scope","$window","CompanyFactory","$uibModal","$cookieStore","$log","mysqlDate","mySharedService","Packages","$q",function(e,t,a,o,n,i,s,r,l,d,c){function u(e,t){var a=moment(r(e)).format(t);return"Invalid date"==a?"":a}function m(e,t,a,o){e=e.replace(/\\/g,"");var n=moment(t);if(e){var i=moment(e,"DD/MM/YYYY"),s=i.isAfter(n,"day");if(s)return!1}return!0}function p(e,t,a,o){e=e.replace(/\\/g,"");var n=moment(t);if(e){var i=moment(e,"DD/MM/YYYY"),s=i.isBefore(n,"day");if(s)return!1}return!0}s=s.getInstance("ocsApp.Bookings.BookingsMainCtrl"),s.debug("I am booking list controller.");var f=this;this.window=a;var g=[];this.loading=!1,this.user=o.getCurrentUser();var h={content:[],styles:{header:{bold:!0,color:"#000",fontSize:11},demoTable:{color:"#666",fontSize:10}}};this.openPdf=function(e,t){function a(t){return c(function(a,o){var i=_.where(g,{id:t})[0];i?(n(f.window,e,i),a(i)):d.findById({id:t},function(e){a(e)},function(e){o(e)})})}var o=(_.where(g,{id:e.packageId})[0],a(e.packageId));o.then(function(t){n(e,t)},function(t){n(e,""),s.error("Failed: "+t)});var n=function(e,a){var o="",n=[];s.debug(" printBookingForm has package = ",a);for(var i in a.AssessmentHeaders){var r=a.AssessmentHeaders[i];o=o+"<b>"+r.headerName+"</b><br>",n.push({text:r.headerName,bold:!0});var l=[];for(var d in r.Assessments){var c=r.Assessments[d];o=o+" - "+c.assName+"<br>",l.push(" - "+c.assName)}n.push(l)}s.debug(" pdf printBookingForm has package view = ",n);var m=e.siteName;e.stateName&&(m=m+" - "+e.stateName),e.suburbName&&(m=m+" - "+e.suburbName),h={content:[{text:"Booking Form",style:"header",alignment:"center"},{style:"tableExample",color:"#444",table:{widths:[200,300],headerRows:5,body:[[{text:"Company Details",style:"tableHeader",colSpan:2,alignment:"center"},{}],["Company",e.fatherCompanyName],["Subsidiary",e.companyName],["PO Number",e.poNumber],["Project Identification",e.projectIdentofication],["Booking Person",e.bookingPerson],["Booking Person Contact Number",e.contactNumber],["Results to",e.resultEmail],["Invoices to",e.invoiceEmail],["Comments",e.comments],[{text:"Worker Details",style:"tableHeader",colSpan:2,alignment:"center"},{}],["Candidate Name",e.candidatesName],["Date Of Birth",u(e.dob,"DD/MM/YYYY")],["Phone",e.phone],["Email",e.email],["Position Applied For",e.position],[{text:"Paperwork",style:"tableHeader",colSpan:2,alignment:"center"},{}],[{colSpan:2,text:e.paperwork},""],[{text:"Assessment Details",style:"tableHeader",colSpan:2,alignment:"center"},{}],[{colSpan:2,stack:n},""],[{text:"Appointment Details",style:"tableHeader",colSpan:2,alignment:"center"},{}],["Appointment location",m],["Appointment time",u(e.appointmentTime,"DD/MM/YYYY HH:mm")],["Appointment Notes",e.appointmentNotes],["Appointment status",e.appointmentStatus]]}}],styles:{header:{fontSize:18,bold:!0,margin:[0,0,0,10]},subheader:{fontSize:16,bold:!0,margin:[0,10,0,5]},tableExample:{margin:[0,5,0,15],fontSize:9},tableHeader:{bold:!0,fontSize:11,color:"black"}}},s.debug("Print candidate pdf form",h),t?pdfMake.createPdf(h).download():pdfMake.createPdf(h).open()}},this.downloadPdf=function(){pdfMake.createPdf(h).download()};var y=[{field:"viewCandidate",displayName:"Action",width:"300",enableFiltering:!1,enableCellEdit:!1,cellTemplate:'<button ng-click="grid.appScope.adminEditBooking(row.entity)" class="blue">View Details</button><button ng-click="grid.appScope.openPdf(row.entity,1)" class="blue">Download Form</button>'},{field:"fatherCompanyName",displayName:"Company Name",width:"150"},{field:"companyName",displayName:"Subsidiary",width:"150"},{field:"candidatesName",displayName:"Candidate Name",width:"200",enableCellEdit:!1,cellTemplate:'<a ng-click="grid.appScope.printBookingForm(row.entity)" class="blue">{{row.entity.candidatesName}}</a>'},{field:"appointmentTime",displayName:"Appointment Time",width:"250",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm'",filters:[{condition:m},{condition:p}],filterHeaderTemplate:'<div class="ui-grid-filter-container">from: <input style="display:inline; width:35%"  class="ui-grid-filter-input" date-picker type="text" ng-model="col.filters[0].term"/> - <input style="display:inline; width:35%" class="ui-grid-filter-input" date-picker type="text" ng-model="col.filters[1].term"/></div>'},{field:"siteName",displayName:"Site",width:"100"},{field:"stateName",displayName:"State",width:"100"},{field:"suburbName",displayName:"Suburb",width:"100"},{field:"bookingPerson",displayName:"Booking Person",width:"150"},{field:"comments",displayName:"Booking Comments",width:"200"},{field:"appointmentNotes",displayName:"Notes",width:"200"},{field:"appointmentStatus",displayName:"Status",width:"100"},{field:"projectIdentofication",displayName:"Project Indentification",width:"120"},{field:"poNumber",displayName:"PO Number",width:"120"},{field:"packageName",displayName:"Package Name",width:"200"},{field:"paperwork",displayName:"Paperwork",width:"100"},{field:"email",displayName:"Email",width:"150"},{field:"dob",displayName:"DOB",width:"100",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy'"},{field:"creationDate",displayName:"Creation Date",width:"200",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm'"},{field:"createdBy",displayName:"By",width:"50"},{field:"headerCandidateId",displayName:"Link ID",width:"50"},{field:"issendemail",displayName:"Send Email",width:"50"}];this.isAdmin=function(){return f.user.userType.indexOf("RediMed")>=0},this.adminEditBooking=function(e){var t=n.open({animation:!0,backdrop:"static",templateUrl:"modules/Bookings/views/bookings.adminEditBooking.html",controller:"AdminEditBookingCtrl",controllerAs:"AdminEditBookingCtrl",size:"lg",resolve:{candidate:function(){return e}}});t.result.then(function(e){s.debug("Modal closed at: "+new Date)},function(e){s.debug("Modal dismissed at: "+new Date)})},this.printBookingForm=function(e){function t(t){return c(function(a,o){var n=_.where(g,{id:t})[0];n?(b(f.window,e,n),a(n)):d.findById({id:t},function(e){a(e)},function(e){o(e)})})}var a=(_.where(g,{id:e.packageId})[0],t(e.packageId));a.then(function(t){b(f.window,e,t)},function(t){b(f.window,e,""),s.error("Failed: "+t)})};var b=function(e,t,a){var o="",n=[];s.debug(" printBookingForm has package = ",a);for(var i in a.AssessmentHeaders){var r=a.AssessmentHeaders[i];o=o+"<b>"+r.headerName+"</b><br>",n.push({text:r.headerName,bold:!0});var l=[];for(var d in r.Assessments){var c=r.Assessments[d];o=o+" - "+c.assName+"<br>",l.push(" - "+c.assName)}n.push(l)}s.debug(" printBookingForm has package view = ",o);var m=t.siteName;t.stateName&&(m=m+" - "+t.stateName),t.suburbName&&(m=m+" - "+t.suburbName);var p='<table cellspacing="0" cellpadding="4" align="center" style="border-collapse: collapse"> \n<tbody><tr><td colspan="4" bgcolor="Silver"><b>Booking Details</b></td></tr> \n<tr> \n<td style="border:1px solid gray">Company</td> \n<td style="border:1px solid gray" colspan="3">'+t.fatherCompanyName+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Subsidiary</td> \n<td style="border:1px solid gray" colspan="3">'+t.companyName+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">PO Number</td> \n<td style="border:1px solid gray" colspan="3">'+t.poNumber+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Project Identification</td> \n<td style="border:1px solid gray" colspan="3">'+t.projectIdentofication+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Booking Person</td> \n<td style="border:1px solid gray" colspan="3">'+t.bookingPerson+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Booking Person Contact Number</td> \n<td style="border:1px solid gray" colspan="3">'+t.contactNumber+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Results to</td> \n<td style="border:1px solid gray" colspan="3">'+t.resultEmail+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Invoices to</td> \n<td style="border:1px solid gray" colspan="3">'+t.invoiceEmail+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Comments</td> \n<td style="border:1px solid gray" colspan="3">'+t.comments+'</td> \n</tr> \n<tr><td colspan="4" bgcolor="Silver"><b>Worker Details</b></td></tr> \n<tr> \n<td style="border:1px solid gray">Name</td> \n<td style="border:1px solid gray">'+t.candidatesName+'</td> \n<td style="border:1px solid gray">DOB</td> \n<td style="border:1px solid gray">'+u(t.dob,"DD/MM/YYYY")+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Phone</td> \n<td style="border:1px solid gray">'+t.phone+'</td> \n<td style="border:1px solid gray">Email</td> \n<td style="border:1px solid gray">'+t.email+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Position applied for</td> \n<td style="border:1px solid gray" colspan="3">'+t.position+'</td> \n</tr> \n<tr><td colspan="4" bgcolor="Silver"><b>Paperwork</b></td></tr> \n<tr> \n<td style="border:1px solid gray" colspan="4"> \n'+t.paperwork+'</td></tr> \n<tr><td colspan="4" bgcolor="Silver"><b>Assessment Details</b></td></tr> \n<tr> \n<td style="border:1px solid gray" colspan="4"> \n'+o+'</td></tr> \n<tr><td colspan="4" bgcolor="Silver"><b>Appointment Details</b></td></tr> \n<tr> \n<td style="border:1px solid gray">Appointment location</td> \n<td style="border:1px solid gray" colspan="3">'+m+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Appointment time</td> \n<td style="border:1px solid gray" colspan="3">'+u(t.appointmentTime,"DD/MM/YYYY HH:mm")+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Appointment Notes</td> \n<td style="border:1px solid gray" colspan="3">'+t.appointmentNotes+'</td> \n</tr> \n<tr> \n<td style="border:1px solid gray">Appointment status</td> \n<td style="border:1px solid gray" colspan="3">'+t.appointmentStatus+"</td> \n</tr> \n</tbody></table>";s.debug("Print candidate form",p);var f=e.open("modules/Bookings/views/bookingform.html","","");f.dataFromParent=p},k='<div ng-class="{ red: row.entity.issendemail == null }"><div ng-repeat="(colRenderIndex, col) in colContainer.renderedColumns track by col.colDef.name" class="ui-grid-cell" ng-class="{ \'ui-grid-row-header-cell\': col.isRowHeader }" ui-grid-cell></div></div>';this.gridOptions={enableSorting:!0,rowTemplate:k,enableColumnResizing:!0,enableFiltering:!0,appScopeProvider:this,columnDefs:y,onRegisterApi:function(e){t.gridApi=e,t.gridApi.core.on.sortChanged(t,function(e,t){})},enableGridMenu:!0,enableRowSelection:!1,enableSelectAll:!1,exporterMenuPdf:!1,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location"))},t.$on("handleBroadcast",function(){var e=l.message;s.debug("Received a message from AdminEditBookingCtrl = "+e),e.indexOf("Refresh booking list successfully")>=0&&o.getCompany(function(e){s.debug("Refresh bookings, get company info"),toastr.success("The booking list has been refreshed !"),f.gridOptions.data=e.allBookings})}),this.refreshBooking=function(){s.debug("will refresh booking ; get data from DB......"),f.loading=!0,o.refreshBookingList(function(e){s.debug("refreshed booking ; get data from DB......"),f.gridOptions.data=e.allBookings,f.loading=!1})},o.getCompany(function(e){s.debug("Make booking, get company info"),f.gridOptions.data=e.allBookings,f.loading=!1,g=e.packages})}]),angular.module("dynform",[]).directive("dynamicForm",["$q","$parse","$http","$templateCache","$compile","$document","$timeout",function(e,t,a,o,n,i,s){var r={text:{element:"input",type:"text",editable:!0,textBased:!0},date:{element:"input",type:"date",editable:!0,textBased:!0},datetime:{element:"input",type:"datetime",editable:!0,textBased:!0},"datetime-local":{element:"input",type:"datetime-local",editable:!0,textBased:!0},email:{element:"input",type:"email",editable:!0,textBased:!0},month:{element:"input",type:"month",editable:!0,textBased:!0},number:{element:"input",type:"number",editable:!0,textBased:!0},password:{element:"input",type:"password",editable:!0,textBased:!0},search:{element:"input",type:"search",editable:!0,textBased:!0},tel:{element:"input",type:"tel",editable:!0,textBased:!0},textarea:{element:"textarea",editable:!0,textBased:!0},time:{element:"input",type:"time",editable:!0,textBased:!0},url:{element:"input",type:"url",editable:!0,textBased:!0},week:{element:"input",type:"week",editable:!0,textBased:!0},checkbox:{element:"input",type:"checkbox",editable:!0,textBased:!1},color:{element:"input",type:"color",editable:!0,textBased:!1},file:{element:"input",type:"file",editable:!0,textBased:!1},range:{element:"input",type:"range",editable:!0,textBased:!1},select:{element:"select",editable:!0,textBased:!1},checklist:{element:"div",editable:!1,textBased:!1},fieldset:{element:"fieldset",editable:!1,textBased:!1},radio:{element:"div",editable:!1,textBased:!1},button:{element:"button",type:"button",editable:!1,textBased:!1},hidden:{element:"input",type:"hidden",editable:!1,textBased:!1},image:{element:"input",type:"image",editable:!1,textBased:!1},legend:{element:"legend",editable:!1,textBased:!1},reset:{element:"button",type:"reset",editable:!1,textBased:!1},submit:{element:"button",type:"submit",editable:!1,textBased:!1}};return{restrict:"E",link:function(l,d,c){var u=null,m=!1,p=d,f=null;console.log("> 1  element =",d,"attrs=",c),angular.isDefined(c.ngModel)&&(angular.isDefined(c.template)||angular.isDefined(c.templateUrl))&&!d.hasClass("dynamic-form")&&(f=t(c.ngModel)(l),(c.template?e.when(t(c.template)(l)):a.get(c.templateUrl,{cache:o}).then(function(e){return e.data})).then(function(e){console.log("> 2  template =",e);var t=function(e,t){return props=e.split("."),(t||props.shift())+(props.length?"['"+props.join("']['")+"']":"")},a=function(e,a){console.log("> 3  field =",e," id =",a),"$"!=String(a).charAt(0)&&(angular.isDefined(r[e.type])&&r[e.type]!==!1?(angular.isDefined(e.model)||(e.model=a),u=angular.element(i[0].createElement(r[e.type].element)),angular.isDefined(r[e.type].type)&&u.attr("type",r[e.type].type),angular.isDefined(r[e.type].editable)&&r[e.type].editable&&(u.attr("ng-model",t(e.model,c.ngModel)),console.log("ng-model",t(e.model,c.ngModel)),angular.isDefined(e.required)&&u.attr("ng-required",e.required)),angular.isDefined(r[e.type].textBased)&&r[e.type].textBased&&(angular.isDefined(e.minLength)&&u.attr("ng-minlength",e.minLength),angular.isDefined(e.maxLength)&&u.attr("ng-maxlength",e.maxLength),angular.isDefined(e.validate)&&u.attr("ng-pattern",e.validate),angular.isDefined(e.placeholder)&&u.attr("placeholder",e.placeholder)),console.log("> 4  newElement =",u),this.append(u),u=null):(u=angular.element("<span></span>"),angular.isDefined(e.label)&&angular.element(u).html(e.label),angular.forEach(e,function(e,t){["label","type"].indexOf(t)>-1||u.attr(t,e)}),this.append(u),u=null))};for(angular.forEach(e,a,d);!angular.equals(p.parent(),i)&&!angular.equals(p[0],i[0].documentElement);){if(["form","ngForm","dynamicForm"].indexOf(c.$normalize(angular.lowercase(p.parent()[0].nodeName)))>-1){m=!0;break}p=p.parent()}u=m?angular.element(i[0].createElement("ng-form")):angular.element("<form></form>"),angular.forEach(c.$attr,function(e,t){console.log("adding into form = ",e,c[t]),u.attr(e,c[t])}),u.attr("model",c.ngModel),u.removeAttr("ng-model"),angular.forEach(d[0].classList,function(e){console.log("adding into form = ",e),u[0].classList.add(e)}),u.addClass("dynamic-form"),u.append(d.contents()),u.data("$_cleanModel",angular.copy(f)),u.bind("reset",function(){s(function(){l.$broadcast("reset",arguments)},0)}),l.$on("reset",function(){l.$apply(function(){l[c.ngModel]={}}),l.$apply(function(){l[c.ngModel]=angular.copy(u.data("$_cleanModel"))})}),n(u)(l),d.replaceWith(u)}))}}}]).directive("ngList",[function(){return{require:"?ngModel",link:function(e,t,a,o){var n=/\/(.*)\//.exec(t.attr(a.$attr.ngList)),i=n&&new RegExp(n[1])||t.attr(a.$attr.ngList)||",";(null===t[0].form||angular.element(t[0].form).hasClass("dynamic-form"))&&(o.$parsers.splice(0,1),o.$formatters.splice(0,1),o.$parsers.push(function(e){var t=[];return angular.isString(e)&&(String.prototype.trim?angular.forEach(e.split(i),function(e){e&&t.push(e.trim())}):angular.forEach(e.split(i),function(e){e&&t.push(e.replace(/^\s*/,"").replace(/\s*$/,""))})),t}),o.$formatters.push(function(e){var t=angular.isString(i)&&i||", ";if(angular.isArray(e))return e.join(t)}))}}}]).directive("input",["$parse",function(e){return{restrict:"E",require:"?ngModel",link:function(t,a,o,n){if(n)if("file"===o.type){var i=e(o.ngModel),s=i.assign,r=e(o.onChange),l=function(){t.$apply(function(){s(t,a[0].files),r(t)})};n.$render=function(){a[0].files=this.$viewValue},a.bind("change",l)}else"range"===o.type&&n.$parsers.push(function(e){if(e)return parseFloat(e)})}}}]).factory("fileReader",["$q",function(e){var t=function(e,t,a){return function(){a.$apply(function(){t.resolve(e.result)})}},a=function(e,t,a){return function(){a.$apply(function(){t.reject(e.error)})}},o=function(e,t){return function(a){t.$broadcast("fileProgress",{total:a.total,loaded:a.loaded,status:e.readyState})}},n=function(e,n){var i=new FileReader;return i.onload=t(i,e,n),i.onerror=a(i,e,n),i.onprogress=o(i,n),i};return{readAsArrayBuffer:function(t,a){var o=e.defer(),i=n(o,a);return i.readAsArrayBuffer(t),o.promise},readAsBinaryString:function(t,a){var o=e.defer(),i=n(o,a);return i.readAsBinaryString(t),o.promise},readAsDataURL:function(t,a){var o=e.defer(),i=n(o,a);return i.readAsDataURL(t),o.promise},readAsText:function(t,a){var o=e.defer(),i=n(o,a);return i.readAsText(t),o.promise}}}]),angular.module("dynform",[]).directive("dynamicForm",["$q","$parse","$http","$templateCache","$compile","$document","$timeout",function(e,t,a,o,n,i,s){var r={text:{element:"input",type:"text",editable:!0,textBased:!0},date:{element:"input",type:"date",editable:!0,textBased:!0},datetime:{element:"input",type:"datetime",editable:!0,textBased:!0},"datetime-local":{element:"input",type:"datetime-local",editable:!0,textBased:!0},email:{element:"input",type:"email",editable:!0,textBased:!0},month:{element:"input",type:"month",editable:!0,textBased:!0},number:{element:"input",type:"number",editable:!0,textBased:!0},password:{element:"input",type:"password",editable:!0,textBased:!0},search:{element:"input",type:"search",editable:!0,textBased:!0},tel:{element:"input",type:"tel",editable:!0,textBased:!0},textarea:{element:"textarea",editable:!0,textBased:!0},time:{element:"input",type:"time",editable:!0,textBased:!0},url:{element:"input",type:"url",editable:!0,textBased:!0},week:{element:"input",type:"week",editable:!0,textBased:!0},checkbox:{element:"input",type:"checkbox",editable:!0,textBased:!1},color:{element:"input",type:"color",editable:!0,textBased:!1},file:{element:"input",type:"file",editable:!0,textBased:!1},range:{element:"input",type:"range",editable:!0,textBased:!1},select:{element:"select",editable:!0,textBased:!1},checklist:{element:"div",editable:!1,textBased:!1},fieldset:{element:"fieldset",editable:!1,textBased:!1},radio:{element:"div",editable:!1,textBased:!1},button:{element:"button",type:"button",editable:!1,textBased:!1},hidden:{element:"input",type:"hidden",editable:!1,textBased:!1},image:{element:"input",type:"image",editable:!1,textBased:!1},legend:{element:"legend",editable:!1,textBased:!1},reset:{element:"button",type:"reset",editable:!1,textBased:!1},submit:{element:"button",type:"submit",editable:!1,textBased:!1}};return{restrict:"E",link:function(l,d,c){var u=null,m=null,p={},f="",g=!1,h=d,y=null;console.log("> 1  element =",d,"attrs=",c),angular.isDefined(c.ngModel)&&(angular.isDefined(c.template)||angular.isDefined(c.templateUrl))&&!d.hasClass("dynamic-form")&&(y=t(c.ngModel)(l),(c.template?e.when(t(c.template)(l)):a.get(c.templateUrl,{cache:o}).then(function(e){return e.data})).then(function(e){console.log("> 2  template =",e);var t=function(e,t,a,o,n){t=t.split("."),o=o||t.pop();for(var i=0;i<t.length;i++)e=e[t[i]]=e[t[i]]||{};n||(e[o]=a)},a=function(e,t){return props=e.split("."),(t||props.shift())+(props.length?"['"+props.join("']['")+"']":"")},o=function(e,n){if(console.log("> 3  field =",e," id =",n),"$"!=String(n).charAt(0))if(angular.isDefined(r[e.type])&&r[e.type]!==!1){if(angular.isDefined(e.model)||(e.model=n),u=angular.element(i[0].createElement(r[e.type].element)),angular.isDefined(r[e.type].type)&&u.attr("type",r[e.type].type),angular.isDefined(r[e.type].editable)&&r[e.type].editable&&(u.attr("name",a(e.model)),u.attr("ng-model",a(e.model,c.ngModel)),t(y,e.model,{},null,!0),angular.isDefined(e.readonly)&&u.attr("ng-readonly",e.readonly),angular.isDefined(e.required)&&u.attr("ng-required",e.required),angular.isDefined(e.val)&&(t(y,e.model,angular.copy(e.val)),u.attr("value",e.val))),angular.isDefined(r[e.type].textBased)&&r[e.type].textBased&&(angular.isDefined(e.minLength)&&u.attr("ng-minlength",e.minLength),angular.isDefined(e.maxLength)&&u.attr("ng-maxlength",e.maxLength),angular.isDefined(e.validate)&&u.attr("ng-pattern",e.validate),angular.isDefined(e.placeholder)&&u.attr("placeholder",e.placeholder)),"number"===e.type||"range"===e.type)angular.isDefined(e.minValue)&&u.attr("min",e.minValue),angular.isDefined(e.maxValue)&&u.attr("max",e.maxValue),angular.isDefined(e.step)&&u.attr("step",e.step);else if(["text","textarea"].indexOf(e.type)>-1)angular.isDefined(e.splitBy)&&u.attr("ng-list",e.splitBy);else if("checkbox"===e.type)angular.isDefined(e.isOn)&&u.attr("ng-true-value",e.isOn),angular.isDefined(e.isOff)&&u.attr("ng-false-value",e.isOff),angular.isDefined(e.slaveTo)&&u.attr("ng-checked",e.slaveTo);else if("checklist"===e.type)angular.isDefined(e.val)&&t(y,e.model,angular.copy(e.val)),angular.isDefined(e.options)&&(angular.isDefined(y[e.model])&&angular.isObject(y[e.model])||t(y,e.model,{}),angular.forEach(e.options,function(o,n){m=angular.element('<input type="checkbox" />'),m.attr("name",a(e.model+"."+n)),m.attr("ng-model",a(e.model+"."+n,c.ngModel)),angular.isDefined(o["class"])&&m.attr("ng-class",o["class"]),angular.isDefined(e.disabled)&&m.attr("ng-disabled",e.disabled),angular.isDefined(e.readonly)&&m.attr("ng-readonly",e.readonly),angular.isDefined(e.required)&&m.attr("ng-required",e.required),angular.isDefined(e.callback)&&m.attr("ng-change",e.callback),angular.isDefined(o.isOn)&&m.attr("ng-true-value",o.isOn),angular.isDefined(o.isOff)&&m.attr("ng-false-value",o.isOff),angular.isDefined(o.slaveTo)&&m.attr("ng-checked",o.slaveTo),angular.isDefined(o.val)&&(t(y,e.model,angular.copy(o.val),n),m.attr("value",o.val)),angular.isDefined(o.label)&&(m=m.wrap("<label></label>").parent(),m.append(document.createTextNode(" "+o.label))),u.append(m)}));else if("radio"===e.type)angular.isDefined(e.val)&&t(y,e.model,angular.copy(e.val)),angular.isDefined(e.values)&&angular.forEach(e.values,function(t,o){m=angular.element('<input type="radio" />'),m.attr("name",a(e.model)),m.attr("ng-model",a(e.model,c.ngModel)),angular.isDefined(e["class"])&&m.attr("ng-class",e["class"]),angular.isDefined(e.disabled)&&m.attr("ng-disabled",e.disabled),angular.isDefined(e.callback)&&m.attr("ng-change",e.callback),angular.isDefined(e.readonly)&&m.attr("ng-readonly",e.readonly),angular.isDefined(e.required)&&m.attr("ng-required",e.required),m.attr("value",o),angular.isDefined(e.val)&&e.val===o&&m.attr("checked","checked"),t&&(m=m.wrap("<label></label>").parent(),m.append(document.createTextNode(" "+t))),u.append(m)});else if("select"===e.type)angular.isDefined(e.multiple)&&e.multiple!==!1&&u.attr("multiple","multiple"),angular.isDefined(e.empty)&&e.empty!==!1&&u.append(angular.element(i[0].createElement("option")).attr("value","").html(e.empty)),angular.isDefined(e.autoOptions)?u.attr("ng-options",e.autoOptions):angular.isDefined(e.options)&&(angular.forEach(e.options,function(e,t){m=angular.element(i[0].createElement("option")),m.attr("value",t),angular.isDefined(e.disabled)&&m.attr("ng-disabled",e.disabled),angular.isDefined(e.slaveTo)&&m.attr("ng-selected",e.slaveTo),angular.isDefined(e.label)&&m.html(e.label),angular.isDefined(e.group)?(angular.isDefined(p[e.group])||(p[e.group]=angular.element(i[0].createElement("optgroup")),p[e.group].attr("label",e.group)),p[e.group].append(m)):u.append(m)}),angular.equals(p,{})||(angular.forEach(p,function(e){u.append(e)}),p={}));else if("image"===e.type)angular.isDefined(e.label)&&u.attr("alt",e.label),angular.isDefined(e.source)&&u.attr("src",e.source);else if("hidden"===e.type)u.attr("name",a(e.model)),u.attr("ng-model",a(e.model,c.ngModel)),angular.isDefined(e.val)&&(t(y,e.model,angular.copy(e.val)),u.attr("value",e.val));else if("file"===e.type)angular.isDefined(e.multiple)&&u.attr("multiple",e.multiple);else if("fieldset"===e.type&&angular.isDefined(e.fields)){
var s=u;angular.forEach(e.fields,o,u),u=s}"radio"!==e.type&&(angular.isDefined(e["class"])&&u.attr("ng-class",e["class"]),"checklist"!==e.type&&(angular.isDefined(e.disabled)&&u.attr("ng-disabled",e.disabled),angular.isDefined(e.callback)&&(f=["button","fieldset","image","legend","reset","submit"].indexOf(e.type)>-1?"ng-click":"ng-change",u.attr(f,e.callback)))),angular.isDefined(e.label)&&(["image","hidden"].indexOf(e.type)>-1?angular.noop():["fieldset"].indexOf(e.type)>-1?u.prepend(angular.element(i[0].createElement("legend")).html(e.label)):["button","legend","reset","submit"].indexOf(e.type)>-1?u.html(e.label):(u=u.wrap("<label></label>").parent(),u.prepend(document.createTextNode(e.label+" ")))),angular.isDefined(e.attributes)&&angular.forEach(e.attributes,function(e,t){u.attr(t,e)}),console.log("> 4  newElement =",u),this.append(u),u=null}else u=angular.element("<span></span>"),angular.isDefined(e.label)&&angular.element(u).html(e.label),angular.forEach(e,function(e,t){["label","type"].indexOf(t)>-1||u.attr(t,e)}),this.append(u),u=null};for(angular.forEach(e,o,d);!angular.equals(h.parent(),i)&&!angular.equals(h[0],i[0].documentElement);){if(["form","ngForm","dynamicForm"].indexOf(c.$normalize(angular.lowercase(h.parent()[0].nodeName)))>-1){g=!0;break}h=h.parent()}u=g?angular.element(i[0].createElement("ng-form")):angular.element("<form></form>"),angular.forEach(c.$attr,function(e,t){console.log("adding into form = ",e,c[t]),u.attr(e,c[t])}),u.attr("model",c.ngModel),u.removeAttr("ng-model"),angular.forEach(d[0].classList,function(e){console.log("adding into form = ",e),u[0].classList.add(e)}),u.addClass("dynamic-form"),u.append(d.contents()),u.data("$_cleanModel",angular.copy(y)),u.bind("reset",function(){s(function(){l.$broadcast("reset",arguments)},0)}),l.$on("reset",function(){l.$apply(function(){l[c.ngModel]={}}),l.$apply(function(){l[c.ngModel]=angular.copy(u.data("$_cleanModel"))})}),n(u)(l),d.replaceWith(u)}))}}}]).directive("ngList",[function(){return{require:"?ngModel",link:function(e,t,a,o){var n=/\/(.*)\//.exec(t.attr(a.$attr.ngList)),i=n&&new RegExp(n[1])||t.attr(a.$attr.ngList)||",";(null===t[0].form||angular.element(t[0].form).hasClass("dynamic-form"))&&(o.$parsers.splice(0,1),o.$formatters.splice(0,1),o.$parsers.push(function(e){var t=[];return angular.isString(e)&&(String.prototype.trim?angular.forEach(e.split(i),function(e){e&&t.push(e.trim())}):angular.forEach(e.split(i),function(e){e&&t.push(e.replace(/^\s*/,"").replace(/\s*$/,""))})),t}),o.$formatters.push(function(e){var t=angular.isString(i)&&i||", ";if(angular.isArray(e))return e.join(t)}))}}}]).directive("input",["$parse",function(e){return{restrict:"E",require:"?ngModel",link:function(t,a,o,n){if(n)if("file"===o.type){var i=e(o.ngModel),s=i.assign,r=e(o.onChange),l=function(){t.$apply(function(){s(t,a[0].files),r(t)})};n.$render=function(){a[0].files=this.$viewValue},a.bind("change",l)}else"range"===o.type&&n.$parsers.push(function(e){if(e)return parseFloat(e)})}}}]).factory("fileReader",["$q",function(e){var t=function(e,t,a){return function(){a.$apply(function(){t.resolve(e.result)})}},a=function(e,t,a){return function(){a.$apply(function(){t.reject(e.error)})}},o=function(e,t){return function(a){t.$broadcast("fileProgress",{total:a.total,loaded:a.loaded,status:e.readyState})}},n=function(e,n){var i=new FileReader;return i.onload=t(i,e,n),i.onerror=a(i,e,n),i.onprogress=o(i,n),i};return{readAsArrayBuffer:function(t,a){var o=e.defer(),i=n(o,a);return i.readAsArrayBuffer(t),o.promise},readAsBinaryString:function(t,a){var o=e.defer(),i=n(o,a);return i.readAsBinaryString(t),o.promise},readAsDataURL:function(t,a){var o=e.defer(),i=n(o,a);return i.readAsDataURL(t),o.promise},readAsText:function(t,a){var o=e.defer(),i=n(o,a);return i.readAsText(t),o.promise}}}]),angular.module("ocsApp.Companies").controller("ConfirmToDeleteCompanyCtrl",["$uibModalInstance","row",function(e,t){this.formDefines={div1:{type:"div",fieldClass:"modal-header",fields:{h3:{type:"h3",fieldClass:"modal-title",label:"Delete Company",controllerAs:"ConfirmToDeleteCompanyCtrl"}}},div2:{type:"div",fieldClass:"modal-body",fields:{h3:{type:"h3",fieldClass:"modal-title",label:"Do you want to delete company ?"}}},div3:{type:"div",fieldClass:"modal-footer",fields:{btn1:{type:"button",fieldClass:"btn btn-primary",ngClick:"ok()",label:"Save"},btn2:{type:"button",fieldClass:"btn btn-warning",ngClick:"cancel()",label:"Cancel"}}}},this.ok=function(){e.close(t)},this.cancel=function(){e.dismiss(t)}}]),angular.module("ocsApp.Companies").controller("CompaniesMainCtrl",["$uibModal","Companies","$log","DetailModal","DeleteModal","$state","CompanyModuleFactory","$scope",function(e,t,a,o,n,i,s,r){TableBaseCtrl.call(this,r,a,s,n,"CompaniesMainCtrl");this.isSubmitted=!1,this.form={},this.company={},this.setDeleteTemplateUrl('<my-dynamic-form formdefine = "{{ConfirmToDeleteCompanyCtrl.formDefines}}" ></my-dynamic-form>'),this.setDeleteController("ConfirmToDeleteCompanyCtrl"),this.setDeleteWindowSize("md"),this.setCloseDeleteModal(function(e){s.deleteCompany(e)}),this.detail=function(e){console.log("rowData",e),e?i.go("navigator.companies.detail",{row:e.id}):i.go("navigator.companies.detail",{row:null})}}]),angular.module("ocsApp.Companies").controller("NewCompanyCtrl",["$state","$stateParams","Companies","$log","toastr","BookingStatusFactory","DetailModal2","DeleteModal","CompanyModuleFactory",function(e,t,a,o,n,i,s,r,l){var d=parseInt(t.row),c=l.getMasterRow(d),u=this;DetailWithTableBaseCtrl.call(this,l,c,o,n,s,r,"NewCompanyCtrl"),this.row.defaultStatusObject={},this.bookingStatus=[],this.setDetailTemplateUrl('<my-dynamic-form formdefine = "{{NewSubCompanyCtrl.formDefines}}" ></my-dynamic-form>'),this.setDetailController("NewSubCompanyCtrl"),this.setDetailWindowSize("lg"),this.cancel=function(){e.go("navigator.companies.list")},c?this.windowTitle="Update Company":this.windowTitle="New Company",o.debug("modalTitle = ",this.windowTitle),i.getStatus(function(e){u.bookingStatus=e,u.row.defaultStatusObject=u.bookingStatus[_.findIndex(u.bookingStatus,"bookingStatus",u.row.defaultStatus)],console.log(" get status = ",e,u.row.defaultStatusObject)})}]),angular.module("ocsApp.Companies").controller("NewSubCompanyCtrl",["Companies","row","$log","toastr","BookingStatusFactory","$uibModalInstance","DetailModal","DeleteModal",function(e,t,a,o,n,i,s,r){DetailWithTableBaseCtrl.call(this,i,t,a,o,s,r,"NewSubCompanyCtrl");var l=this;this.row.defaultStatusObject={},this.bookingStatus=[],t?this.windowTitle="Update Sub Company":this.windowTitle="New Sub Company",a.debug("modalTitle = ",this.windowTitle),n.getStatus(function(e){l.bookingStatus=e,l.row.defaultStatusObject=l.bookingStatus[_.findIndex(l.bookingStatus,"bookingStatus",l.row.defaultStatus)],console.log(" get status = ",e,l.row.defaultStatusObject)}),this.saveRow=function(){a.debug("saveRow....."),t?(a.debug("will update company",t),l.row.defaultStatusObject&&(l.row.defaultStatus=l.row.defaultStatusObject.bookingStatus),e.update({where:{id:l.row.id}},l.row,function(e){a.debug("updated company",e),o.success("Company was updated successfully",""),l.closeModalAfterSave()},function(e){a.error("Fail to update position",e),o.error("Fail to update Position","Error")})):(l.row.defaultStatusObject&&(l.row.defaultStatus=l.row.defaultStatusObject.bookingStatus),l.row.id=0,a.debug("will create new company",t),e.create(l.row,function(e){a.debug("created company",e),o.success("Company was created successfully",""),i.close({})},function(e){o.error("Fail to create Position","Error"),a.error("failt to create position",e)}))},this.formDefines={div1:{type:"div",fieldClass:"modal-header",controllerAs:"NewSubCompanyCtrl",isSubmitedVar:"isSubmitted",fields:{h3:{type:"h3",label:"{{NewSubCompanyCtrl.windowTitle}}",fieldClass:"modal-title"}}},div2:{type:"div",fieldClass:"modal-body",fields:{form:{type:"form",name:"form",fieldClass:"form-horizontal form-row-seperated",fields:{companyName:{field:"companyName",ngModel:"row.companyName",label:"Company Name",placeholder:"Company name",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},addr:{field:"addr",ngModel:"row.addr",label:"Address",placeholder:"Address",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},state:{field:"state",ngModel:"row.state",label:"State",placeholder:"State",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!0,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{ACT:{label:"Australian Capital Territory"},NSW:{label:"New South Wales"},VIC:{label:"Victoria"},QLD:{label:"Queensland"},SA:{label:"South Australia"},WA:{label:"Western Australia"},NT:{label:"Northern Territory"}}},country:{field:"country",ngModel:"row.country",label:"Country",placeholder:"Country",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required",empty:"nothing selected",options:{Australia:{label:"Australia"}}},defaultStatus:{field:"defaultStatus",ngModel:"row.defaultStatusObject",label:"Default Status",placeholder:"Default status",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"select",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",ngOptions:"status.bookingStatus for status in NewCompanyCtrl.bookingStatus"},description:{field:"description",ngModel:"row.description",label:"Description",placeholder:"Description",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},industry:{field:"industry",ngModel:"row.industry",label:"Industry",placeholder:"Industry",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},invoiceEmail:{field:"invoiceEmail",ngModel:"row.invoiceEmail",label:"Invoice Email",placeholder:"Invoice email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Invoice email is required",emailHelpBlock:"Email is invalid"},resultEmail:{field:"resultEmail",ngModel:"row.resultEmail",label:"Result Email",placeholder:"Result email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Result email is required",emailHelpBlock:"Email is invalid"},reportToEmail:{field:"reportToEmail",ngModel:"row.reportToEmail",label:"Report Email",placeholder:"",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"email",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Report email is required",emailHelpBlock:"Email is invalid"},fieldGroup:{type:"horizontalFieldGroup",fieldClass:"col-md-12",columnClass:"col-md-3",fields:{isaddcontactemailtoresult:{field:"isaddcontactemailtoresult",ngModel:"row.isaddcontactemailtoresult",label:"Is Result Email",placeholder:"Is Result Email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},isinvoiceemailtouser:{field:"isinvoiceemailtouser",ngModel:"row.isinvoiceemailtouser",label:"Is Invoice Email",placeholder:"Is Invoice Email",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},ispo:{field:"ispo",ngModel:"row.ispo",label:"PO",placeholder:"PO",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0},isproject:{field:"isproject",ngModel:"row.isproject",label:"Project",placeholder:"Project",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"checkbox",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-8 control-label",fieldGroupClass:"col-md-4",formGroupClass:"col-md-3",isOn:1,isOff:0}}},poNumber:{field:"poNumber",ngModel:"row.poNumber",label:"PO Number",placeholder:"PO Number",width:"100",isList:!1,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"}}}}},div3:{type:"div",fieldClass:"modal-footer",fields:{SaveButton:{type:"button",label:"Save",fieldClass:"btn btn-primary",ngClick:"ok()"},CancelButton:{type:"button",label:"Cancel",fieldClass:"btn btn-warning",ngClick:"cancel()"}}}},console.log(this.formDefines)}]),angular.module("ocsApp.Companies").factory("CompanyModuleFactory",["Companies","$log","toastr","$rootScope","$state",function(e,t,a,o,n){t=t.getInstance("ocsApp.Companies.CompanyModuleFactory");var i=null,s="",r=function(t){e.find({filter:{include:"subsidiaries"}},function(e){console.log("Get company from server",e),i=e,t(i)})};return{getMasterRows:function(e){i?(console.log("Get company from memory",i),e(i)):r(e)},refreshMasterRows:function(e){r(e)},getMasterRow:function(e){if(i){var t=i[_.findIndex(i,"id",e)];return console.log("get company from memory= ",e,t,i),t}return{}},deleteMasterRow:function(o){var n=this;t.debug("This is a custom closeDeleteModal function",o),e.deleteById({id:o.id},function(e){console.log(e),t.debug("Successfully delete company",e),n.refreshMasterRows(function(e){n.masterDetailBroadcast("Delete Master Successfully")})},function(e){t.error("Fail to delete company",e),a.error("Fail to delete the company. "+e.data.error.message,"error")})},masterDetailBroadcast:function(e){s=e,o.$broadcast("MasterDetailBroadcast")},getMessage:function(){return s},saveMaster:function(o){var i=this;o.id?(t.debug("will update company",o),o.defaultStatusObject&&(o.defaultStatus=o.defaultStatusObject.bookingStatus),e.update({where:{id:o.id}},o,function(e){t.debug("updated company",e),a.success("Company was updated successfully",""),n.go("navigator.companies.list"),i.refreshMasterRows(function(e){i.masterDetailBroadcast("Update Master Successfully")})},function(e){t.error("Fail to update position",e),a.error("Fail to update Position "+e.data.error.message,"Error")})):(o.defaultStatusObject&&(o.defaultStatus=o.defaultStatusObject.bookingStatus),o.id=0,t.debug("will create new company",o),e.create(o,function(e){t.debug("created company",e),a.success("Company was created successfully",""),n.go("navigator.companies.list"),i.refreshMasterRows(function(e){i.masterDetailBroadcast("Insert Master Successfully")})},function(e){a.error("Fail to create Position","Error"),a.error("Fail to create Position "+e.data.error.message,"Error")}))}}}]),angular.module("ocsApp").controller("IndexMainCtrl",["$log","mySharedService","$scope","SetClassService","$location",function(e,t,a,o,n){e=e.getInstance("ocsApp.IndexMainCtrl"),e.debug("Hello, I am index controller and url = "+n.path()),this.className=0;var i=this;this.className=o.getClass(),n.path().indexOf("bookingForm")>0&&(this.className=2),a.$on("handleBroadcast",function(){var a=t.message;e.debug("Received a message from LoginCrtl/navigator.MainCtrl = "+a),(a.indexOf("Login successfully")>=0||a.indexOf("Logout successfully")>=0)&&i.changeIt()}),this.changeIt=function(){1==this.className?this.className=0:this.className=1,e.debug("changeIt className to  "+this.className)}}]),angular.module("ocsApp.MakeBooking").controller("CustomPackageCtrl",["$uibModalInstance","CompanyFactory","$log",function(e,t,a){a=a.getInstance("ocsApp.MakeBooking.CustomPackageCtrl"),a.debug("I am CustomPackageCtrl");var o=this;this.companyObject=null,this.assessments=[],t.getCompany(function(e){o.companyObject=e}),this.selectedAss=function(){a.debug("assessments = ",o.assessments)},this.ok=function(){e.close(o.assessments)},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.MakeBooking").controller("MakeBookingMainCtrl",["CompanyFactory","$scope","$cookieStore","$uibModal","$log","toastr","mysqlDate","MakeBookingFactory","mySharedService",function(e,t,a,o,n,i,s,r,l){function d(e,t){n.debug("Update PO,Emails,..."),t.poNumber&&(u.newBooking.poNumber=t.poNumber),t.invoiceEmail?1==e.isinvoiceemailtouser?(u.newBooking.invoiceEmail=t.invoiceEmail,NaN+u.user.contactEmail):u.newBooking.invoiceEmail=t.invoiceEmail:1==e.isinvoiceemailtouser&&(u.newBooking.invoiceEmail=u.user.contactEmail),t.resultEmail?1==e.isaddcontactemailtoresult?u.newBooking.resultEmail=t.resultEmail+"; "+u.user.contactEmail:u.newBooking.resultEmail=t.resultEmail:1==e.isaddcontactemailtoresult&&(u.newBooking.resultEmail=u.user.contactEmail)}n=n.getInstance("ocsApp.MakeBooking.MakeBookingMainCtrl"),n.debug("I am make booking controller.");var c=e.getCurrentUser();this.user=e.getCurrentUser(),this.companyObject=null,this.newBooking={},this.newBooking.poNumber="",this.newBooking.newCandidates=[],this.subsidiary={},this.subsidiary2={},this.viewPackage="",this.form={},this.isSubmitted=!1,this.isSubmitingToTheServer=!1,this.isSubsidiary2=!1,this.isNoCandidate=!1,this.paperworkList=["Redimed","Gorgon","BP","Company Specific","CPPC","Rail","Wheatstone","MACA Mining","Aerison paperwork","Newmont","Shell"],this.newBooking.paperwork="Redimed";var u=this,m=function(){e.getCompany(function(e){u.companyObject=e,d(u.companyObject,u.companyObject),n.debug("Make booking, get company info")})};m(),t.$on("handleBroadcast",function(){var e=l.message;n.debug("Received a message from ChangeCompanyCtrl = "+e),e.indexOf("Refresh make booking")>=0&&m()}),this.getAllSubsidiaries=function(e){n.debug("getAllSubsidiaries.Loading subsidiaries......",u.companyObject.subsidiaries),e(u.companyObject.subsidiaries)},this.isAdminLogin=function(){return c.userType.indexOf("RediMed")>=0},this.newCompany=function(){var e=o.open({animation:!0,templateUrl:"modules/MakeBooking/views/makeBooking.NewCompany.html",controller:"NewCompanyCtrl",controllerAs:"NewCompanyCtrl",size:"md"});e.result.then(function(e){n.debug("newCompany = ",e),r.newSubsidiaryForRedimed(e).then(function(e){n.debug("created new company sucessfully = ",e),u.newBooking.subsidiary=e,u.subsidiary=e,u.companyObject.subsidiaries.push(e)})},function(){n.debug("Modal New company dismissed at: "+new Date)})},this.submitForm=function(){u.isSubmitted=!0,!u.newBooking.subsidiary&&u.isAdminLogin()&&(u.form.company.$invalid=!0),u.newBooking.newCandidates.length>0?u.isNoCandidate=!1:(u.isNoCandidate=!0,i.error("Please enter candidate information","Error"),n.error("Please enter candidate information"),u.newCandidate()),u.form.$invalid||u.form.company.$invalid?(i.error("Please enter all required fields of booking information","Error"),n.error("Please enter all required fields of booking information",u.form.$error)):(u.isSubmitingToTheServer=!0,r.submitBooking(u.newBooking,u.companyObject,c).then(function(e){u.isSubmitingToTheServer=!1,n.debug("Submit booking successfully",e),i.success("Successfully submitted"),i.success("The booking list will be updated shortly. Please wait !"),u.newBooking={},u.newBooking.newCandidates=[],u.isSubmitted=!1},function(e){u.isSubmitingToTheServer=!1,n.error("Fail to submit booking",e)}))},this.selectedSubsidiary=function(e){n.debug("selectedSubsidiary = ",e),u.newBooking.subsidiary=e,u.subsidiary2={},u.newBooking.subsidiary.subsidiaries?this.isSubsidiary2=u.newBooking.subsidiary.subsidiaries.length>0:this.isSubsidiary2=!1,d(u.companyObject,u.newBooking.subsidiary)},this.isShowSubsidiary2=function(){return this.isSubsidiary2},this.selectedPackage=function(){if(n.debug("Package =",u.newBooking["package"]),u.newBooking["package"].packageName.indexOf("Custom")>=0){u.viewPackage="";var e=o.open({animation:!0,templateUrl:"modules/MakeBooking/views/makeBooking.CustomPackage.html",controller:"CustomPackageCtrl",controllerAs:"CustomPackageCtrl",size:"lg"});e.result.then(function(e){u.newBooking.customPackage=e,u.newCandidate()},function(){n.debug("Modal Package dismissed at: "+new Date)})}else{u.viewPackage="";for(var t in u.newBooking["package"].AssessmentHeaders){u.viewPackage=u.viewPackage+"<br><b>"+u.newBooking["package"].AssessmentHeaders[t].headerName+"</b>";for(var a in u.newBooking["package"].AssessmentHeaders[t].Assessments)u.viewPackage=u.viewPackage+"<br> - "+u.newBooking["package"].AssessmentHeaders[t].Assessments[a].assName}n.debug("View package:",u.viewPackage),u.newCandidate()}},this.isPO=function(){return 1==u.companyObject.ispo},this.isProjectIdentification=function(){return 1==u.companyObject.isproject},this.deleteCandidate=function(e,t){n.debug("Remove candidate at "+e,t),u.newBooking.newCandidates.splice(e,1)},this.newCandidate=function(e,t){n.debug("New/replace candidate ",t," index = ",e);var a=o.open({animation:!0,templateUrl:"modules/MakeBooking/views/makeBooking.NewCandidate.html",controller:"NewCandidateCtrl",controllerAs:"NewCandidateCtrl",size:"lg",resolve:{candidate:function(){return t},indexOfCandidate:function(){return e}}});a.result.then(function(e){var t=e.index,a=e.candidate;t>=0?(n.debug("repleace the candidate in the array with index = "+t,a),u.newBooking.newCandidates[t]=a):(n.debug("add candidate into array",a),u.newBooking.newCandidates.push(a))},function(){n.debug("Modal Candidate dismissed at: "+new Date)})}}]),angular.module("ocsApp.MakeBooking").controller("NewCandidateCtrl",["$uibModalInstance","CompanyFactory","RedimedSiteFactory","mysqlDate","$log","candidate","indexOfCandidate","$scope","mySocket",function(e,t,a,o,n,i,s,r,l){function d(){var e=new Date(c.BookingCandidate.preferredToDate);console.log("newDate = ",e),isNaN(e)&&(e=new Date(c.BookingCandidate.preferredFromDate)),e.setDate(e.getDate()+2),console.log("newDate = ",e),n.debug("will getCalendar with current calendar =",c.BookingCandidate.calendar),c.BookingCandidate.site.id&&a.getCalendar(c.BookingCandidate.site.id,c.BookingCandidate.preferredFromDate,e,function(e){c.calendars=e,n.debug("received data from server getCalendar with current calendar =",c.BookingCandidate.calendar),c.BookingCandidate.calendar&&c.calendars.unshift(c.BookingCandidate.calendar)})}n=n.getInstance("ocsApp.MakeBooking.NewCandidateCtrl"),n.debug("I am NewCandidateCtrl");var c=this;this.status={},this.BookingCandidate={},this.dateStatus={},this.dateStatus.dobOpened=!1,this.dateStatus.fromDateOpened=!1,this.dateStatus.toDateOpened=!1,this.format="dd/MM/yyyy",this.BookingCandidate.dob=new Date(1990,0,1);var u=new Date,m=new Date,p=0;m.setDate(u.getDate()+7),this.BookingCandidate.preferredFromDate=u,this.BookingCandidate.preferredToDate=m,this.BookingCandidate.holdingId=0,this.companyObject=null,this.sites=null,this.states=null,this.suburbs=null,this.calendars=[{id:1},{id:2}],this.isSubmitted=!1,this.newCandidateForm={},i&&(this.BookingCandidate=i,d()),t.getCompany(function(e){c.companyObject=e}),a.getSite(function(e){c.sites=e,n.debug("sites",c.sites)}),l.on("UpdateCalendar",function(e){n.debug("refresh calendars by server",e),c.BookingCandidate.site.id&&d()}),r.$watch("NewCandidateCtrl.BookingCandidate.calendar",function(e,t){e!==t&&(t&&a.removeHolding(p,t.calId,function(e){console.log(" holdingData = ",e)}),e&&a.setHolding(e.calId,function(t){console.log(" holdingData = ",t),p=t.holdingId,c.BookingCandidate.holdingId=t.holdingId,l.emit("OccupyAppt",e)}),console.log("$watch: that.BookingCandidate.calendar changed.",e,t))}),this.calendarChanged=function(){},this.fromOrToDateChanged=function(){d()},this.selectedSite=function(){c.states=c.BookingCandidate.site.States,c.BookingCandidate.suburb=null,c.BookingCandidate.state=null,c.suburbs=null,c.BookingCandidate.calendar=null,d()},this.selectedState=function(){c.BookingCandidate.state&&(c.suburbs=c.BookingCandidate.state.SubStates)},this.isStates=function(){return null!=c.states&&!(c.states.length<=0)},this.isSuburbs=function(){return null!=c.suburbs&&!(c.suburbs.length<=0)},this.openDOB=function(e){c.dateStatus.dobOpened=!0},this.openFromDate=function(e){c.dateStatus.fromDateOpened=!0},this.openToDate=function(e){c.dateStatus.toDateOpened=!0},this.ok=function(){if(c.isSubmitted=!0,c.newCandidateForm.$valid){n.debug("Exit candidate valid",c.BookingCandidate);var t={};t.index=s,t.candidate=c.BookingCandidate,e.close(t)}else n.error("Exit candidate error",c.newCandidateForm.$error)},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.MakeBooking").controller("NewCompanyCtrl",["$uibModalInstance","$log",function(e,t){t=t.getInstance("ocsApp.MakeBooking.NewCompanyCtrl"),t.debug("NewCompanyCtrl is running...");var a=this;this.company={},this.companyObject=null,this.isSubmitted=!1,this.form={},this.ok=function(){a.isSubmitted=!0,t.debug("OK to exit modal valid=",a.form.$valid),t.debug("OK to exit modal invalid=",a.form.$invalid),t.debug("OK to exit modal error=",a.form.$error),a.form.$valid&&e.close(a.company)},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.MakeBooking").factory("MakeBookingFactory",["BookingHeaders","toastr","BookingCandidates","$q","CompanyFactory","mysqlDate","Companies","$log","mySharedService",function(e,t,a,o,n,i,s,r,l){return r=r.getInstance("ocsApp.MakeBooking.MakeBookingFactory"),{submitBooking:function(s,d,c){r.debug("will submit the booking");var u=o.defer(),m={};m.bookingId=0,m.poNumber=s.poNumber,m.resultEmail=s.resultEmail,m.invoiceEmail=s.invoiceEmail,m.projectIdentofication=s.projectIdentification,m.comments=s.comments,m.packageId=s["package"].id,m.siteId=null,m.companyId=d.id,m.period=null,m.isbookingatredimed=d.id,m.paperwork=s.paperwork,s.bookingPerson?(m.bookingPerson=s.bookingPerson,m.contactNumber=s.contactNumber):(m.bookingPerson=c.bookingPerson,m.contactNumber=c.contactNumber),s.customPackage&&(m.customPackage=s.customPackage),s.subsidiary&&(null==s.subsidiary.fatherId?m.companyId=s.subsidiary.id:m.subCompanyId=s.subsidiary.id),s.subsidiary2&&(m.subCompanyId=s.subsidiary2.id),m.contactEmail=c.contactEmail,m.createdBy=null,m.creationDate=null,m.lastUpdatedBy=null,m.lastUpdateDate=null;var p=[];for(var f in s.newCandidates)p[f]={},p[f].bookingId=0,p[f].candidateId=0,p[f].candidatesName=s.newCandidates[f].candidateName,p[f].dob=moment(s.newCandidates[f].dob).format("YYYY-MM-DD"),p[f].phone=s.newCandidates[f].phone,p[f].email=s.newCandidates[f].email,p[f].position=s.newCandidates[f].position,p[f].appointmentStatus="Pending",p[f].fromDate=moment(s.newCandidates[f].preferredFromDate).format("YYYY-MM-DD"),p[f].toDate=moment(s.newCandidates[f].preferredToDate).format("YYYY-MM-DD"),p[f].siteId=s.newCandidates[f].site.id,p[f].siteName=s.newCandidates[f].site.siteName,s.newCandidates[f].calendar&&(p[f].calendarId=s.newCandidates[f].calendar.calId,p[f].appointmentTime=moment(i(s.newCandidates[f].calendar.fromTime)).format("YYYY-MM-DD HH:mm "),p[f].appointmentStatus="Confirmed",p[f].holdingId=s.newCandidates[f].holdingId),s.newCandidates[f].state&&(p[f].stateId=s.newCandidates[f].state.id,p[f].stateName=s.newCandidates[f].state.stateName),s.newCandidates[f].suburb&&(p[f].suburbId=s.newCandidates[f].suburb.suburbId,p[f].suburbName=s.newCandidates[f].suburb.suburbName);return m.candidates=p,r.debug("Will add this booking into the DB",m),e.submitBooking(m,function(e,o){r.debug("Submitted and data return",e),n.refreshBookingList(function(e){r.debug("refresh bookinglist successfully"),l.prepForBroadcast("Refresh booking list successfully")}),n.refreshAllPackageList(function(e){});for(var i in e.booking.bookingCandidates){var s=e.booking.bookingCandidates[i];s.candidateId&&(r.debug("> Will send email to ",s),a.sendConfirmationEmail({id:s.candidateId,type:"new"},function(e){r.debug(">>sendConfirmationEmail",e),e.sentEmailStatus.indexOf("Error")>=0?t.error(e.sentEmailStatus,"Error"):(t.success(e.sentEmailStatus,""),r.save())}))}u.resolve("Created Booking")},function(e){r.error("Fail to Submit the booking",e),t.error("Fail to submit the booking, please contact Redimed to assit","Error"),u.reject("Created Booking")}),u.promise},newSubsidiaryForRedimed:function(e){r.debug(">>newSubsidiaryForRedimed");var t=o.defer();return e.id=0,e.fatherId=112,r.debug("Will add new company = ",e),s.create(e,function(e){r.debug("new company created",e),t.resolve(e)},function(e){r.error(" fail to create the new company Error = ",e)}),t.promise}}}]),angular.module("ocsApp.MakePEMPhoneBooking").controller("BookingFormCtrl",["$state","RedimedSiteFactory","MakePEMPhoneBookingFactory","toastr","$log","$stateParams","LoopBackAuth",function(e,t,a,o,n,i,s){n=n.getInstance("ocsApp.MakePEMPhoneBooking.BookingFormCtrl"),n.debug("Hello, I am BookingFormCtrl",i.token);var r=this;this.token=i.token,this.loading1=!1,this.loading2=!1,this.token=i.token,this.showClickedValidation=!1,this.allAssessments=[],this.allSites=[],this.states=null,this.suburbs=null,this.assessments=[],this.isAuth=!1,this.isShowNotice=!1,this.isSubmitted=!1,this.isGettingAssessments=!0,this.isSubmitBookingSuccess=!1,this.format="dd/MM/yyyy",this.dateStatus={},this.dateStatus.dobOpened=!1,this.dateStatus.fromDateOpened=!1,this.dateStatus.toDateOpened=!1;var l=new Date,d=new Date;d.setDate(l.getDate()+1),l.setDate(l.getDate()+1),this.paperworkList=["Redimed","Gorgon","BP","Company Specific","CPPC","Rail","Wheatstone","MACA Mining","Aerison paperwork","Newmont","Shell"],this.timeList=["AM","PM"],this.BookingCandidate={},this.BookingCandidate.preferredFromDate=l,this.BookingCandidate.preferredToDate=d,this.BookingCandidate.dob=new Date(1990,0,1),this.BookingCandidate.bookingDate=new Date,this.BookingCandidate.paperwork="Redimed",this.BookingCandidate.preferredTime="AM",n.debug(" accessToken = ",this.token),s.setUser(this.token,1,"phoneBooking"),s.save(),this.openDOB=function(e){r.dateStatus.dobOpened=!0},this.openFromDate=function(e){r.dateStatus.fromDateOpened=!0},this.openToDate=function(e){r.dateStatus.toDateOpened=!0},this.selectedSite=function(){r.states=r.BookingCandidate.site.States,r.BookingCandidate.preferredSuburb=null,r.BookingCandidate.preferredState=null,r.suburbs=null},this.selectedState=function(){r.BookingCandidate.preferredState&&(r.suburbs=r.BookingCandidate.preferredState.SubStates)},this.isStates=function(){return null!=r.states&&!(r.states.length<=0)},this.isSuburbs=function(){return null!=r.suburbs&&!(r.suburbs.length<=0)},a.getAssessments().then(function(e){r.allAssessments=e.assessments,n.debug("assessments = ",r.allAssessments),r.isAuth=!0,r.isGettingAssessments=!1,a.getPhoneBookingHeader().then(function(e){n.debug("bookingHeader = ",e),r.BookingCandidate.bookingId=e.bookingId,r.BookingCandidate.companyId=e.companyId,r.BookingCandidate.companyName=e.companyName,r.BookingCandidate.subCompanyId=e.subCompanyId,r.BookingCandidate.bookingPerson=e.bookingPerson,r.BookingCandidate.bookingPersonNumber=e.contactNumber,r.BookingCandidate.bookingPersonEmail=e.contactEmail}),t.getSite(function(e){n.debug("getSites = ",e),r.allSites=e})},function(e){console.log("MakePEMPhoneBookingFactory.getAssessment = ",e),r.isAuth=!1,r.isShowNotice=!0,r.isGettingAssessments=!1;
}),this.submit=function(){r.isSubmitted=!0,console.log(" that.BookingCandidate = ",r.BookingCandidate,r.assessments),0==r.assessments.length?o.error("Please select the assessments","Error"):r.form.$valid?a.submitBooking(r.BookingCandidate,r.assessments).then(function(e){r.isSubmitBookingSuccess=!0}):n.error("ForgotPasswordCtrl invalid",r.form.$error)}}]),angular.module("ocsApp.MakePEMPhoneBooking").controller("MakePEMPhoneBookingMainCtrl",["CompanyFactory","$cookieStore","$uibModal","$log","toastr","mysqlDate","MakePEMPhoneBookingFactory","mySharedService",function(e,t,a,o,n,i,s,r){o=o.getInstance("ocsApp.MakePEMPhoneBooking.MakePEMPhoneBookingMainCtrl"),o.debug("I am make MakePEMPhoneBookingMainCtrl controller."),this.user=e.getCurrentUser(),this.companyObject=null,this.newBooking={},this.subsidiary={},this.subsidiary2={},this.form={},this.isSubmitted=!1,this.isSubmitingToTheServer=!1,this.isSubsidiary2=!1,this.isNoCandidate=!1;var l=this,d=t.get("user");e.getCompany(function(e){l.companyObject=e,console.log("getCompany = ",e),o.debug("Make booking, get company info")}),this.getAllSubsidiaries=function(e){o.debug("getAllSubsidiaries.Loading subsidiaries......",l.companyObject.subsidiaries),e(l.companyObject.subsidiaries)},this.isAdminLogin=function(){return d.userType.indexOf("RediMed")>=0},this.newCompany=function(){var e=a.open({animation:!0,templateUrl:"modules/MakePEMPhoneBooking/views/makePEMPhoneBooking.NewCompany.html",controller:"NewPEMPhoneCompanyCtrl",controllerAs:"NewPEMPhoneCompanyCtrl",size:"md"});e.result.then(function(e){o.debug("newCompany = ",e),s.newSubsidiaryForRedimed(e).then(function(e){o.debug("created new company sucessfully = ",e),l.newBooking.subsidiary=e,l.subsidiary=e,l.companyObject.subsidiaries.push(e)})},function(){o.debug("Modal New company dismissed at: "+new Date)})},this.emailBookingForm=function(){l.isSubmitted=!0,!l.newBooking.subsidiary&&l.isAdminLogin()&&(l.form.company.$invalid=!0),l.form.$invalid||l.form.company.$invalid?(n.error("Please enter all required fields of booking information","Error"),o.error("Please enter all required fields of booking information",l.form.$error)):(l.isSubmitingToTheServer=!0,o.debug("will send email the booking form",l.newBooking),s.emailBookingForm(l.newBooking).then(function(e){l.isSubmitingToTheServer=!1,o.debug("Submit booking successfully",e),n.success("Successfully submitted"),n.success("The booking list will be updated shortly. Please wait !"),l.newBooking={},l.newBooking.newCandidates=[],l.isSubmitted=!1},function(e){o.err("Fail to submit booking",e)}))},this.selectedSubsidiary=function(e){o.debug("selectedSubsidiary = ",e),l.newBooking.subsidiary=e,l.subsidiary2={},l.newBooking.subsidiary.subsidiaries?this.isSubsidiary2=l.newBooking.subsidiary.subsidiaries.length>0:this.isSubsidiary2=!1},this.isShowSubsidiary2=function(){return this.isSubsidiary2}}]),angular.module("ocsApp.MakePEMPhoneBooking").controller("NewPEMPhoneCompanyCtrl",["$uibModalInstance","$log",function(e,t){t=t.getInstance("ocsApp.MakePEMPhoneBooking.NewPEMPhoneCompanyCtrl"),t.debug("NewCompanyCtrl is running...");var a=this;this.company={},this.companyObject=null,this.isSubmitted=!1,this.form={},this.ok=function(){a.isSubmitted=!0,t.debug("OK to exit modal valid=",a.form.$valid),t.debug("OK to exit modal invalid=",a.form.$invalid),t.debug("OK to exit modal error=",a.form.$error),a.form.$valid&&e.close(a.company)},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.MakePEMPhoneBooking").factory("MakePEMPhoneBookingFactory",["BookingHeaders","BookingCandidates","Companies","toastr","$log","$q",function(e,t,a,o,n,i){return n=n.getInstance("ocsApp.MakePEMPhoneBooking.MakePEMPhoneBookingFactory"),{emailBookingForm:function(t){n.debug("will send the booking form");var a=i.defer();return e.emailBookingForm(t,function(e,t){n.debug("Submitted and data return",e),a.resolve("Created Booking")},function(e){n.error("Fail to Submit the booking",e),o.error("Fail to submit the booking, please contact Redimed to assit","Error"),a.reject("Created Booking")}),a.promise},getAssessments:function(){n.debug("will get assessments for the booking form");var e=i.defer();return a.getPhoneBookingHeader(function(e,t){n.debug("getPhoneBookingHeader",e)},function(e){n.error("Fail to get assessments",e)}),a.getAssessments(function(t,a){n.debug("get assessments from server",t),e.resolve(t)},function(t){"Authorization Required"==t.data.error.message||"Invalid Access Token"==t.data.error.message?(n.error("Fail to get assessments",t),o.error("Session is expired. Please contact Redimed to receive the new booking form","Error"),e.reject("Fail to get assessments")):(n.error("Fail to get assessments",t),o.error("Fail to get assessments, please contact Redimed to assit ("+t+")","Error"),e.reject("Fail to get assessments"))}),e.promise},getPhoneBookingHeader:function(){n.debug("will get getPhoneBookingHeader for the booking form");var e=i.defer();return a.getPhoneBookingHeader(function(t,a){n.debug("getPhoneBookingHeader",t),e.resolve(t.phoneBookingHeader)},function(t){n.error("Fail to get getPhoneBookingHeader",t),e.reject("Fail to get getPhoneBookingHeader",t)}),e.promise},newSubsidiaryForRedimed:function(e){n.debug(">>newSubsidiaryForRedimed");var t=i.defer();return e.id=0,e.fatherId=112,n.debug("Will add new company = ",e),a.create(e,function(e){n.debug("new company created",e),t.resolve(e)},function(e){n.error(" fail to create the new company Error = ",e)}),t.promise},submitBooking:function(t,a){var s=i.defer(),r={bookingId:t.bookingId,poNumber:t.po,resultEmail:t.resultEmail,invoiceEmail:t.bookingPersonEmail,packageId:0,siteId:null,companyId:t.companyId,subCompanyId:t.subCompanyId,period:null,paperwork:"Redimed",bookingPerson:t.bookingPerson,customPackage:a,contactEmail:t.bookingPersonEmail,comments:t.comment,candidates:[{bookingId:t.bookingId,candidateId:0,candidatesName:t.candidateName,dob:moment(t.dob).format("YYYY-MM-DD"),phone:t.number,email:t.email,position:t.position,appointmentStatus:"Pending",fromDate:moment(t.preferredFromDate).format("YYYY-MM-DD"),toDate:moment(t.preferredToDate).format("YYYY-MM-DD"),siteId:t.site.id,siteName:t.site.siteName,preferredTime:t.preferredTime,isRedimedCallCandidate:t.isRedimedCallCandidate}]};return t.preferredState&&(r.candidates[0].stateId=t.preferredState.id,r.candidates[0].stateName=t.preferredState.siteName),t.preferredSuburb&&(r.candidates[0].suburbId=t.preferredSuburb.id,r.candidates[0].suburbName=t.preferredSuburb.siteName),n.debug("will submit phone booking = ",r),e.submitPhoneBooking(r,function(e){n.debug(" after submitPhoneBooking = ",e),s.resolve(e)},function(e){s.reject(e),n.error(" fail to submitPhoneBooking = ",e),o.error("Fail to submit the booking (err = "+e+")","Error")}),s.promise}}}]),angular.module("ocsApp.MakeTelehealthBooking").controller("MakeTelehealthBookingMainCtrl",["CompanyFactory","$cookieStore","$uibModal","$log","toastr","mysqlDate","MakeTelehealthBookingFactory","mySharedService",function(e,t,a,o,n,i,s,r){var l=this;o=o.getInstance("ocsApp.MakeTelehealthBooking.MakeTelehealthBookingMainCtrl"),o.debug("I am make telehealth booking controller."),this.user=e.getCurrentUser(),console.log(this.user),this.companyObject=null,this.newBooking={companyId:l.user.companyId,employerId:null,patientName:null,dob:null,address:null,postcode:null,state:null,suburb:null,facetime:null,skype:null,contactNumber:null,occupation:null,employer:null,supervisor:null,medicalState:null,emailForDoc:null,injuryCrush:!1,injuryFall:!1,injuryLaceration:!1,injuryOther:!1,injurySprain:!1,descriptionOfInjury:null,bodyPart:null,injuryDate:null,medicalHistory:null,allergies:null,serviceRequired:null,apptDate:null,preferredTime:null,consent:!1,bookingPerson:l.user.bookingPerson},this.subsidiary={},this.subsidiary2={},this.viewPackage="",this.form={},this.isSubmitted=!1,this.isSubmitingToTheServer=!1,this.isSubsidiary2=!1,this.isNoCandidate=!1,this.stateList=["WA","NSW","VIC","SA","TAS","NT","QLD"],this.bodyPartList=["Foot-L","Foot-R","Lower Leg-L","Lower Leg-R","Upper Leg-L","Upper Leg-R","Shoulder-L","Shoulder-R","Arm-L","Arm-R","Wrist-L","Wrist-R","Hand-L","Hand-R","Lower Back","Upper Back","Chest","Abdomen","Head"],this.serviceList=["1st Medical certificate","Progress Medical Certificate","Fitness for Duty","Referral"],this.dateStatus={},this.dateStatus.dobOpened=!1,this.dateStatus.apptDateOpened=!1,this.dateStatus.timeOpened=!1,this.dateStatus.injuryDateOpened=!1,this.format="dd/MM/yyyy",this.openDOB=function(e){l.dateStatus.dobOpened=!0},this.timechanged=function(){console.log("Time changed to: ",l.newBooking.preferredTime)},this.openApptDate=function(e){l.dateStatus.apptDateOpened=!0},this.openInjuryDate=function(e){l.dateStatus.injuryDateOpened=!0},this.isShowOtherInjyryDesc=!1,l.descriptionOfInjuryInvalid=!0,this.injuryDescChange=function(){l.newBooking.injuryOther||l.newBooking.injuryLaceration||l.newBooking.injuryCrush||l.newBooking.injurySprain||l.newBooking.injuryFall?l.descriptionOfInjuryInvalid=!1:l.descriptionOfInjuryInvalid=!0,l.newBooking.injuryOther?l.isShowOtherInjyryDesc=!0:l.isShowOtherInjyryDesc=!1};var d=t.get("user");e.getCompany(function(e){l.companyObject=e,o.debug("Make booking, get company info")}),this.getAllSubsidiaries=function(e){o.debug("getAllSubsidiaries.Loading subsidiaries......",l.companyObject.subsidiaries),e(l.companyObject.subsidiaries)},this.isAdminLogin=function(){return d.userType.indexOf("RediMed")>=0},this.newCompany=function(){var e=a.open({animation:!0,templateUrl:"modules/MakeTelehealthBooking/views/makeTelehealthBooking.NewCompany.html",controller:"NewTelehealthCompanyCtrl",controllerAs:"NewTelehealthCompanyCtrl",size:"md"});e.result.then(function(e){o.debug("newCompany = ",e),s.newSubsidiaryForRedimed(l.user.companyId,e).then(function(e){o.debug("created new company sucessfully = ",e),l.newBooking.employer=e,l.newBooking.email=e.resultEmail,l.companyObject.subsidiaries.push(e)})},function(){o.debug("Modal New company dismissed at: "+new Date)})},this.submitForm=function(){l.isSubmitted=!0,console.log(this.newBooking),l.form.$invalid?(n.error("Please enter all required fields of booking information","Error"),o.error("Please enter all required fields of booking information",l.form.$error)):(l.isSubmitingToTheServer=!0,s.submitBooking(l.newBooking,l.companyObject,d).then(function(e){l.isSubmitingToTheServer=!1,o.debug("Submit booking successfully",e),n.success("Successfully submitted"),n.success("The booking list will be updated shortly. Please wait !"),l.newBooking={companyId:l.user.companyId,employerId:null,patientName:null,dob:null,address:null,postcode:null,state:null,suburb:null,facetime:null,skype:null,contactNumber:null,occupation:null,employer:null,supervisor:null,medicalState:null,emailForDoc:null,injuryCrush:!1,injuryFall:!1,injuryLaceration:!1,injuryOther:!1,injurySprain:!1,descriptionOfInjury:null,bodyPart:null,injuryDate:null,medicalHistory:null,allergies:null,serviceRequired:null,apptDate:null,preferredTime:null,consent:!1,bookingPerson:l.user.bookingPerson},l.isSubmitted=!1},function(e){o.err("Fail to submit booking",e)}))},this.selectedSubsidiary=function(e){o.debug("selectedSubsidiary = ",e),l.newBooking.email=e.resultEmail},this.isShowSubsidiary2=function(){return this.isSubsidiary2}}]),angular.module("ocsApp.MakeTelehealthBooking").controller("NewTelehealthCompanyCtrl",["$uibModalInstance","$log",function(e,t){t=t.getInstance("ocsApp.MakeTelehealthBooking.NewTelehealthCompanyCtrl"),t.debug("NewCompanyCtrl is running...");var a=this;this.company={},this.companyObject=null,this.isSubmitted=!1,this.form={},this.ok=function(){a.isSubmitted=!0,t.debug("OK to exit modal valid=",a.form.$valid),t.debug("OK to exit modal invalid=",a.form.$invalid),t.debug("OK to exit modal error=",a.form.$error),a.form.$valid&&e.close(a.company)},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.MakeBooking").factory("MakeTelehealthBookingFactory",["TelehealthBookings","toastr","$q","CompanyFactory","mysqlDate","Companies","$log","mySharedService",function(e,t,a,o,n,i,s,r){return s=s.getInstance("ocsApp.MakeBooking.MakeBookingFactory"),{submitBooking:function(o,n,i){var r=a.defer(),l={bookingId:0,companyId:o.companyId,patientName:o.patientName,dob:moment(o.dob).format("YYYY-MM-DD"),address:o.address,postcode:o.postcode,state:o.state,suburb:o.suburb,facetime:o.facetime,skype:o.skype,contactNumber:o.contactNumber,occupation:o.occupation,employer:o.employer.companyName,employerId:o.employer.id,supervisor:o.supervisor,medicalState:o.medicalState,emailForDoc:o.email,injuryCrush:o.injuryCrush?1:0,injuryFall:o.injuryFall?1:0,injuryLaceration:o.injuryLaceration?1:0,injuryOther:o.injuryOther?1:0,injurySprain:o.injurySprain?1:0,descriptionOfInjury:o.descriptionOfInjury,bodyPart:o.bodyPart,injuryDate:moment(o.injuryDate).format("YYYY-MM-DD"),medicalHistory:o.medicalHistory,allergies:o.allergies,serviceRequired:o.serviceRequired,apptDate:moment(o.apptDate).format("YYYY-MM-DD")+" "+moment(o.preferredTime).format("HH:mm"),preferredTime:moment(o.preferredTime).format("HH:mm"),consent:o.consent?1:0,bookingPerson:o.bookingPerson,apptStatus:"Confirmed"};return s.debug("will submit the telehealth booking",l),e.create(l,function(e){s.debug("Submitted and data return",e),r.resolve("Created Booking")},function(e){s.error("Fail to Submit the booking",e),t.error("Fail to submit the booking, please contact Redimed to assit","Error"),r.reject("Created Booking")}),r.promise},newSubsidiaryForRedimed:function(e,t){s.debug(">>newSubsidiaryForRedimed");var o=a.defer();return t.id=0,t.fatherId=e,s.debug("Will add new company = ",t),i.create(t,function(e){s.debug("new company created",e),o.resolve(e)},function(e){s.error(" fail to create the new company Error = ",e)}),o.promise}}}]),angular.module("ocsApp.Navigator").controller("IdleAlertCtrl",["$uibModalInstance","$scope",function(e,t){}]),angular.module("ocsApp.Navigator").controller("NavigatorMainCtrl",["CompanyFactory","Accounts","$state","$cookieStore","$uibModal","Idle","Keepalive","$scope","$uibModalStack","mySharedService","$log","mySocket",function(e,t,a,o,n,i,s,r,l,d,c,u){c=c.getInstance("ocsApp.Navigator.NavigatorMainCtrl"),c.debug("I am navigator controller."),i.watch();var m=this;this.user=e.getCurrentUser(),this.currentCompany=null,c.debug("user = ",this.user);var p=function(){m.currentCompany=e.getCurrentCompany()};p(),r.$on("handleBroadcast",function(){var e=d.message;c.debug("Received a message from ChangeCompanyCtrl = "+e),e.indexOf("Refresh navigator")>=0&&p()}),this.user.userType.indexOf("RediMed")>=0?(c.debug("I am admin"),a.go("navigator.bookings")):(c.debug("I am company"),1==m.user.istelehealthBooking?a.go("navigator.makeTelehealthBooking"):a.go("navigator.makeBooking")),r.$on("IdleStart",function(){c.debug("IdleStart");var e=n.open({animation:!0,templateUrl:"modules/Navigator/views/navigator.idleAlert.html",controller:"IdleAlertCtrl",size:"md"});e.result.then(function(e){},function(){c.debug("Modal Idle dismissed at: "+new Date)})}),r.$on("IdleEnd",function(){c.debug("IdleEnd"),l.dismissAll()}),r.$on("IdleTimeout",function(){c.debug("IdleTimeout"),l.dismissAll(),m.logout()}),this.isPackage=function(){return 1==m.user.isall||1==m.user.ispackage},this.isPosition=function(){return 1==m.user.isall||1==m.user.isposition},this.isSetting=function(){return 1==m.user.isall||1==m.user.issetting},this.isBookingList=function(){return 1==m.user.isall||1==m.user.isbooking},this.isMakeBooking=function(){return 1==m.user.isall||1==m.user.ismakebooking},this.isTelehealthBooking=function(){return 1==m.user.isall||1==m.user.istelehealthBooking},this.isReports=function(){return this.user.userType.indexOf("RediMed")>=0},this.logout=function(){c.debug("NavigatorMainCtrl.logout runs......"),t.logout(function(e,t){u.emit("logout"),d.prepForBroadcast("Logout successfully"),c.debug("Logout : ",e),c.debug("Logout : ",t),a.go("init")},function(e){c.error("Logout failed: ",e)})},this.myProfile=function(){var e=n.open({animation:!0,templateUrl:"modules/Settings/views/settings.NewAccount.html",controller:"NewAccountCtrl",controllerAs:"NewAccountCtrl",size:"lg",resolve:{account:function(){return m.user}}});e.result.then(function(e){},function(){c.debug("Modal profile dismissed at: "+new Date)})},this.changeCompany=function(){var e=n.open({animation:!0,templateUrl:"modules/Settings/views/settings.ChangeCompany.html",controller:"ChangeCompanyCtrl",controllerAs:"ChangeCompanyCtrl",size:"md",resolve:{account:function(){return m.user}}});e.result.then(function(e){},function(){c.debug("Modal profile dismissed at: "+new Date)})}}]),angular.module("ocsApp.Positions").controller("ConfirmToDeletePackageCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.Packages").controller("PackagesMainCtrl",["$uibModal","$scope","CompanyFactory","Packages","$log","mySharedService",function(e,t,a,o,n,i){n=n.getInstance("ocsApp.Packages.PackagesMainCtrl"),n.debug("I am package list controller.");var s=this;this.packages=[];var r=function(){a.getCompany(function(e){n.debug("Get company info"),s.packages=e.packages})};r(),t.$on("handleBroadcast",function(){var e=i.message;n.debug("Received a message from ChangeCompanyCtrl = "+e),e.indexOf("Refresh packages")>=0&&r()}),this.deletePackage=function(t){var i=e.open({animation:!0,templateUrl:"modules/Packages/views/packages.ConfirmToDeletePackage.html",controller:"ConfirmToDeletePackageCtrl",controllerAs:"ConfirmToDeletePackageCtrl",size:"md"});i.result.then(function(e){o.deleteById({id:t},function(e){console.log(e),a.refreshPackageList(function(e){console.log("Make booking, get company info = ",e),s.packages=e.packages})})},function(){n.debug("Modal delete package dismissed at: "+new Date)})},this.newOrEditPackage=function(t){var a=e.open({animation:!0,templateUrl:"modules/Packages/views/packages.NewPackage.html",controller:"NewPackageCtrl",controllerAs:"NewPackageCtrl",size:"lg",resolve:{"package":function(){return t}}});a.result.then(function(e){r()},function(){n.debug("Modal New or edit package dismissed at: "+new Date)})}}]),angular.module("ocsApp.Positions").controller("NewPackageCtrl",["Packages","$uibModalInstance","package","CompanyFactory","$log","toastr",function(e,t,a,o,n,i){n=n.getInstance("ocsApp.Positions.Packages"),n.debug("I am  new or edit position controller.",a);var s=this;if(this.form={},this.assessments=[],this.companyObject={},this.companyId=o.getCompanyId(),a){this.packageName=a.packageName;for(var r in a.AssessmentHeaders){var l=a.AssessmentHeaders[r];for(var d in l.Assessments)this.assessments.push(l.Assessments[d].assId)}}n.debug("Assessments = ",this.assessments),o.getCompany(function(e){s.companyObject=e}),this.ok=function(){if(s.isSubmitted=!0,s.form.$valid){var r={};r["package"]=a,r.assessments=s.assessments,r.packageName=s.packageName,r.companyId=s.companyId,n.debug("will insert/update upsertData = ",r),e.upsertPackage(r,function(e){n.debug("New/update package successfully ",e),i.success("Successfully submitted"),o.refreshPackageList(function(e){n.debug(">>>>>>Refesh packages after insert or edit",e.packages),t.close({})})},function(e){n.error("Fail to new/update package",e),i.error("Fail to save the package","Error")})}else n.error("Data error",s.form.$error),i.error("Please check the input data","Error")},this.cancel=function(){t.dismiss("cancel")}}]),angular.module("ocsApp.Positions").controller("ConfirmToDeletePositionCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.Positions").controller("PositionsMainCtrl",["$uibModal","$scope","CompanyFactory","Positions","$log","mySharedService",function(e,t,a,o,n,i){n=n.getInstance("ocsApp.Packages.PackagesMainCtrl"),n.debug("I am position list controller.");var s=this;this.positions=[],this.show=!1;var r=function(){a.getCompany(function(e){console.log("Make booking, get company info = ",e),s.positions=e.positions})};r(),t.$on("handleBroadcast",function(){var e=i.message;n.debug("Received a message from ChangeCompanyCtrl = "+e),e.indexOf("Refresh positions")>=0&&r()}),this.deletePosition=function(t){var i=e.open({animation:!0,templateUrl:"modules/Positions/views/positions.ConfirmToDeletePosition.html",controller:"ConfirmToDeletePositionCtrl",controllerAs:"ConfirmToDeletePositionCtrl",size:"md"});i.result.then(function(e){o.deleteById({id:t},function(e){console.log(e),a.refreshPositionList(function(e){console.log("Make booking, get company info = ",e),s.positions=e.positions})})},function(){n.info("Modal dismissed at: "+new Date)})},this.newOrEditPosition=function(t){var o=e.open({animation:!0,templateUrl:"modules/Positions/views/positions.NewPosition.html",controller:"NewPositionCtrl",controllerAs:"NewPositionCtrl",size:"md",resolve:{position:function(){return t}}});o.result.then(function(e){a.refreshPositionList(function(e){console.log("Make booking, get company info = ",e),s.positions=e.positions})},function(){n.info("Modal dismissed at: "+new Date)})}}]),angular.module("ocsApp.Positions").controller("NewPositionCtrl",["Positions","$uibModalInstance","position","CompanyFactory","$log","toastr",function(e,t,a,o,n,i){n=n.getInstance("ocsApp.Positions.NewPositionCtrl"),n.debug("I am  new or edit position controller.",a);var s=this;this.form={},this.companyId=o.getCompanyId(),a&&(this.positionName=a.positionName),this.ok=function(){if(s.isSubmitted=!0,s.form.$valid)if(a)n.debug("will update position",a),e.update({where:{id:a.id}},{positionName:s.positionName},function(e){n.debug("updated position",e),i.success("Position was updated successfully",""),t.close({})},function(e){n.error("Fail to update position",e),i.error("Fail to update Position","Error"),t.close({})});else{var o={};o.positionName=s.positionName,o.companyId=s.companyId,o.id=0,console.log(o),e.create(o,function(e){n.debug("created position",e),i.success("Position was created successfully",""),t.close({})},function(e){i.error("Fail to create Position","Error"),n.error("failt to create position",e)})}else n.error("Save postion err ",s.form.$error)},this.cancel=function(){t.dismiss("cancel")}}]),angular.module("ocsApp.Positions").controller("ConfirmToDeletePackageCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.Settings").controller("ChangeCompanyCtrl",["Accounts","$uibModalInstance","account","CompanyFactory","$cookieStore","$log","toastr","mySharedService",function(e,t,a,o,n,i,s,r){i=i.getInstance("ocsApp.Settings.NewAccountCtrl"),i.debug("I am  new or edit account controller.",a);var l=this;this.companies=[],this.user=o.getCurrentUser(),this.firstCompany=n.get("firstCompany"),this.companies.push({Companies:this.firstCompany}),n.get("companies").forEach(function(e){l.companies.push(e)}),this.currentCompany=o.getCurrentCompany(),this.companies.forEach(function(e){e.Companies.id==l.currentCompany.id?e.isCurrent=!0:e.isCurrent=!1}),this.selectCompany=function(t){i.debug("select company = ",t,"that.currentCompany = ",l.currentCompany),t.id!=l.currentCompany.id&&(l.currentCompany=t,o.setCurrentCompany(t),e.setCompany({companyId:t.id},function(e){console.log("data = ",e),l.companies.forEach(function(e){e.Companies.id==l.currentCompany.id?e.isCurrent=!0:e.isCurrent=!1}),o.init(function(e){r.prepForBroadcast("Refresh booking list successfully"),r.prepForBroadcast("Refresh make booking"),r.prepForBroadcast("Refresh packages"),r.prepForBroadcast("Refresh positions"),r.prepForBroadcast("Refresh settings"),r.prepForBroadcast("Refresh navigator")})},function(e){console.log("error = ",e)}))},this.cancel=function(){t.dismiss("cancel")}}]),angular.module("ocsApp.Settings").controller("SettingsMainCtrl",["$uibModal","$scope","CompanyFactory","Packages","$log","mySharedService",function(e,t,a,o,n,i){n=n.getInstance("ocsApp.Settings.SettingsMainCtrl"),n.debug("I am package list controller.");var s=this;this.accounts=[],this.companies=[];var r=function(){a.getCompany(function(e){s.accounts=e.accounts,s.companies=e.subsidiaries;for(var t in s.accounts)s.accounts[t].company&&(s.accounts[t].companyName=s.accounts[t].company.companyName)})};r(),t.$on("handleBroadcast",function(){var e=i.message;n.debug("Received a message from ChangeCompanyCtrl = "+e),e.indexOf("Refresh settings")>=0&&r()}),this.deletePackage=function(t){var i=e.open({animation:!0,templateUrl:"modules/Packages/views/packages.ConfirmToDeletePackage.html",controller:"ConfirmToDeletePackageCtrl",controllerAs:"ConfirmToDeletePackageCtrl",size:"md"});i.result.then(function(e){o.deleteById({id:t},function(e){console.log(e),a.refreshPackageList(function(e){console.log("Make booking, get company info = ",e),s.packages=e.packages})})},function(){n.info("Modal dismissed at: "+new Date)})},this.newOrEditPackage=function(t){var o=e.open({animation:!0,templateUrl:"modules/Settings/views/settings.NewAccount.html",controller:"NewAccountCtrl",controllerAs:"NewAccountCtrl",size:"lg",resolve:{account:function(){return t}}});o.result.then(function(e){a.refreshAccountList(function(e){console.log(">>>>>>Refesh packages after insert or edit= ",e),s.accounts=e.accounts})},function(){n.info("Modal dismissed at: "+new Date)})}}]),angular.module("ocsApp.Settings").controller("NewAccountCtrl",["Accounts","$uibModalInstance","account","CompanyFactory","$cookieStore","$log","toastr",function(e,t,a,o,n,i,s){i=i.getInstance("ocsApp.Settings.NewAccountCtrl"),i.debug("I am  new or edit account controller.",a);var r=this;this.user=o.getCurrentUser(),this.isSubmitted=!1,this.form={},this.companyObject={},this.companyId=o.getCompanyId(),this.accountObj={},this.companies=[],i.debug("current user = ",this.user),o.getCompany(function(e){console.log("New Account, get company info = ",e),r.companies=e.subsidiaries}),this.isAdmin=function(){return!a&&r.user.userType.indexOf("RediMed")>=0},a?this.accountObj=a:(this.accountObj.isproject=0,this.accountObj.iscalendar=0,this.accountObj.isall=0,this.accountObj.isenable=0,this.accountObj.ismakebooking=0,this.accountObj.isbooking=0,this.accountObj.ispackage=0,this.accountObj.isposition=0,this.accountObj.issetting=0,this.accountObj.isallcompanydata=0),o.getCompany(function(e){r.companyObject=e}),this.isOpenCheckBoxControl=function(){return 1==r.user.isall||1==r.user.issetting},this.isPassRequire=function(){return null==a},this.emailChanged=function(e){r.accountObj.invoiceemail=e,r.accountObj.resultEmail=e},this.ok=function(){r.isSubmitted=!0,r.form.$valid?a?(""==r.accountObj.password&&delete r.accountObj.password,i.debug("will update this",r.accountObj),e.updateAccount(r.accountObj,function(e){console.log("updated account",e),t.close({})},function(e){i.error("Fail to update an account",e),s.error("Fail to update an account ! Err:"+e.data.error.message)})):(r.accountObj.id=-1,r.accountObj.companyId||(r.accountObj.companyId=r.companyId),r.accountObj.userType="Company",i.debug("will add this",r.accountObj),e.updateAccount(r.accountObj,function(e){console.log("After new acc = ",e),t.close({})},function(e){i.error("Fail to create an new account",e),s.error("Fail to create an new account ! Err:"+e.data.error.message)})):i.debug("there is error in UI",r.form.$error)},this.cancel=function(){t.dismiss("cancel")}}]),angular.module("ocsApp.Companies").controller("ConfirmToDeleteCompanyCtrl",["$uibModalInstance","row",function(e,t){this.formDefines={div1:{type:"div",fieldClass:"modal-header",fields:{h3:{type:"h3",fieldClass:"modal-title",label:"Delete Company",controllerAs:"ConfirmToDeleteCompanyCtrl"}}},div2:{type:"div",fieldClass:"modal-body",fields:{h3:{type:"h3",fieldClass:"modal-title",label:"Do you want to delete company ?"}}},div3:{type:"div",fieldClass:"modal-footer",fields:{btn1:{type:"button",fieldClass:"btn btn-primary",ngClick:"ok()",label:"Save"},btn2:{type:"button",fieldClass:"btn btn-warning",ngClick:"cancel()",label:"Cancel"}}}},this.ok=function(){e.close(t)},this.cancel=function(){e.dismiss(t)}}]),angular.module("ocsApp.Sites").controller("SitesMainCtrl",["$uibModal","$log","DetailModal","DeleteModal","$state","SiteModuleFactory","$scope",function(e,t,a,o,n,i,s){TableBaseCtrl.call(this,s,t,i,o,"SitesMainCtrl");this.isSubmitted=!1,this.form={},this.company={},this.setDeleteTemplateUrl('<my-dynamic-form formdefine = "{{ConfirmToDeleteCompanyCtrl.formDefines}}" ></my-dynamic-form>'),this.setDeleteController("ConfirmToDeleteCompanyCtrl"),this.setDeleteWindowSize("md"),this.setCloseDeleteModal(function(e){CompanyModuleFactory.deleteCompany(e)}),this.detail=function(e){console.log(" prepare to go to detail with rowData",e),e?n.go("navigator.sites.detail",{row:e.id}):n.go("navigator.sites.detail",{row:null})}}]),angular.module("ocsApp.Sites").controller("NewCalendarCtrl",["Calendar","row","$log","toastr","SiteModuleFactory","$uibModalInstance","DetailModal","DeleteModal","toastr",function(e,t,a,o,n,i,s,r,o){DetailWithTableBaseCtrl.call(this,i,t,a,o,s,r,"NewSubCompanyCtrl");var l=this;this.row.defaultStatusObject={},this.bookingStatus=[];t.Calendars;t?this.windowTitle="Update Sub Company":this.windowTitle="New Sub Company",a.debug("modalTitle = ",this.windowTitle),this.saveRow=function(){if(t){a.debug("will update calendar",t.available);var n=0;n=t.available&&t.available.length>0?Number(t.available.substr(1,2)):0,e.findById({id:t.calId},function(s){var r=s.available,d=Number(l.row.newAvailable),c=r-n,u=Number(d)+Number(c);a.debug("will update calendar",s,"currentAvailable = "+n+" newSlot = "+u),e.update({where:{calId:t.calId}},{available:u},function(e){a.debug("updated calendar successfully",e),a.save(),o.success("update calendar successfully"),i.close({})},function(e){a.error("fail to update calendar",e),o.error("Fail to update calendar, Please contact Phuong","Error")})})}},this.cancel=function(){i.dismiss("cancel")},this.formDefines={div1:{type:"div",fieldClass:"modal-header",controllerAs:"NewCalendarCtrl",isSubmitedVar:"isSubmitted",fields:{h3:{type:"h3",label:"{{NewSubCompanyCtrl.windowTitle}}",fieldClass:"modal-title"}}},div2:{type:"div",fieldClass:"modal-body",fields:{form:{type:"form",name:"form",fieldClass:"form-horizontal form-row-seperated",fields:{fromTime:{field:"fromTime",ngModel:"row.fromTime",label:"Appointment Time",width:"100",isList:!0,isNew:!0,isReadOnly:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},available:{field:"available",ngModel:"row.available",label:"Available",width:"100",isList:!0,isNew:!0,isReadOnly:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"},newAvailable:{field:"newAvailable",ngModel:"row.newAvailable",label:"New Available",placeholder:"New Available",width:"100",isList:!0,isNew:!0,isUpdate:!0,type:"text",fieldClass:"form-control",isRequire:!1,labelClass:"col-md-4 control-label",fieldGroupClass:"col-md-6",formGroupClass:"form-group",requiredHelpBlock:"Company name is required"}}}}},div3:{type:"div",fieldClass:"modal-footer",fields:{SaveButton:{type:"button",label:"Save",fieldClass:"btn btn-primary",ngClick:"ok()"},CancelButton:{type:"button",label:"Cancel",fieldClass:"btn btn-warning",ngClick:"cancel()"}}}},console.log(this.formDefines)}]),angular.module("ocsApp.Sites").controller("NewSiteCtrl",["$state","$stateParams","Companies","$log","toastr","BookingStatusFactory","DetailModal2","DeleteModal","SiteModuleFactory","mysqlDate",function(e,t,a,o,n,i,s,r,l,d){var c=parseInt(t.row),u=l.getMasterRow(c),m=this,p=u.AdminCalendars;DetailWithTableBaseCtrl.call(this,l,u,o,n,s,r,"NewCompanyCtrl"),this.row.defaultStatusObject={},this.bookingStatus=[],this.setDetailTemplateUrl('<my-dynamic-form formdefine = "{{NewCalendarCtrl.formDefines}}" ></my-dynamic-form>'),
this.setDetailController("NewCalendarCtrl"),this.setDetailWindowSize("lg"),this.setCloseDetailModal(function(){l.getCalendars(u.id,function(e){m.row.AdminCalendars=e[0].AdminCalendars})}),this.cancel=function(){e.go("navigator.companies.list")},u?(this.windowTitle="Update Company",l.getCalendars(u.id,function(e){m.row.AdminCalendars=e[0].AdminCalendars})):this.windowTitle="New Company",this.saveDetail=function(){console.log(u.Calendars)},this.filterDetail=function(e,t){var a=[];if(p)for(var o=0;o<p.length;o++){var n=d(p[o].fromTime);e&&t&&n>=e&&n<=t&&a.push(p[o])}u.AdminCalendars=a,console.log(u.AdminCalendars)},o.debug("modalTitle = ",this.windowTitle)}]),angular.module("ocsApp.Sites").factory("SiteModuleFactory",["Redimedsites","$log","toastr","$rootScope","$state",function(e,t,a,o,n){t=t.getInstance("ocsApp.Sites.SiteModuleFactory");var i=null,s="",r=function(t){e.find(function(e){console.log("Get company from server",e),i=e,t(i)})};return{getCalendars:function(t,a){e.find({filter:{where:{id:t},include:{relation:"AdminCalendars",scope:{limit:1e3}}}},function(e){console.log("Get calendar from server for siteId = "+t,e),a(e)})},getMasterRows:function(e){i?(console.log("Get company from memory",i),e(i)):r(e)},refreshMasterRows:function(e){r(e)},getMasterRow:function(e){if(t.debug("Get master row with id = ",e),console.log("Get master rows  = ",i),i){var a=i[_.findIndex(i,"id",e)];return a}return{}},deleteMasterRow:function(o){var n=this;t.debug("This is a custom closeDeleteModal function",o),e.deleteById({id:o.id},function(e){console.log(e),t.debug("Successfully delete company",e),n.refreshMasterRows(function(e){n.masterDetailBroadcast("Delete Master Successfully")})},function(e){t.error("Fail to delete company",e),a.error("Fail to delete the company. "+e.data.error.message,"error")})},masterDetailBroadcast:function(e){s=e,o.$broadcast("MasterDetailBroadcast")},getMessage:function(){return s},saveMaster:function(o){var i=this;o.id?(t.debug("will update company",o),o.defaultStatusObject&&(o.defaultStatus=o.defaultStatusObject.bookingStatus),e.update({where:{id:o.id}},o,function(e){t.debug("updated company",e),a.success("Company was updated successfully",""),n.go("navigator.companies.list"),i.refreshMasterRows(function(e){i.masterDetailBroadcast("Update Master Successfully")})},function(e){t.error("Fail to update position",e),a.error("Fail to update Position "+e.data.error.message,"Error")})):(o.defaultStatusObject&&(o.defaultStatus=o.defaultStatusObject.bookingStatus),o.id=0,t.debug("will create new company",o),e.create(o,function(e){t.debug("created company",e),a.success("Company was created successfully",""),n.go("navigator.companies.list"),i.refreshMasterRows(function(e){i.masterDetailBroadcast("Insert Master Successfully")})},function(e){a.error("Fail to create Position","Error"),a.error("Fail to create Position "+e.data.error.message,"Error")}))}}}]),angular.module("ocsApp.Bookings").controller("AdminEditBookingCtrl",["candidate","RedimedSiteFactory","BookingStatusFactory","BookingCandidates","toastr","$uibModalInstance","mysqlDate","$log","CompanyFactory","mySharedService","mysqlDate","$cookieStore","$uibModal",function(e,t,a,o,n,i,s,r,l,d,s,c,u){function m(){r.debug("will getCalendar....",p.user);var e=new Date,a=new Date;a.setDate(a.getDate()+60),t.getCalendar(p.site.id,e,a,function(e){r.debug("finished getCalendar....",p.user),console.log(" RedimedSiteFactory.getCalendar = ",e),p.calendars=e,p.calendar=p.calendars[_.findIndex(p.calendars,"calId",p.candidate.calendarId)],p.calendars.length>0?(p.isCalendarList=!0,p.isAppointmentTime=!1):(p.isCalendarList=!1,p.isAppointmentTime=!0),p.user.userType.indexOf("RediMed")==-1&&(p.isAppointmentTime=!1),console.log("that.calendars = ",p.calendars,"that.calendar = ",p.calendar)})}r=r.getInstance("ocsApp.Bookings.AdminEditBookingCtrl"),r.debug("I am admin edit booking ctrl"),r.debug("Candidate = ",e);var p=this,f=e.appointmentStatus;this.candidate=e,this.user=l.getCurrentUser(),this.sites=[],this.states=[],this.suburbs=[],this.site={},this.state={},this.suburb={},this.calendars=[],this.calendar={},this.statuses=[],this.isSubmitted=!1,this.form={},this.dateStatus={},this.dateStatus.fromDateOpened=!1,this.dateStatus.toDateOpened=!1,this.dateStatus.timeOpened=!1,this.isCalendarList=!1,this.isAppointmentTime=!1,this.format="dd/MM/yyyy HH:mm",this.apptDateAfterConvert=s(this.candidate.appointmentTime),this.apptTimeAfterConvert=s(this.candidate.appointmentTime),this.isAppointmentTimeChange=!1,this.appointmentTimeChanged=function(){p.isAppointmentTimeChange=!0,console.log(this.apptTimeAfterConvert)},this.openTime=function(){p.dateStatus.timeOpened=!0},this.openFromDate=function(e){p.dateStatus.fromDateOpened=!0},a.getStatus(function(e){p.statuses=e,r.debug(" status = ",p.statuses)}),t.getSite(function(e){r.debug("get sites..."),p.sites=e,p.site=p.sites[_.findIndex(p.sites,"id",p.candidate.siteId)],p.site.States.length>0&&(p.states=p.site.States,p.state=p.states[_.findIndex(p.states,"stateName",p.candidate.stateName)],p.state.SubStates.length>0&&(p.suburbs=p.state.SubStates,p.suburb=p.suburbs[_.findIndex(p.suburbs,"suburbName",p.candidate.suburbName)])),p.site&&m()}),this.selectedSite=function(){r.debug("Get calendar from the factory"),p.states=p.site.States,p.suburb=null,p.state=null,p.suburbs=null,m()},this.selectedState=function(){p.state&&(p.suburb=null,p.suburbs=p.state.SubStates)},this.isStates=function(){return null!=p.states&&!(p.states.length<=0)},this.isSuburbs=function(){return null!=p.suburbs&&!(p.suburbs.length<=0)},this.isSendEmailDisabled=function(){return("Confirmed"==this.candidate.appointmentStatus||"Pending"==this.candidate.appointmentStatus)&&!p.isNotSave()},this.isNotSave=function(){return p.form.$pristine},this.isAttended=function(){return"Reschedule"==p.candidate.appointmentStatus||"Confirmed"==p.candidate.appointmentStatus},this.isShowAttendedButton=function(){return p.user.userType.indexOf("RediMed")!=-1},this.attended=function(){var e={};e.appointmentStatus="Attended",o.update({where:{candidateId:p.candidate.candidateId}},e,function(e,t){r.debug("updated successfully"),n.success("Successfully updated. The booking list will refresh shortly !"),p.form.$setPristine(),l.refreshBookingList(function(e){n.success("The booking list has been refresh"),d.prepForBroadcast("Refresh booking list successfully")})},function(e){r.error("updated failed",e),n.error("Fail to update","Error")})},this.sendConfirmationEmail=function(){r.debug("> Will send email to ",p.candidate),p.candidate.appointmentStatus.indexOf("Pending")>=0?o.sendConfirmationEmail({id:p.candidate.candidateId,type:"pending"},function(t){r.debug(">>sendConfirmationEmail",t),t.sentEmailStatus.indexOf("Error")>=0?(n.error(t.sentEmailStatus,"Error"),r.error("> Fail to send email to ",e)):(n.success(t.sentEmailStatus,""),r.debug("> Send email successfullt ",t.sentEmailStatus))}):o.sendConfirmationEmail({id:p.candidate.candidateId,type:"new"},function(t){r.debug(">>sendConfirmationEmail",t),t.sentEmailStatus.indexOf("Error")>=0?(n.error(t.sentEmailStatus,"Error"),r.error("> Fail to send email to ",e)):(n.success(t.sentEmailStatus,""),r.debug("> Send email successfullt ",t.sentEmailStatus))})},this.save=function(t){p.isSubmitted=!0;var a=!1;if(!p.candidate.appointmentTime&&p.calendars.length>0&&(void 0==p.calendar||null==p.calendar)&&t)n.error("Please select the calendar","Error");else if(p.form.$valid){var i={};f.indexOf("Pending")>=0&&(p.calendar||p.apptTimeAfterConvert)&&(i.appointmentStatus="Confirmed",p.candidate.appointmentStatus="Confirmed",a=!0),p.calendar?(f.indexOf("Confirmed")>=0||f.indexOf("Reschedule")>=0)&&p.calendar.calId!=e.calendarId&&(i.appointmentStatus="Reschedule",p.candidate.appointmentStatus="Reschedule",a=!0):(f.indexOf("Confirmed")>=0||f.indexOf("Reschedule")>=0)&&p.apptTimeAfterConvert&&p.isAppointmentTimeChange&&(i.appointmentStatus="Reschedule",p.candidate.appointmentStatus="Reschedule",a=!0),i.appointmentNotes=p.candidate.appointmentNotes,i.siteId=p.site.id,i.siteName=p.site.siteName,(i.siteName.indexOf("Eastern States")>=0||i.siteName.indexOf("WA")>=0||!t)&&(a=!1),p.state?(i.stateName=p.state.stateName,i.stateId=p.state.id):(i.stateName=null,i.stateId=null),p.suburb?(i.suburbName=p.suburb.suburbName,i.suburbId=p.suburb.id):(i.suburbName=null,i.suburbId=null),console.log("that.calendar = ",p.calendar),p.calendar?(i.appointmentTime=moment(s(p.calendar.fromTime)).format("YYYY-MM-DD hh:mm"),i.calendarId=p.calendar.calId):p.apptTimeAfterConvert&&(i.appointmentTime=moment(p.apptDateAfterConvert).format("YYYY-MM-DD")+" "+moment(p.apptTimeAfterConvert).format("hh:mm")),r.debug("will update",i),o.update({where:{candidateId:p.candidate.candidateId}},i,function(e,t){r.debug("updated successfully"),n.success("Successfully updated. The booking list will refresh shortly !"),p.form.$setPristine(),a&&p.sendConfirmationEmail(),l.refreshBookingList(function(e){n.success("The booking list has been refresh"),d.prepForBroadcast("Refresh booking list successfully")})},function(e){r.error("updated failed",e),n.error("Fail to update","Error")})}},this.cancel=function(){i.dismiss("cancel")},this.canCancelAppt=function(){return p.candidate.appointmentStatus.indexOf("Confirmed")>=0||p.candidate.appointmentStatus.indexOf("Reschedule")>=0},this.cancelAppt=function(){i.dismiss("cancel");var e=u.open({templateUrl:"modules/Bookings/views/booking.ConfirmToCancelAppt.html",controller:"ConfirmToCancelApptCtrl",controllerAs:"ConfirmToCancelApptCtrl"});e.result.then(function(e){var t={};t.appointmentNotes=p.candidate.appointmentNotes,t.appointmentStatus="Cancel",t.calendarId=-1,r.debug("will cancel the booking ",t),o.update({where:{candidateId:p.candidate.candidateId}},t,function(e,t){r.debug("updated successfully"),n.success("Successfully updated. The booking list will refresh shortly !"),p.sendConfirmationEmail(),l.refreshBookingList(function(e){n.success("The booking list has been refresh"),d.prepForBroadcast("Refresh booking list successfully")})},function(e){r.error("updated failed",e),n.error("Fail to update","Error")})},function(){r.info("Modal dismissed at: "+new Date)})},this.isAdmin=function(){return p.user.userType.indexOf("RediMed")>=0}}]),angular.module("ocsApp.Bookings").controller("ConfirmToCancelApptCtrl",["$uibModalInstance",function(e){this.ok=function(){e.close({})},this.cancel=function(){e.dismiss("cancel")}}]),angular.module("ocsApp.TelehealthBookings").controller("TelehealthBookingsMainCtrl",["uiGridConstants","$scope","$window","CompanyFactory","$uibModal","$cookieStore","$log","mysqlDate","mySharedService","Packages","$q",function(e,t,a,o,n,i,s,r,l,d,c){s=s.getInstance("ocsApp.TelehealthBookings.TelehealthBookingsMainCtrl"),s.debug("I am telehealth booking list controller.");var u=this;this.window=a;var m=[];this.loading=!1,this.user=o.getCurrentUser();var p=[{field:"employer",displayName:"Employer Name",width:"150"},{field:"patientName",displayName:"Patient Name",width:"200"},{field:"dob",displayName:"DOB",width:"100",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy'"},{field:"apptDate",displayName:"Appointment Date",width:"150",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy'"},{field:"preferredTime",displayName:"Preferred Time",width:"100"},{field:"address",displayName:"Address",width:"100"},{field:"suburb",displayName:"Suburb",width:"100"},{field:"state",displayName:"State",width:"100"},{field:"facetime",displayName:"Facetime",width:"100"},{field:"skype",displayName:"Skype",width:"100"},{field:"contactNumber",displayName:"Contact Number",width:"100"},{field:"bookingPerson",displayName:"Booking Person",width:"150"},{field:"creationDate",displayName:"Creation Date",width:"200",type:"date",cellFilter:"dateFilter|date:'dd/MM/yyyy HH:mm'"},{field:"createdBy",displayName:"By",width:"50"},{field:"linkId",displayName:"Link ID",width:"50"}];this.isAdmin=function(){return this.user.userType.indexOf("RediMed")>=0},this.gridOptions={enableSorting:!0,enableColumnResizing:!0,enableFiltering:!0,appScopeProvider:this,columnDefs:p,onRegisterApi:function(e){t.gridApi=e,t.gridApi.core.on.sortChanged(t,function(e,t){})},enableGridMenu:!0,enableRowSelection:!1,enableSelectAll:!1,exporterMenuPdf:!1,exporterCsvFilename:"myFile.csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location"))},t.$on("handleBroadcast",function(){var e=l.message;s.debug("Received a message from AdminEditBookingCtrl = "+e),e.indexOf("Refresh booking list successfully")>=0&&o.getCompany(function(e){s.debug("Refresh bookings, get company info"),toastr.success("The booking list has been refreshed !"),u.gridOptions.data=e.telehealthBookings})}),this.refreshBooking=function(){s.debug("will refresh booking ; get data from DB......"),u.loading=!0,o.refreshTelehealthBookingList(function(e){s.debug("refreshed booking ; get data from DB......"),u.gridOptions.data=e.telehealthBookings,u.loading=!1})},o.getCompany(function(e){s.debug("Make booking, get company info"),u.gridOptions.data=e.telehealthBookings,u.loading=!1,m=e.packages})}]);